!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.veGameSDK=t():e.veGameSDK=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=25)}([function(e,t,n){"use strict";var r,i,o,s,a,c,u,d=n(6),l=n(23),f=Function.prototype.apply,h=Function.prototype.call,p=Object.create,m=Object.defineProperty,v=Object.defineProperties,_=Object.prototype.hasOwnProperty,g={configurable:!0,enumerable:!1,writable:!0};i=function(e,t){var n,i;return l(t),i=this,r.call(this,e,n=function(){o.call(i,e,n),f.call(t,this,arguments)}),n.__eeOnceListener__=t,this},a={on:r=function(e,t){var n;return l(t),_.call(this,"__ee__")?n=this.__ee__:(n=g.value=p(null),m(this,"__ee__",g),g.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},once:i,off:o=function(e,t){var n,r,i,o;if(l(t),!_.call(this,"__ee__"))return this;if(!(n=this.__ee__)[e])return this;if("object"==typeof(r=n[e]))for(o=0;i=r[o];++o)i!==t&&i.__eeOnceListener__!==t||(2===r.length?n[e]=r[o?0:1]:r.splice(o,1));else r!==t&&r.__eeOnceListener__!==t||delete n[e];return this},emit:s=function(e){var t,n,r,i,o;if(_.call(this,"__ee__")&&(i=this.__ee__[e]))if("object"==typeof i){for(n=arguments.length,o=new Array(n-1),t=1;t<n;++t)o[t-1]=arguments[t];for(i=i.slice(),t=0;r=i[t];++t)f.call(r,this,o)}else switch(arguments.length){case 1:h.call(i,this);break;case 2:h.call(i,this,arguments[1]);break;case 3:h.call(i,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),t=1;t<n;++t)o[t-1]=arguments[t];f.call(i,this,o)}}},c={on:d(r),once:d(i),off:d(o),emit:d(s)},u=v({},c),e.exports=t=function(e){return null==e?p(u):v(Object(e),c)},t.methods=a},function(e,t,n){(function(t){e.exports=function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t||"undefined"!=typeof self&&self;var r=n((function(e,t){var n;e.exports=n=n||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),r={},i=r.lib={},o=i.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=i.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var s=n[o>>>2]>>>24-o%4*8&255;t[r+o>>>2]|=s<<24-(r+o)%4*8}else for(o=0;o<i;o+=4)t[r+o>>>2]=n[o>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,r=[],i=function(t){t=t;var n=987654321,r=4294967295;return function(){var i=((n=36969*(65535&n)+(n>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return i/=4294967296,(i+=.5)*(e.random()>.5?1:-1)}},o=0;o<t;o+=4){var a=i(4294967296*(n||e.random()));n=987654071*a(),r.push(4294967296*a()|0)}return new s.init(r,t)}}),a=r.enc={},c=a.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(n,t/2)}},u=a.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new s.init(n,t)}},d=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},l=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,a=i/(4*o),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*o,u=e.min(4*c,i);if(c){for(var d=0;d<c;d+=o)this._doProcessBlock(r,d);var l=r.splice(0,c);n.sigBytes-=u}return new s.init(l,u)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});i.Hasher=l.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=r.algo={};return r}(Math)})),i=n((function(e,t){var n;e.exports=(n=r,function(e){var t=n,r=t.lib,i=r.WordArray,o=r.Hasher,s=t.algo,a=[],c=[];!function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,i=0;i<64;)t(r)&&(i<8&&(a[i]=n(e.pow(r,.5))),c[i]=n(e.pow(r,1/3)),i++),r++}();var u=[],d=s.SHA256=o.extend({_doReset:function(){this._hash=new i.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],d=n[5],l=n[6],f=n[7],h=0;h<64;h++){if(h<16)u[h]=0|e[t+h];else{var p=u[h-15],m=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,v=u[h-2],_=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;u[h]=m+u[h-7]+_+u[h-16]}var g=r&i^r&o^i&o,y=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),b=f+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&d^~a&l)+c[h]+u[h];f=l,l=d,d=a,a=s+b|0,s=o,o=i,i=r,r=b+(y+g)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+d|0,n[6]=n[6]+l|0,n[7]=n[7]+f|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=e.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(d),t.HmacSHA256=o._createHmacHelper(d)}(Math),n.SHA256)})),o=(n((function(e,t){var n,i,o;e.exports=(i=(n=r).lib.Base,o=n.enc.Utf8,void(n.algo.HMAC=i.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=o.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),s=this._iKey=t.clone(),a=i.words,c=s.words,u=0;u<n;u++)a[u]^=1549556828,c[u]^=909522486;i.sigBytes=s.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))})),n((function(e,t){e.exports=r.HmacSHA256}))),s=function(e,t){return o(t,e)},a=function(e){return i(e)},c=["authorization","content-type","content-length","user-agent","presigned-expires","expect","x-amzn-trace-id"],u=function(e){try{return encodeURIComponent(e).replace(/[^A-Za-z0-9_.~\-%]+/g,escape).replace(/[*]/g,(function(e){return"%".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}catch(e){return""}},d=function(e){return Object.keys(e).sort().map((function(t){var n=e[t];if(null!=n){var r=u(t);if(r)return Array.isArray(n)?"".concat(r,"=").concat(n.map(u).sort().join("&".concat(r,"="))):"".concat(r,"=").concat(u(n))}})).filter((function(e){return e})).join("&")};return function(){function t(e,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.request=e,this.request.headers=e.headers||{},this.serviceName=n,r=r||{},this.signatureCache="boolean"!=typeof r.signatureCache||r.signatureCache,this.operation=r.operation,this.signatureVersion=r.signatureVersion,this.constant=r.isVolcengine?{algorithm:"HMAC-SHA256",v4Identifier:"request",dateHeader:"X-Date",tokenHeader:"x-security-token",contentSha256Header:"X-Content-Sha256",kDatePrefix:""}:{algorithm:"AWS4-HMAC-SHA256",v4Identifier:"aws4_request",dateHeader:"X-Amz-Date",tokenHeader:"x-amz-security-token",contentSha256Header:"X-Amz-Content-Sha256",kDatePrefix:"AWS4"},this.bodySha256=r.bodySha256,this.shouldSerializeBody="boolean"!=typeof r.shouldSerializeBody||r.shouldSerializeBody}var n,r;return n=t,(r=[{key:"addAuthorization",value:function(e,t){var n=this.iso8601(t).replace(/[:\-]|\.\d{3}/g,"");this.addHeaders(e,n),this.request.headers.Authorization=this.authorization(e,n)}},{key:"addHeaders",value:function(e,t){if(this.request.headers[this.constant.dateHeader]=t,e.sessionToken&&(this.request.headers[this.constant.tokenHeader]=e.sessionToken),this.request.body){var n=this.request.body;"string"!=typeof n&&this.shouldSerializeBody&&(n=n instanceof URLSearchParams?n.toString():JSON.stringify(n)),this.request.headers[this.constant.contentSha256Header]=this.bodySha256||a(n).toString()}}},{key:"authorization",value:function(e,t){var n=[],r=this.credentialString(t);return n.push("".concat(this.constant.algorithm," Credential=").concat(e.accessKeyId,"/").concat(r)),n.push("SignedHeaders=".concat(this.signedHeaders())),n.push("Signature=".concat(this.signature(e,t))),n.join(", ")}},{key:"signature",value:function(e,t){var n=this.getSigningKey(e,t.substr(0,8),this.request.region,this.serviceName,this.signatureCache);return s(n,this.stringToSign(t),"hex")}},{key:"stringToSign",value:function(e){var t=[];return t.push(this.constant.algorithm),t.push(e),t.push(this.credentialString(e)),t.push(this.hexEncodedHash(this.canonicalString())),t.join("\n")}},{key:"canonicalString",value:function(){var e=[],t=this.request.pathname||"/";return e.push(this.request.method.toUpperCase()),e.push(t),e.push(d(this.request.params)||""),e.push("".concat(this.canonicalHeaders(),"\n")),e.push(this.signedHeaders()),e.push(this.hexEncodedBodyHash()),e.join("\n")}},{key:"canonicalHeaders",value:function(){var e=this,t=[];Object.keys(this.request.headers).forEach((function(n){t.push([n,e.request.headers[n]])})),t.sort((function(e,t){return e[0].toLowerCase()<t[0].toLowerCase()?-1:1}));var n=[];return t.forEach((function(t){var r=t[0].toLowerCase();if(e.isSignableHeader(r)){var i=t[1];if(null==i||"function"!=typeof i.toString)throw new Error("Header ".concat(r," contains invalid value"));n.push("".concat(r,":").concat(e.canonicalHeaderValues(i.toString())))}})),n.join("\n")}},{key:"canonicalHeaderValues",value:function(e){return e.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")}},{key:"signedHeaders",value:function(){var e=this,t=[];return Object.keys(this.request.headers).forEach((function(n){n=n.toLowerCase(),e.isSignableHeader(n)&&t.push(n)})),t.sort().join(";")}},{key:"credentialString",value:function(e){return this.createScope(e.substr(0,8),this.request.region,this.serviceName)}},{key:"hexEncodedHash",value:function(e){return a(e)}},{key:"hexEncodedBodyHash",value:function(){return this.request.headers[this.constant.contentSha256Header]?this.request.headers[this.constant.contentSha256Header]:this.request.body?this.hexEncodedHash(d(this.request.body)):this.hexEncodedHash("")}},{key:"isSignableHeader",value:function(e){return 0===e.toLowerCase().indexOf("x-amz-")||c.indexOf(e)<0}},{key:"iso8601",value:function(e){return void 0===e&&(e=new Date),e.toISOString().replace(/\.\d{3}Z$/,"Z")}},{key:"getSigningKey",value:function(e,t,n,r){var i=s("".concat(this.constant.kDatePrefix).concat(e.secretAccessKey),t),o=s(i,n),a=s(o,r);return s(a,this.constant.v4Identifier)}},{key:"createScope",value:function(e,t,n){return[e.substr(0,8),t,n,this.constant.v4Identifier].join("/")}}])&&e(n.prototype,r),t}()}()}).call(this,n(4))},function(e,t,n){"use strict";var r=n(17)();e.exports=function(e){return e!==r&&null!==e}},function(e,t,n){"use strict";e.exports=function(e){return null!=e}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";(function(e,r){n.d(t,"a",(function(){return Fo}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function c(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function u(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}let d=!0,l=!0;function f(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function h(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);const o=e=>{const t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,o),i.apply(this,[e,o])};const o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);const r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function p(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(d=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function m(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(l=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function v(){if("object"==typeof window){if(d)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function _(e,t){l&&console.warn(e+" is deprecated, please use "+t+" instead.")}function g(e){return"[object Object]"===Object.prototype.toString.call(e)}function y(e){return g(e)?Object.keys(e).reduce((function(t,n){const r=g(e[n]),i=r?y(e[n]):e[n],o=r&&!Object.keys(i).length;return void 0===i||o?t:Object.assign(t,{[n]:i})}),{}):e}function b(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;const o=[];return e.forEach(e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)}),o.forEach(t=>{e.forEach(n=>{n.type===r&&n.trackId===t.id&&function e(t,n,r){n&&!r.has(n.id)&&(r.set(n.id,n),Object.keys(n).forEach(i=>{i.endsWith("Id")?e(t,t.get(n[i]),r):i.endsWith("Ids")&&n[i].forEach(n=>{e(t,t.get(n),r)})}))}(e,n,i)})}),i}const E=v;function S(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const r=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach(n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);const i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];let e={};"number"==typeof r.ideal?(e[i("min",n)]=r.ideal,t.optional.push(e),e={},e[i("max",n)]=r.ideal,t.optional.push(e)):(e[i("",n)]=r.ideal,t.optional.push(e))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(e=>{void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const s=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||s)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then(n=>{let s=(n=n.filter(e=>"videoinput"===e.kind)).find(e=>t.some(t=>e.label.toLowerCase().includes(t)));return!s&&n.length&&t.includes("back")&&(s=n[n.length-1]),s&&(e.video.deviceId=o.exact?{exact:s.deviceId}:{ideal:s.deviceId}),e.video=r(e.video),E("chrome: "+JSON.stringify(e)),i(e)})}e.video=r(e.video)}return E("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){i(e,e=>{n.webkitGetUserMedia(e,t,e=>{r&&r(o(e))})})}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return i(t,t=>e(t).then(e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(e=>{e.stop()}),new DOMException("","NotFoundError");return e},e=>Promise.reject(o(e))))}}}function w(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function C(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.track.id):{track:n.track};const i=new Event("track");i.track=n.track,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)}),t.stream.getTracks().forEach(n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.id):{track:n};const i=new Event("track");i.track=n,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else h(e,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function k(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){let i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach(e=>{this._senders.push(t(this,e))})};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach(e=>{const t=this._senders.find(t=>t.track===e);t&&this._senders.splice(this._senders.indexOf(t),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function R(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,r]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const i=function(e){const t={};return e.result().forEach(e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(t=>{n[t]=e.stat(t)}),t[n.id]=n}),t},o=function(e){return new Map(Object.keys(e).map(t=>[t,e[t]]))};if(arguments.length>=2){const r=function(e){n(o(i(e)))};return t.apply(this,[r,e])}return new Promise((e,n)=>{t.apply(this,[function(t){e(o(i(t)))},n])}).then(n,r)}}function T(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>b(t,e.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),h(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>b(t,e.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,r;return this.getSenders().forEach(n=>{n.track===e&&(t?r=!0:t=n)}),this.getReceivers().forEach(t=>(t.track===e&&(n?r=!0:n=t),t.track===e)),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function I(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(e=>this._shimmedLocalStreams[e][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")});const t=this.getSenders();n.apply(this,arguments);const r=this.getSenders().filter(e=>-1===t.indexOf(e));this._shimmedLocalStreams[e.id]=[e].concat(r)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]}),i.apply(this,arguments)}}function O(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return I(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(e=>this._reverseStreams[e.id])};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}r.apply(this,[t])};const i=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:n})}function s(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find(e=>e===t))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const i=this.getSenders().find(e=>e.track===t);if(i)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const o=this._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const r=new e.MediaStream([t]);this._streams[n.id]=r,this._reverseStreams[r.id]=n,this.addStream(r)}return this.getSenders().find(e=>e.track===t)},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=o(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then(e=>o(this,e))}};e.RTCPeerConnection.prototype[t]=r[t]}));const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=s(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=c.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach(n=>{this._streams[n].getTracks().find(t=>e.track===t)&&(t=this._streams[n])}),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function A(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}))}function D(e,t){h(e,"negotiationneeded",e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e})}var P=Object.freeze({__proto__:null,shimMediaStream:w,shimOnTrack:C,shimGetSendersWithDtmf:k,shimGetStats:R,shimSenderReceiverGetStats:T,shimAddTrackRemoveTrackWithNative:I,shimAddTrackRemoveTrack:O,shimPeerConnection:A,fixNegotiationNeeded:D,shimGetUserMedia:S,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then(t=>{const r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}});var x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};function M(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}function L(e){var t={exports:{}};return e(t,t.exports),t.exports}var j=L((function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},t.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},t.getDescription=function(e){var n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){var n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((function(e){return 0===e.indexOf(n)}))},t.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},t.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},t.getMid=function(e){var n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){var r=t.matchPrefix(e+n,"a=ice-ufrag:")[0],i=t.matchPrefix(e+n,"a=ice-pwd:")[0];return r&&i?{usernameFragment:r.substr(12),password:i.substr(10)}:null},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(e)[0].split(" "),i=3;i<r.length;i++){var o=r[i],s=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){var a=t.parseRtpMap(s),c=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(a.parameters=c.length?t.parseFmtp(c[0]):{},a.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),n.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(a.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((function(e){n.headerExtensions.push(t.parseExtmap(e))})),n},t.writeRtpDescription=function(e,n){var r="";r+="m="+e+" ",r+=n.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=n.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((function(e){r+=t.writeRtpMap(e),r+=t.writeFmtp(e),r+=t.writeRtcpFb(e)}));var i=0;return n.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(r+="a=maxptime:"+i+"\r\n"),r+="a=rtcp-mux\r\n",n.headerExtensions&&n.headerExtensions.forEach((function(e){r+=t.writeExtmap(e)})),r},t.parseRtpEncodingParameters=function(e){var n,r=[],i=t.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=a.length>0&&a[0].ssrc,u=t.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(n=u[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&n&&(t.rtx={ssrc:n}),r.push(t),o&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},r.push(t))}})),0===r.length&&c&&r.push({ssrc:c});var d=t.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substr(5),10)*.95-16e3:void 0,r.forEach((function(e){e.maxBitrate=d}))),r},t.parseRtcpParameters=function(e){var n={},r=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);var i=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=i.length>0,n.compound=0===i.length;var o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.parseMsid=function(e){var n,r=t.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(n=r[0].substr(7).split(" "))[0],track:n[1]};var i=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(n=i[0].value.split(" "))[0],track:n[1]}:void 0},t.parseSctpDescription=function(e){var n,r=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");i.length>0&&(n=parseInt(i[0].substr(19),10)),isNaN(n)&&(n=65536);var o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:r.fmt,maxMessageSize:n};if(t.matchPrefix(e,"a=sctpmap:").length>0){var s=t.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:n}}},t.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,n,r){var i=void 0!==n?n:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,n,r,i){var o=t.writeRtpDescription(e.kind,n);if(o+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var s="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+s,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),o},t.getDirection=function(e,n){for(var r=t.splitLines(e),i=0;i<r.length;i++)switch(r[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[i].substr(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var n=t.splitLines(e)[0].substr(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){var n=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var n=t.splitLines(e),r=0;r<n.length;r++)if(n[r].length<2||"="!==n[r].charAt(1))return!1;return!0},e.exports=t}));function N(e,t,n,r,i){var o=j.writeRtpDescription(e.kind,t);if(o+=j.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=j.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":i||"active"),o+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var a="msid:"+(r?r.id:"-")+" "+s+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+j.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+j.localCName+"\r\n"),o}function B(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),s=r(t.parameters.apt,i);return o&&s&&o.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach((function(r){for(var o=0;o<t.codecs.length;o++){var s=t.codecs[o];if(r.name.toLowerCase()===s.name.toLowerCase()&&r.clockRate===s.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&s.parameters.apt&&!i(r,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(r.numChannels,s.numChannels),n.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}})),n}function U(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function z(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function F(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}var G=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function r(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var i=function(n){var r=this,i=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){r[e]=i[e].bind(i)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw F("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter((function(e){return 0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!n?(n=!0,!0):0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp")})),delete e.url,e.urls=i?r[0]:r,!!r.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var o=n.iceCandidatePoolSize;o>0;o--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=j.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(i.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(i.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),i.prototype.onicecandidate=null,i.prototype.onaddstream=null,i.prototype.ontrack=null,i.prototype.onremovestream=null,i.prototype.onsignalingstatechange=null,i.prototype.oniceconnectionstatechange=null,i.prototype.onconnectionstatechange=null,i.prototype.onicegatheringstatechange=null,i.prototype.onnegotiationneeded=null,i.prototype.ondatachannel=null,i.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},i.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},i.prototype.getConfiguration=function(){return this._config},i.prototype.getLocalStreams=function(){return this.localStreams},i.prototype.getRemoteStreams=function(){return this.remoteStreams},i.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},i.prototype.addTrack=function(t,n){if(this._isClosed)throw F("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(e){return e.track===t})))throw F("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},i.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){n.addTrack(e,r)}))}},i.prototype.removeTrack=function(t){if(this._isClosed)throw F("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw F("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},i.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},i.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},i.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},i.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},i.prototype._gather=function(t,n){var r=this,i=this.transceivers[n].iceGatherer;if(!i.onlocalcandidate){var o=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,i.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),i.onlocalcandidate=function(e){if(!(r.usingBundle&&n>0)){var o=new Event("icecandidate");o.candidate={sdpMid:t,sdpMLineIndex:n};var s=e.candidate,a=!s||0===Object.keys(s).length;if(a)"new"!==i.state&&"gathering"!==i.state||(i.state="completed");else{"new"===i.state&&(i.state="gathering"),s.component=1,s.ufrag=i.getLocalParameters().usernameFragment;var c=j.writeCandidate(s);o.candidate=Object.assign(o.candidate,j.parseCandidate(c)),o.candidate.candidate=c,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}}var u=j.getMediaSections(r._localDescription.sdp);u[o.candidate.sdpMLineIndex]+=a?"a=end-of-candidates\r\n":"a="+o.candidate.candidate+"\r\n",r._localDescription.sdp=j.getDescription(r._localDescription.sdp)+u.join("");var d=r.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==r.iceGatheringState&&(r.iceGatheringState="gathering",r._emitGatheringStateChange()),a||r._dispatchEvent("icecandidate",o),d&&(r._dispatchEvent("icecandidate",new Event("icecandidate")),r.iceGatheringState="complete",r._emitGatheringStateChange())}},e.setTimeout((function(){o.forEach((function(e){i.onlocalcandidate(e)}))}),0)}},i.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},i.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},i.prototype._transceive=function(e,n,r){var i=B(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:j.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),r&&e.rtpReceiver&&i.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?i.encodings=e.recvEncodingParameters:i.encodings=[{}],i.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(i.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},i.prototype.setLocalDescription=function(e){var t,n,r=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(F("TypeError",'Unsupported type "'+e.type+'"'));if(!U("setLocalDescription",e.type,r.signalingState)||r._isClosed)return Promise.reject(F("InvalidStateError","Can not set local "+e.type+" in state "+r.signalingState));if("offer"===e.type)t=j.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=j.parseRtpParameters(e);r.transceivers[t].localCapabilities=n})),r.transceivers.forEach((function(e,t){r._gather(e.mid,t)}));else if("answer"===e.type){t=j.splitSections(r._remoteDescription.sdp),n=t.shift();var i=j.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var o=r.transceivers[t],s=o.iceGatherer,a=o.iceTransport,c=o.dtlsTransport,u=o.localCapabilities,d=o.remoteCapabilities;if(!(j.isRejected(e)&&0===j.matchPrefix(e,"a=bundle-only").length)&&!o.rejected){var l=j.getIceParameters(e,n),f=j.getDtlsParameters(e,n);i&&(f.role="server"),r.usingBundle&&0!==t||(r._gather(o.mid,t),"new"===a.state&&a.start(s,l,i?"controlling":"controlled"),"new"===c.state&&c.start(f));var h=B(u,d);r._transceive(o,h.codecs.length>0,!1)}}))}return r._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?r._updateSignalingState("have-local-offer"):r._updateSignalingState("stable"),Promise.resolve()},i.prototype.setRemoteDescription=function(i){var o=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(F("TypeError",'Unsupported type "'+i.type+'"'));if(!U("setRemoteDescription",i.type,o.signalingState)||o._isClosed)return Promise.reject(F("InvalidStateError","Can not set remote "+i.type+" in state "+o.signalingState));var s={};o.remoteStreams.forEach((function(e){s[e.id]=e}));var a=[],c=j.splitSections(i.sdp),u=c.shift(),d=j.matchPrefix(u,"a=ice-lite").length>0,l=j.matchPrefix(u,"a=group:BUNDLE ").length>0;o.usingBundle=l;var f=j.matchPrefix(u,"a=ice-options:")[0];return o.canTrickleIceCandidates=!!f&&f.substr(14).split(" ").indexOf("trickle")>=0,c.forEach((function(r,c){var f=j.splitLines(r),h=j.getKind(r),p=j.isRejected(r)&&0===j.matchPrefix(r,"a=bundle-only").length,m=f[0].substr(2).split(" ")[2],v=j.getDirection(r,u),_=j.parseMsid(r),g=j.getMid(r)||j.generateIdentifier();if(p||"application"===h&&("DTLS/SCTP"===m||"UDP/DTLS/SCTP"===m))o.transceivers[c]={mid:g,kind:h,protocol:m,rejected:!0};else{var y,b,E,S,w,C,k,R,T;!p&&o.transceivers[c]&&o.transceivers[c].rejected&&(o.transceivers[c]=o._createTransceiver(h,!0));var I,O,A=j.parseRtpParameters(r);p||(I=j.getIceParameters(r,u),(O=j.getDtlsParameters(r,u)).role="client"),k=j.parseRtpEncodingParameters(r);var D=j.parseRtcpParameters(r),P=j.matchPrefix(r,"a=end-of-candidates",u).length>0,x=j.matchPrefix(r,"a=candidate:").map((function(e){return j.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===i.type||"answer"===i.type)&&!p&&l&&c>0&&o.transceivers[c]&&(o._disposeIceAndDtlsTransports(c),o.transceivers[c].iceGatherer=o.transceivers[0].iceGatherer,o.transceivers[c].iceTransport=o.transceivers[0].iceTransport,o.transceivers[c].dtlsTransport=o.transceivers[0].dtlsTransport,o.transceivers[c].rtpSender&&o.transceivers[c].rtpSender.setTransport(o.transceivers[0].dtlsTransport),o.transceivers[c].rtpReceiver&&o.transceivers[c].rtpReceiver.setTransport(o.transceivers[0].dtlsTransport)),"offer"!==i.type||p){if("answer"===i.type&&!p){b=(y=o.transceivers[c]).iceGatherer,E=y.iceTransport,S=y.dtlsTransport,w=y.rtpReceiver,C=y.sendEncodingParameters,R=y.localCapabilities,o.transceivers[c].recvEncodingParameters=k,o.transceivers[c].remoteCapabilities=A,o.transceivers[c].rtcpParameters=D,x.length&&"new"===E.state&&(!d&&!P||l&&0!==c?x.forEach((function(e){z(y.iceTransport,e)})):E.setRemoteCandidates(x)),l&&0!==c||("new"===E.state&&E.start(b,I,"controlling"),"new"===S.state&&S.start(O)),!B(y.localCapabilities,y.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&y.sendEncodingParameters[0].rtx&&delete y.sendEncodingParameters[0].rtx,o._transceive(y,"sendrecv"===v||"recvonly"===v,"sendrecv"===v||"sendonly"===v),!w||"sendrecv"!==v&&"sendonly"!==v?delete y.rtpReceiver:(T=w.track,_?(s[_.stream]||(s[_.stream]=new e.MediaStream),n(T,s[_.stream]),a.push([T,w,s[_.stream]])):(s.default||(s.default=new e.MediaStream),n(T,s.default),a.push([T,w,s.default])))}}else{(y=o.transceivers[c]||o._createTransceiver(h)).mid=g,y.iceGatherer||(y.iceGatherer=o._createIceGatherer(c,l)),x.length&&"new"===y.iceTransport.state&&(!P||l&&0!==c?x.forEach((function(e){z(y.iceTransport,e)})):y.iceTransport.setRemoteCandidates(x)),R=e.RTCRtpReceiver.getCapabilities(h),t<15019&&(R.codecs=R.codecs.filter((function(e){return"rtx"!==e.name}))),C=y.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var M,L=!1;if("sendrecv"===v||"sendonly"===v){if(L=!y.rtpReceiver,w=y.rtpReceiver||new e.RTCRtpReceiver(y.dtlsTransport,h),L)T=w.track,_&&"-"===_.stream||(_?(s[_.stream]||(s[_.stream]=new e.MediaStream,Object.defineProperty(s[_.stream],"id",{get:function(){return _.stream}})),Object.defineProperty(T,"id",{get:function(){return _.track}}),M=s[_.stream]):(s.default||(s.default=new e.MediaStream),M=s.default)),M&&(n(T,M),y.associatedRemoteMediaStreams.push(M)),a.push([T,w,M])}else y.rtpReceiver&&y.rtpReceiver.track&&(y.associatedRemoteMediaStreams.forEach((function(t){var n=t.getTracks().find((function(e){return e.id===y.rtpReceiver.track.id}));n&&function(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(n,t)})),y.associatedRemoteMediaStreams=[]);y.localCapabilities=R,y.remoteCapabilities=A,y.rtpReceiver=w,y.rtcpParameters=D,y.sendEncodingParameters=C,y.recvEncodingParameters=k,o._transceive(o.transceivers[c],!1,L)}}})),void 0===o._dtlsRole&&(o._dtlsRole="offer"===i.type?"active":"passive"),o._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?o._updateSignalingState("have-remote-offer"):o._updateSignalingState("stable"),Object.keys(s).forEach((function(t){var n=s[t];if(n.getTracks().length){if(-1===o.remoteStreams.indexOf(n)){o.remoteStreams.push(n);var i=new Event("addstream");i.stream=n,e.setTimeout((function(){o._dispatchEvent("addstream",i)}))}a.forEach((function(e){var t=e[0],i=e[1];n.id===e[2].id&&r(o,t,i,[n])}))}})),a.forEach((function(e){e[2]||r(o,e[0],e[1],[])})),e.setTimeout((function(){o&&o.transceivers&&o.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},i.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},i.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},i.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},i.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},i.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},i.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(F("InvalidStateError","Can not call createOffer after close"));var r=n.transceivers.filter((function(e){return"audio"===e.kind})).length,i=n.transceivers.filter((function(e){return"video"===e.kind})).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==o.offerToReceiveAudio&&(r=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(i=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--r<0&&(e.wantReceive=!1):"video"===e.kind&&--i<0&&(e.wantReceive=!1)}));r>0||i>0;)r>0&&(n._createTransceiver("audio"),r--),i>0&&(n._createTransceiver("video"),i--);var s=j.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(r,i){var o=r.track,s=r.kind,a=r.mid||j.generateIdentifier();r.mid=a,r.iceGatherer||(r.iceGatherer=n._createIceGatherer(i,n.usingBundle));var c=e.RTCRtpSender.getCapabilities(s);t<15019&&(c.codecs=c.codecs.filter((function(e){return"rtx"!==e.name}))),c.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),r.remoteCapabilities&&r.remoteCapabilities.codecs&&r.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),c.headerExtensions.forEach((function(e){(r.remoteCapabilities&&r.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var u=r.sendEncodingParameters||[{ssrc:1001*(2*i+1)}];o&&t>=15019&&"video"===s&&!u[0].rtx&&(u[0].rtx={ssrc:u[0].ssrc+1}),r.wantReceive&&(r.rtpReceiver=new e.RTCRtpReceiver(r.dtlsTransport,s)),r.localCapabilities=c,r.sendEncodingParameters=u})),"max-compat"!==n._config.bundlePolicy&&(s+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){s+=N(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),s+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,s+="a="+j.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(s+="a=end-of-candidates\r\n"))}));var a=new e.RTCSessionDescription({type:"offer",sdp:s});return Promise.resolve(a)},i.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(F("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(F("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var r=j.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(r+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),r+="a=ice-options:trickle\r\n";var i=j.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,o){if(!(o+1>i)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?r+="m=application 0 DTLS/SCTP 5000\r\n":r+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?r+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(r+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(r+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var s;if(e.stream)"audio"===e.kind?s=e.stream.getAudioTracks()[0]:"video"===e.kind&&(s=e.stream.getVideoTracks()[0]),s&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var a=B(e.localCapabilities,e.remoteCapabilities);!a.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,r+=N(e,a,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(r+="a=rtcp-rsize\r\n")}}));var o=new e.RTCSessionDescription({type:"answer",sdp:r});return Promise.resolve(o)},i.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(r,i){if(!n._remoteDescription)return i(F("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var o=e.sdpMLineIndex;if(e.sdpMid)for(var s=0;s<n.transceivers.length;s++)if(n.transceivers[s].mid===e.sdpMid){o=s;break}var a=n.transceivers[o];if(!a)return i(F("OperationError","Can not add ICE candidate"));if(a.rejected)return r();var c=Object.keys(e.candidate).length>0?j.parseCandidate(e.candidate):{};if("tcp"===c.protocol&&(0===c.port||9===c.port))return r();if(c.component&&1!==c.component)return r();if((0===o||o>0&&a.iceTransport!==n.transceivers[0].iceTransport)&&!z(a.iceTransport,c))return i(F("OperationError","Can not add ICE candidate"));var u=e.candidate.trim();0===u.indexOf("a=")&&(u=u.substr(2)),(t=j.getMediaSections(n._remoteDescription.sdp))[o]+="a="+(c.type?u:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=j.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var d=0;d<n.transceivers.length&&(n.transceivers[d].rejected||(n.transceivers[d].iceTransport.addRemoteCandidate({}),(t=j.getMediaSections(n._remoteDescription.sdp))[d]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=j.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));d++);r()}))},i.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw F("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){var r;e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(r=e[n]).type]||r.type,t.set(n,e[n])})),t}))}}}));var o=["createOffer","createAnswer"];return o.forEach((function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(o=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),i};function H(e){const t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch(e=>Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString(){return this.name}}}(e)))}}function K(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function V(e,t){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){const t=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(e){t.set.call(this,e);const n=new Event("enabled");n.enabled=e,this.dispatchEvent(n)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const n=G(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=function(e,t){let n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(e=>{if(e&&(e.urls||e.url)){let t=e.urls||e.url;e.url&&!e.urls&&_("RTCIceServer.url","RTCIceServer.urls");const r="string"==typeof t;return r&&(t=[t]),t=t.filter(e=>{if(0===e.indexOf("stun:"))return!1;const t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n}),delete e.url,e.urls=r?t[0]:t,!!t.length}})}(e.iceServers,t.version),v("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype}function q(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}var W=Object.freeze({__proto__:null,shimPeerConnection:V,shimReplaceTrack:q,shimGetUserMedia:H,shimGetDisplayMedia:K});function Y(e,t){const n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){_("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},r&&r.prototype.getSettings){const t=r.prototype.getSettings;r.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(r&&r.prototype.applyConstraints){const t=r.prototype.applyConstraints;r.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function J(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function $(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,i,o]=arguments;return r.apply(this,[e||null]).then(e=>{if(t.version<53&&!i)try{e.forEach(e=>{e.type=n[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;e.forEach((t,r)=>{e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))})}return e}).then(i,o)}}function X(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Z(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),h(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Q(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){_("removeStream","removeTrack"),this.getSenders().forEach(t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)})})}function ee(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function te(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach(e=>{if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const r=t.apply(this,arguments);if(n){const{sender:t}=r,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e.sendEncodings,t.sendEncodings=e.sendEncodings,this.setParametersPromises.push(t.setParameters(n).then(()=>{delete t.sendEncodings}).catch(()=>{delete t.sendEncodings})))}return r})}function ne(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function re(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function ie(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var oe=Object.freeze({__proto__:null,shimOnTrack:J,shimPeerConnection:$,shimSenderGetStats:X,shimReceiverGetStats:Z,shimRemoveStream:Q,shimRTCDataChannel:ee,shimAddTransceiver:te,shimGetParameters:ne,shimCreateOffer:re,shimCreateAnswer:ie,shimGetUserMedia:Y,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}});function se(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach(n=>t.call(this,n,e)),e.getVideoTracks().forEach(n=>t.call(this,n,e))},e.RTCPeerConnection.prototype.addTrack=function(e,...n){return n&&n.forEach(e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach(e=>{n.includes(e.track)&&this.removeTrack(e)})})}}function ae(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach(e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)})}),t.apply(e,arguments)}}}function ce(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};let a=function(e,t,n){const r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=a,a=function(e,t,n){const r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=a,a=function(e,t,n){const r=s.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=a}function ue(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(de(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function de(e){return e&&void 0!==e.video?Object.assign({},e,{video:y(e.video)}):e}function le(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let r=e.iceServers[n];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?(_("RTCIceServer.url","RTCIceServer.urls"),r=JSON.parse(JSON.stringify(r)),r.urls=r.url,delete r.url,t.push(r)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function fe(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function he(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find(e=>"audio"===e.receiver.track.kind);!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find(e=>"video"===e.receiver.track.kind);!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}}function pe(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var me=Object.freeze({__proto__:null,shimLocalStreamsAPI:se,shimRemoteStreamsAPI:ae,shimCallbacksAPI:ce,shimGetUserMedia:ue,shimConstraints:de,shimRTCIceServerUrls:le,shimTrackEventTransceiver:fe,shimCreateOfferLegacy:he,shimAudioContext:pe});function ve(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const n=new t(e),r=j.parseCandidate(e.candidate),i=Object.assign(n,r);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,h(e,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t))}function _e(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=function(e){if(!e||!e.sdp)return!1;const t=j.splitSections(e.sdp);return t.shift(),t.some(e=>{const t=j.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})},r=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n},i=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},o=function(e,n){let r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);const i=j.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r},s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const e=r(arguments[0]),t=i(e),n=o(arguments[0],e);let s;s=0===t&&0===n?Number.POSITIVE_INFINITY:0===t||0===n?Math.max(t,n):Math.min(t,n);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>s}),this._sctp=a}return s.apply(this,arguments)}}function ge(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},h(e,"datachannel",e=>(t(e.channel,e.target),e))}function ye(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function be(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter(e=>"a=extmap-allow-mixed"!==e.trim()).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function Ee(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}var Se=Object.freeze({__proto__:null,shimRTCIceCandidate:ve,shimMaxMessageSize:_e,shimSendThrowTypeError:ge,shimConnectionState:ye,removeExtmapAllowMixed:be,shimAddIceCandidateNullOrEmpty:Ee});!function({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const n=v,r=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=f(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=f(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.mediaDevices&&n.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=f(n.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=f(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),i={browserDetails:r,commonShim:Se,extractVersion:f,disableLog:p,disableWarnings:m};switch(r.browser){case"chrome":if(!P||!A||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(null===r.version)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=P,Ee(e,r),S(e,r),w(e),A(e,r),C(e),O(e,r),k(e),R(e),T(e),D(e,r),ve(e),ye(e),_e(e,r),ge(e),be(e,r);break;case"firefox":if(!oe||!$||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=oe,Ee(e,r),Y(e,r),$(e,r),J(e),Q(e),X(e),Z(e),ee(e),te(e),ne(e),re(e),ie(e),ve(e),ye(e),_e(e,r),ge(e);break;case"edge":if(!W||!V||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),i;n("adapter.js shimming edge."),i.browserShim=W,H(e),K(e),V(e,r),q(e),_e(e,r),ge(e);break;case"safari":if(!me||!t.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=me,Ee(e,r),le(e),he(e),ce(e),se(e),ae(e),fe(e),ue(e),pe(e),ve(e),_e(e,r),ge(e),be(e,r);break;default:n("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window});function we(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var Ce="function"==typeof Symbol&&Symbol.observable||"@@observable",ke=function(){return Math.random().toString(36).substring(7).split("").join(".")},Re={INIT:"@@redux/INIT"+ke(),REPLACE:"@@redux/REPLACE"+ke(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+ke()}};function Te(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}var Ie=Symbol("INITIAL_STATE"),Oe=Symbol("UPDATE_STATE"),Ae={appId:"",roomId:"",callId:"",clientId:"",configServer:[],needCreateDataChannel:!1,autoSubscribe:!0,_mediaServerAddr:"",_signalServerHost:""},De=function e(t,n,r){var i;if("function"==typeof n&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error(we(0));if("function"==typeof n&&void 0===r&&(r=n,n=void 0),void 0!==r){if("function"!=typeof r)throw new Error(we(1));return r(e)(t,n)}if("function"!=typeof t)throw new Error(we(2));var o=t,s=n,a=[],c=a,u=!1;function d(){c===a&&(c=a.slice())}function l(){if(u)throw new Error(we(3));return s}function f(e){if("function"!=typeof e)throw new Error(we(4));if(u)throw new Error(we(5));var t=!0;return d(),c.push(e),function(){if(t){if(u)throw new Error(we(6));t=!1,d();var n=c.indexOf(e);c.splice(n,1),a=null}}}function h(e){if(!Te(e))throw new Error(we(7));if(void 0===e.type)throw new Error(we(8));if(u)throw new Error(we(9));try{u=!0,s=o(s,e)}finally{u=!1}for(var t=a=c,n=0;n<t.length;n++){(0,t[n])()}return e}function p(e){if("function"!=typeof e)throw new Error(we(10));o=e,h({type:Re.REPLACE})}function m(){var e,t=f;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(we(11));function n(){e.next&&e.next(l())}return n(),{unsubscribe:t(n)}}})[Ce]=function(){return this},e}return h({type:Re.INIT}),(i={dispatch:h,subscribe:f,getState:l,replaceReducer:p})[Ce]=m,i}((function(e,t){switch(void 0===e&&(e=Ae),t.type){case Ie:case Oe:return s(s({},e),t.payload);default:return e}})),Pe=1e3,xe=6e4,Me=60*xe,Le=24*Me,je=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"weeks":case"week":case"w":return 6048e5*n;case"days":case"day":case"d":return n*Le;case"hours":case"hour":case"hrs":case"hr":case"h":return n*Me;case"minutes":case"minute":case"mins":case"min":case"m":return n*xe;case"seconds":case"second":case"secs":case"sec":case"s":return n*Pe;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(e);if("number"===n&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=Le)return Ne(e,t,Le,"day");if(t>=Me)return Ne(e,t,Me,"hour");if(t>=xe)return Ne(e,t,xe,"minute");if(t>=Pe)return Ne(e,t,Pe,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=Le)return Math.round(e/Le)+"d";if(t>=Me)return Math.round(e/Me)+"h";if(t>=xe)return Math.round(e/xe)+"m";if(t>=Pe)return Math.round(e/Pe)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Ne(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}var Be,Ue=function(e){function t(e){let r,i=null;function o(...e){if(!o.enabled)return;const n=o,i=Number(new Date),s=i-(r||i);n.diff=s,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(r,i)=>{if("%%"===r)return"%";a++;const o=t.formatters[i];if("function"==typeof o){const t=e[a];r=o.call(n,t),e.splice(a,1),a--}return r}),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=n,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null===i?t.enabled(e):i,set:e=>{i=e}}),"function"==typeof t.init&&t.init(o),o}function n(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(r),...t.skips.map(r).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=je,t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(n=>{t[n]=e[n]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t},ze=L((function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))}),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==r&&"env"in r&&(e=Object({NODE_ENV:"production"}).DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=Ue(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}})),Fe=new Uint8Array(16);function Ge(){if(!Be&&!(Be="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Be(Fe)}var He=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Ke(e){return"string"==typeof e&&He.test(e)}for(var Ve=[],qe=0;qe<256;++qe)Ve.push((qe+256).toString(16).substr(1));function We(e,t,n){var r=(e=e||{}).random||(e.rng||Ge)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Ve[e[t+0]]+Ve[e[t+1]]+Ve[e[t+2]]+Ve[e[t+3]]+"-"+Ve[e[t+4]]+Ve[e[t+5]]+"-"+Ve[e[t+6]]+Ve[e[t+7]]+"-"+Ve[e[t+8]]+Ve[e[t+9]]+"-"+Ve[e[t+10]]+Ve[e[t+11]]+Ve[e[t+12]]+Ve[e[t+13]]+Ve[e[t+14]]+Ve[e[t+15]]).toLowerCase();if(!Ke(n))throw TypeError("Stringified UUID is invalid");return n}(r)}var Ye=L((function(e,t){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)r(n,i)&&(e[i]=n[i])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){var t,n,r,i,o,s;for(r=0,t=0,n=e.length;t<n;t++)r+=e[t].length;for(s=new Uint8Array(r),i=0,t=0,n=e.length;t<n;t++)o=e[t],s.set(o,i),i+=o.length;return s}},o={arraySet:function(e,t,n,r,i){for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,i)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(n)}));function Je(e){for(var t=e.length;--t>=0;)e[t]=0}var $e=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Xe=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Ze=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Qe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],et=new Array(576);Je(et);var tt=new Array(60);Je(tt);var nt=new Array(512);Je(nt);var rt=new Array(256);Je(rt);var it=new Array(29);Je(it);var ot,st,at,ct=new Array(30);function ut(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function dt(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function lt(e){return e<256?nt[e]:nt[256+(e>>>7)]}function ft(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function ht(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,ft(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function pt(e,t,n){ht(e,n[2*t],n[2*t+1])}function mt(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function vt(e,t,n){var r,i,o=new Array(16),s=0;for(r=1;r<=15;r++)o[r]=s=s+n[r-1]<<1;for(i=0;i<=t;i++){var a=e[2*i+1];0!==a&&(e[2*i]=mt(o[a]++,a))}}function _t(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function gt(e){e.bi_valid>8?ft(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function yt(e,t,n,r){var i=2*t,o=2*n;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]}function bt(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&yt(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!yt(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function Et(e,t,n){var r,i,o,s,a=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*a]<<8|e.pending_buf[e.d_buf+2*a+1],i=e.pending_buf[e.l_buf+a],a++,0===r?pt(e,i,t):(pt(e,(o=rt[i])+256+1,t),0!==(s=$e[o])&&ht(e,i-=it[o],s),pt(e,o=lt(--r),n),0!==(s=Xe[o])&&ht(e,r-=ct[o],s))}while(a<e.last_lit);pt(e,256,t)}function St(e,t){var n,r,i,o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.has_stree,c=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<c;n++)0!==o[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,a&&(e.static_len-=s[2*i+1]);for(t.max_code=u,n=e.heap_len>>1;n>=1;n--)bt(e,o,n);i=c;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],bt(e,o,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,o[2*i]=o[2*n]+o[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,o[2*n+1]=o[2*r+1]=i,e.heap[1]=i++,bt(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,o,s,a,c=t.dyn_tree,u=t.max_code,d=t.stat_desc.static_tree,l=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,h=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(o=0;o<=15;o++)e.bl_count[o]=0;for(c[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(o=c[2*c[2*(r=e.heap[n])+1]+1]+1)>p&&(o=p,m++),c[2*r+1]=o,r>u||(e.bl_count[o]++,s=0,r>=h&&(s=f[r-h]),a=c[2*r],e.opt_len+=a*(o+s),l&&(e.static_len+=a*(d[2*r+1]+s)));if(0!==m){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(o=p;0!==o;o--)for(r=e.bl_count[o];0!==r;)(i=e.heap[--n])>u||(c[2*i+1]!==o&&(e.opt_len+=(o-c[2*i+1])*c[2*i],c[2*i+1]=o),r--)}}(e,t),vt(o,u,e.bl_count)}function wt(e,t,n){var r,i,o=-1,s=t[1],a=0,c=7,u=4;for(0===s&&(c=138,u=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=s,s=t[2*(r+1)+1],++a<c&&i===s||(a<u?e.bl_tree[2*i]+=a:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,o=i,0===s?(c=138,u=3):i===s?(c=6,u=3):(c=7,u=4))}function Ct(e,t,n){var r,i,o=-1,s=t[1],a=0,c=7,u=4;for(0===s&&(c=138,u=3),r=0;r<=n;r++)if(i=s,s=t[2*(r+1)+1],!(++a<c&&i===s)){if(a<u)do{pt(e,i,e.bl_tree)}while(0!=--a);else 0!==i?(i!==o&&(pt(e,i,e.bl_tree),a--),pt(e,16,e.bl_tree),ht(e,a-3,2)):a<=10?(pt(e,17,e.bl_tree),ht(e,a-3,3)):(pt(e,18,e.bl_tree),ht(e,a-11,7));a=0,o=i,0===s?(c=138,u=3):i===s?(c=6,u=3):(c=7,u=4)}}Je(ct);var kt=!1;function Rt(e,t,n,r){ht(e,0+(r?1:0),3),function(e,t,n,r){gt(e),r&&(ft(e,n),ft(e,~n)),Ye.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}var Tt={_tr_init:function(e){kt||(!function(){var e,t,n,r,i,o=new Array(16);for(n=0,r=0;r<28;r++)for(it[r]=n,e=0;e<1<<$e[r];e++)rt[n++]=r;for(rt[n-1]=r,i=0,r=0;r<16;r++)for(ct[r]=i,e=0;e<1<<Xe[r];e++)nt[i++]=r;for(i>>=7;r<30;r++)for(ct[r]=i<<7,e=0;e<1<<Xe[r]-7;e++)nt[256+i++]=r;for(t=0;t<=15;t++)o[t]=0;for(e=0;e<=143;)et[2*e+1]=8,e++,o[8]++;for(;e<=255;)et[2*e+1]=9,e++,o[9]++;for(;e<=279;)et[2*e+1]=7,e++,o[7]++;for(;e<=287;)et[2*e+1]=8,e++,o[8]++;for(vt(et,287,o),e=0;e<30;e++)tt[2*e+1]=5,tt[2*e]=mt(e,5);ot=new ut(et,$e,257,286,15),st=new ut(tt,Xe,0,30,15),at=new ut(new Array(0),Ze,0,19,7)}(),kt=!0),e.l_desc=new dt(e.dyn_ltree,ot),e.d_desc=new dt(e.dyn_dtree,st),e.bl_desc=new dt(e.bl_tree,at),e.bi_buf=0,e.bi_valid=0,_t(e)},_tr_stored_block:Rt,_tr_flush_block:function(e,t,n,r){var i,o,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),St(e,e.l_desc),St(e,e.d_desc),s=function(e){var t;for(wt(e,e.dyn_ltree,e.l_desc.max_code),wt(e,e.dyn_dtree,e.d_desc.max_code),St(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*Qe[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=n+5,n+4<=i&&-1!==t?Rt(e,t,n,r):4===e.strategy||o===i?(ht(e,2+(r?1:0),3),Et(e,et,tt)):(ht(e,4+(r?1:0),3),function(e,t,n,r){var i;for(ht(e,t-257,5),ht(e,n-1,5),ht(e,r-4,4),i=0;i<r;i++)ht(e,e.bl_tree[2*Qe[i]+1],3);Ct(e,e.dyn_ltree,t-1),Ct(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),Et(e,e.dyn_ltree,e.dyn_dtree)),_t(e),r&&gt(e)},_tr_tally:function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(rt[n]+256+1)]++,e.dyn_dtree[2*lt(t)]++),e.last_lit===e.lit_bufsize-1},_tr_align:function(e){ht(e,2,3),pt(e,256,et),function(e){16===e.bi_valid?(ft(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}};var It=function(e,t,n,r){for(var i=65535&e|0,o=e>>>16&65535|0,s=0;0!==n;){n-=s=n>2e3?2e3:n;do{o=o+(i=i+t[r++]|0)|0}while(--s);i%=65521,o%=65521}return i|o<<16|0};var Ot=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();var At,Dt=function(e,t,n,r){var i=Ot,o=r+n;e^=-1;for(var s=r;s<o;s++)e=e>>>8^i[255&(e^t[s])];return-1^e},Pt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function xt(e,t){return e.msg=Pt[t],t}function Mt(e){return(e<<1)-(e>4?9:0)}function Lt(e){for(var t=e.length;--t>=0;)e[t]=0}function jt(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(Ye.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function Nt(e,t){Tt._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,jt(e.strm)}function Bt(e,t){e.pending_buf[e.pending++]=t}function Ut(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function zt(e,t){var n,r,i=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match,c=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,u=e.window,d=e.w_mask,l=e.prev,f=e.strstart+258,h=u[o+s-1],p=u[o+s];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(u[(n=t)+s]===p&&u[n+s-1]===h&&u[n]===u[o]&&u[++n]===u[o+1]){o+=2,n++;do{}while(u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&o<f);if(r=258-(f-o),o=f-258,r>s){if(e.match_start=t,s=r,r>=a)break;h=u[o+s-1],p=u[o+s]}}}while((t=l[t&d])>c&&0!=--i);return s<=e.lookahead?s:e.lookahead}function Ft(e){var t,n,r,i,o,s,a,c,u,d,l=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=l+(l-262)){Ye.arraySet(e.window,e.window,l,l,0),e.match_start-=l,e.strstart-=l,e.block_start-=l,t=n=e.hash_size;do{r=e.head[--t],e.head[t]=r>=l?r-l:0}while(--n);t=n=l;do{r=e.prev[--t],e.prev[t]=r>=l?r-l:0}while(--n);i+=l}if(0===e.strm.avail_in)break;if(s=e.strm,a=e.window,c=e.strstart+e.lookahead,u=i,d=void 0,(d=s.avail_in)>u&&(d=u),n=0===d?0:(s.avail_in-=d,Ye.arraySet(a,s.input,s.next_in,d,c),1===s.state.wrap?s.adler=It(s.adler,a,d,c):2===s.state.wrap&&(s.adler=Dt(s.adler,a,d,c)),s.next_in+=d,s.total_in+=d,d),e.lookahead+=n,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+3-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)}function Gt(e,t){for(var n,r;;){if(e.lookahead<262){if(Ft(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-262&&(e.match_length=zt(e,n)),e.match_length>=3)if(r=Tt._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=Tt._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(Nt(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(Nt(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Nt(e,!1),0===e.strm.avail_out)?1:2}function Ht(e,t){for(var n,r,i;;){if(e.lookahead<262){if(Ft(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-262&&(e.match_length=zt(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=Tt._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(Nt(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=Tt._tr_tally(e,0,e.window[e.strstart-1]))&&Nt(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=Tt._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(Nt(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Nt(e,!1),0===e.strm.avail_out)?1:2}function Kt(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function Vt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Ye.Buf16(1146),this.dyn_dtree=new Ye.Buf16(122),this.bl_tree=new Ye.Buf16(78),Lt(this.dyn_ltree),Lt(this.dyn_dtree),Lt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Ye.Buf16(16),this.heap=new Ye.Buf16(573),Lt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Ye.Buf16(573),Lt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function qt(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=0,Tt._tr_init(t),0):xt(e,-2)}function Wt(e){var t=qt(e);return 0===t&&function(e){e.window_size=2*e.w_size,Lt(e.head),e.max_lazy_match=At[e.level].max_lazy,e.good_match=At[e.level].good_length,e.nice_match=At[e.level].nice_length,e.max_chain_length=At[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0}(e.state),t}function Yt(e,t,n,r,i,o){if(!e)return-2;var s=1;if(-1===t&&(t=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),i<1||i>9||8!==n||r<8||r>15||t<0||t>9||o<0||o>4)return xt(e,-2);8===r&&(r=9);var a=new Vt;return e.state=a,a.strm=e,a.wrap=s,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Ye.Buf8(2*a.w_size),a.head=new Ye.Buf16(a.hash_size),a.prev=new Ye.Buf16(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Ye.Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=o,a.method=n,Wt(e)}At=[new Kt(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Ft(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,Nt(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-262&&(Nt(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(Nt(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(Nt(e,!1),e.strm.avail_out),1)})),new Kt(4,4,8,4,Gt),new Kt(4,5,16,8,Gt),new Kt(4,6,32,32,Gt),new Kt(4,4,16,16,Ht),new Kt(8,16,32,32,Ht),new Kt(8,16,128,128,Ht),new Kt(8,32,128,256,Ht),new Kt(32,128,258,1024,Ht),new Kt(32,258,258,4096,Ht)];var Jt={deflateInit:function(e,t){return Yt(e,t,8,15,8,0)},deflateInit2:Yt,deflateReset:Wt,deflateResetKeep:qt,deflateSetHeader:function(e,t){return e&&e.state?2!==e.state.wrap?-2:(e.state.gzhead=t,0):-2},deflate:function(e,t){var n,r,i,o;if(!e||!e.state||t>5||t<0)return e?xt(e,-2):-2;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||666===r.status&&4!==t)return xt(e,0===e.avail_out?-5:-2);if(r.strm=e,n=r.last_flush,r.last_flush=t,42===r.status)if(2===r.wrap)e.adler=0,Bt(r,31),Bt(r,139),Bt(r,8),r.gzhead?(Bt(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Bt(r,255&r.gzhead.time),Bt(r,r.gzhead.time>>8&255),Bt(r,r.gzhead.time>>16&255),Bt(r,r.gzhead.time>>24&255),Bt(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),Bt(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Bt(r,255&r.gzhead.extra.length),Bt(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=Dt(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(Bt(r,0),Bt(r,0),Bt(r,0),Bt(r,0),Bt(r,0),Bt(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),Bt(r,3),r.status=113);else{var s=8+(r.w_bits-8<<4)<<8;s|=(r.strategy>=2||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(s|=32),s+=31-s%31,r.status=113,Ut(r,s),0!==r.strstart&&(Ut(r,e.adler>>>16),Ut(r,65535&e.adler)),e.adler=1}if(69===r.status)if(r.gzhead.extra){for(i=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>i&&(e.adler=Dt(e.adler,r.pending_buf,r.pending-i,i)),jt(e),i=r.pending,r.pending!==r.pending_buf_size));)Bt(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>i&&(e.adler=Dt(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(e.adler=Dt(e.adler,r.pending_buf,r.pending-i,i)),jt(e),i=r.pending,r.pending===r.pending_buf_size)){o=1;break}o=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Bt(r,o)}while(0!==o);r.gzhead.hcrc&&r.pending>i&&(e.adler=Dt(e.adler,r.pending_buf,r.pending-i,i)),0===o&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(e.adler=Dt(e.adler,r.pending_buf,r.pending-i,i)),jt(e),i=r.pending,r.pending===r.pending_buf_size)){o=1;break}o=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Bt(r,o)}while(0!==o);r.gzhead.hcrc&&r.pending>i&&(e.adler=Dt(e.adler,r.pending_buf,r.pending-i,i)),0===o&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&jt(e),r.pending+2<=r.pending_buf_size&&(Bt(r,255&e.adler),Bt(r,e.adler>>8&255),e.adler=0,r.status=113)):r.status=113),0!==r.pending){if(jt(e),0===e.avail_out)return r.last_flush=-1,0}else if(0===e.avail_in&&Mt(t)<=Mt(n)&&4!==t)return xt(e,-5);if(666===r.status&&0!==e.avail_in)return xt(e,-5);if(0!==e.avail_in||0!==r.lookahead||0!==t&&666!==r.status){var a=2===r.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(Ft(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=Tt._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Nt(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(Nt(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Nt(e,!1),0===e.strm.avail_out)?1:2}(r,t):3===r.strategy?function(e,t){for(var n,r,i,o,s=e.window;;){if(e.lookahead<=258){if(Ft(e),e.lookahead<=258&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=s[i=e.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){o=e.strstart+258;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<o);e.match_length=258-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=Tt._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Tt._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Nt(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(Nt(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Nt(e,!1),0===e.strm.avail_out)?1:2}(r,t):At[r.level].func(r,t);if(3!==a&&4!==a||(r.status=666),1===a||3===a)return 0===e.avail_out&&(r.last_flush=-1),0;if(2===a&&(1===t?Tt._tr_align(r):5!==t&&(Tt._tr_stored_block(r,0,0,!1),3===t&&(Lt(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),jt(e),0===e.avail_out))return r.last_flush=-1,0}return 4!==t?0:r.wrap<=0?1:(2===r.wrap?(Bt(r,255&e.adler),Bt(r,e.adler>>8&255),Bt(r,e.adler>>16&255),Bt(r,e.adler>>24&255),Bt(r,255&e.total_in),Bt(r,e.total_in>>8&255),Bt(r,e.total_in>>16&255),Bt(r,e.total_in>>24&255)):(Ut(r,e.adler>>>16),Ut(r,65535&e.adler)),jt(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?0:1)},deflateEnd:function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?xt(e,-2):(e.state=null,113===t?xt(e,-3):0):-2},deflateSetDictionary:function(e,t){var n,r,i,o,s,a,c,u,d=t.length;if(!e||!e.state)return-2;if(2===(o=(n=e.state).wrap)||1===o&&42!==n.status||n.lookahead)return-2;for(1===o&&(e.adler=It(e.adler,t,d,0)),n.wrap=0,d>=n.w_size&&(0===o&&(Lt(n.head),n.strstart=0,n.block_start=0,n.insert=0),u=new Ye.Buf8(n.w_size),Ye.arraySet(u,t,d-n.w_size,n.w_size,0),t=u,d=n.w_size),s=e.avail_in,a=e.next_in,c=e.input,e.avail_in=d,e.next_in=0,e.input=t,Ft(n);n.lookahead>=3;){r=n.strstart,i=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+3-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--i);n.strstart=r,n.lookahead=2,Ft(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=a,e.input=c,e.avail_in=s,n.wrap=o,0},deflateInfo:"pako deflate (from Nodeca project)"},$t=!0,Xt=!0;try{String.fromCharCode.apply(null,[0])}catch(e){$t=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Xt=!1}for(var Zt=new Ye.Buf8(256),Qt=0;Qt<256;Qt++)Zt[Qt]=Qt>=252?6:Qt>=248?5:Qt>=240?4:Qt>=224?3:Qt>=192?2:1;Zt[254]=Zt[254]=1;function en(e,t){if(t<65534&&(e.subarray&&Xt||!e.subarray&&$t))return String.fromCharCode.apply(null,Ye.shrinkBuf(e,t));for(var n="",r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n}var tn=function(e){var t,n,r,i,o,s=e.length,a=0;for(i=0;i<s;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(r=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(r-56320),i++),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Ye.Buf8(a),o=0,i=0;o<a;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(r=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(r-56320),i++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},nn=function(e){return en(e,e.length)},rn=function(e){for(var t=new Ye.Buf8(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t},on=function(e,t){var n,r,i,o,s=t||e.length,a=new Array(2*s);for(r=0,n=0;n<s;)if((i=e[n++])<128)a[r++]=i;else if((o=Zt[i])>4)a[r++]=65533,n+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&n<s;)i=i<<6|63&e[n++],o--;o>1?a[r++]=65533:i<65536?a[r++]=i:(i-=65536,a[r++]=55296|i>>10&1023,a[r++]=56320|1023&i)}return en(a,r)},sn=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+Zt[e[n]]>t?n:t};var an=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},cn=Object.prototype.toString;function un(e){if(!(this instanceof un))return new un(e);this.options=Ye.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new an,this.strm.avail_out=0;var n=Jt.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==n)throw new Error(Pt[n]);if(t.header&&Jt.deflateSetHeader(this.strm,t.header),t.dictionary){var r;if(r="string"==typeof t.dictionary?tn(t.dictionary):"[object ArrayBuffer]"===cn.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(n=Jt.deflateSetDictionary(this.strm,r)))throw new Error(Pt[n]);this._dict_set=!0}}function dn(e,t){var n=new un(t);if(n.push(e,!0),n.err)throw n.msg||Pt[n.err];return n.result}un.prototype.push=function(e,t){var n,r,i=this.strm,o=this.options.chunkSize;if(this.ended)return!1;r=t===~~t?t:!0===t?4:0,"string"==typeof e?i.input=tn(e):"[object ArrayBuffer]"===cn.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new Ye.Buf8(o),i.next_out=0,i.avail_out=o),1!==(n=Jt.deflate(i,r))&&0!==n)return this.onEnd(n),this.ended=!0,!1;0!==i.avail_out&&(0!==i.avail_in||4!==r&&2!==r)||("string"===this.options.to?this.onData(nn(Ye.shrinkBuf(i.output,i.next_out))):this.onData(Ye.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||0===i.avail_out)&&1!==n);return 4===r?(n=Jt.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==r||(this.onEnd(0),i.avail_out=0,!0)},un.prototype.onData=function(e){this.chunks.push(e)},un.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ye.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ln={Deflate:un,deflate:dn,deflateRaw:function(e,t){return(t=t||{}).raw=!0,dn(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,dn(e,t)}},fn=function(e,t){var n,r,i,o,s,a,c,u,d,l,f,h,p,m,v,_,g,y,b,E,S,w,C,k,R;n=e.state,r=e.next_in,k=e.input,i=r+(e.avail_in-5),o=e.next_out,R=e.output,s=o-(t-e.avail_out),a=o+(e.avail_out-257),c=n.dmax,u=n.wsize,d=n.whave,l=n.wnext,f=n.window,h=n.hold,p=n.bits,m=n.lencode,v=n.distcode,_=(1<<n.lenbits)-1,g=(1<<n.distbits)-1;e:do{p<15&&(h+=k[r++]<<p,p+=8,h+=k[r++]<<p,p+=8),y=m[h&_];t:for(;;){if(h>>>=b=y>>>24,p-=b,0===(b=y>>>16&255))R[o++]=65535&y;else{if(!(16&b)){if(0==(64&b)){y=m[(65535&y)+(h&(1<<b)-1)];continue t}if(32&b){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}E=65535&y,(b&=15)&&(p<b&&(h+=k[r++]<<p,p+=8),E+=h&(1<<b)-1,h>>>=b,p-=b),p<15&&(h+=k[r++]<<p,p+=8,h+=k[r++]<<p,p+=8),y=v[h&g];n:for(;;){if(h>>>=b=y>>>24,p-=b,!(16&(b=y>>>16&255))){if(0==(64&b)){y=v[(65535&y)+(h&(1<<b)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(S=65535&y,p<(b&=15)&&(h+=k[r++]<<p,(p+=8)<b&&(h+=k[r++]<<p,p+=8)),(S+=h&(1<<b)-1)>c){e.msg="invalid distance too far back",n.mode=30;break e}if(h>>>=b,p-=b,S>(b=o-s)){if((b=S-b)>d&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(w=0,C=f,0===l){if(w+=u-b,b<E){E-=b;do{R[o++]=f[w++]}while(--b);w=o-S,C=R}}else if(l<b){if(w+=u+l-b,(b-=l)<E){E-=b;do{R[o++]=f[w++]}while(--b);if(w=0,l<E){E-=b=l;do{R[o++]=f[w++]}while(--b);w=o-S,C=R}}}else if(w+=l-b,b<E){E-=b;do{R[o++]=f[w++]}while(--b);w=o-S,C=R}for(;E>2;)R[o++]=C[w++],R[o++]=C[w++],R[o++]=C[w++],E-=3;E&&(R[o++]=C[w++],E>1&&(R[o++]=C[w++]))}else{w=o-S;do{R[o++]=R[w++],R[o++]=R[w++],R[o++]=R[w++],E-=3}while(E>2);E&&(R[o++]=R[w++],E>1&&(R[o++]=R[w++]))}break}}break}}while(r<i&&o<a);r-=E=p>>3,h&=(1<<(p-=E<<3))-1,e.next_in=r,e.next_out=o,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=o<a?a-o+257:257-(o-a),n.hold=h,n.bits=p},hn=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],pn=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],mn=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],vn=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],_n=function(e,t,n,r,i,o,s,a){var c,u,d,l,f,h,p,m,v,_=a.bits,g=0,y=0,b=0,E=0,S=0,w=0,C=0,k=0,R=0,T=0,I=null,O=0,A=new Ye.Buf16(16),D=new Ye.Buf16(16),P=null,x=0;for(g=0;g<=15;g++)A[g]=0;for(y=0;y<r;y++)A[t[n+y]]++;for(S=_,E=15;E>=1&&0===A[E];E--);if(S>E&&(S=E),0===E)return i[o++]=20971520,i[o++]=20971520,a.bits=1,0;for(b=1;b<E&&0===A[b];b++);for(S<b&&(S=b),k=1,g=1;g<=15;g++)if(k<<=1,(k-=A[g])<0)return-1;if(k>0&&(0===e||1!==E))return-1;for(D[1]=0,g=1;g<15;g++)D[g+1]=D[g]+A[g];for(y=0;y<r;y++)0!==t[n+y]&&(s[D[t[n+y]]++]=y);if(0===e?(I=P=s,h=19):1===e?(I=hn,O-=257,P=pn,x-=257,h=256):(I=mn,P=vn,h=-1),T=0,y=0,g=b,f=o,w=S,C=0,d=-1,l=(R=1<<S)-1,1===e&&R>852||2===e&&R>592)return 1;for(;;){p=g-C,s[y]<h?(m=0,v=s[y]):s[y]>h?(m=P[x+s[y]],v=I[O+s[y]]):(m=96,v=0),c=1<<g-C,b=u=1<<w;do{i[f+(T>>C)+(u-=c)]=p<<24|m<<16|v|0}while(0!==u);for(c=1<<g-1;T&c;)c>>=1;if(0!==c?(T&=c-1,T+=c):T=0,y++,0==--A[g]){if(g===E)break;g=t[n+s[y]]}if(g>S&&(T&l)!==d){for(0===C&&(C=S),f+=b,k=1<<(w=g-C);w+C<E&&!((k-=A[w+C])<=0);)w++,k<<=1;if(R+=1<<w,1===e&&R>852||2===e&&R>592)return 1;i[d=T&l]=S<<24|w<<16|f-o|0}}return 0!==T&&(i[f+T]=g-C<<24|64<<16|0),a.bits=S,0};function gn(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function yn(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Ye.Buf16(320),this.work=new Ye.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function bn(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Ye.Buf32(852),t.distcode=t.distdyn=new Ye.Buf32(592),t.sane=1,t.back=-1,0):-2}function En(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,bn(e)):-2}function Sn(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,En(e))):-2}function wn(e,t){var n,r;return e?(r=new yn,e.state=r,r.window=null,0!==(n=Sn(e,t))&&(e.state=null),n):-2}var Cn,kn,Rn=!0;function Tn(e){if(Rn){var t;for(Cn=new Ye.Buf32(512),kn=new Ye.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(_n(1,e.lens,0,288,Cn,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;_n(2,e.lens,0,32,kn,0,e.work,{bits:5}),Rn=!1}e.lencode=Cn,e.lenbits=9,e.distcode=kn,e.distbits=5}function In(e,t,n,r){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Ye.Buf8(o.wsize)),r>=o.wsize?(Ye.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((i=o.wsize-o.wnext)>r&&(i=r),Ye.arraySet(o.window,t,n-r,i,o.wnext),(r-=i)?(Ye.arraySet(o.window,t,n-r,r,0),o.wnext=r,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}var On={inflateReset:En,inflateReset2:Sn,inflateResetKeep:bn,inflateInit:function(e){return wn(e,15)},inflateInit2:wn,inflate:function(e,t){var n,r,i,o,s,a,c,u,d,l,f,h,p,m,v,_,g,y,b,E,S,w,C,k,R=0,T=new Ye.Buf8(4),I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(n=e.state).mode&&(n.mode=13),s=e.next_out,i=e.output,c=e.avail_out,o=e.next_in,r=e.input,a=e.avail_in,u=n.hold,d=n.bits,l=a,f=c,w=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;d<16;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}if(2&n.wrap&&35615===u){n.check=0,T[0]=255&u,T[1]=u>>>8&255,n.check=Dt(n.check,T,2,0),u=0,d=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&u)){e.msg="unknown compression method",n.mode=30;break}if(d-=4,S=8+(15&(u>>>=4)),0===n.wbits)n.wbits=S;else if(S>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<S,e.adler=n.check=1,n.mode=512&u?10:12,u=0,d=0;break;case 2:for(;d<16;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}if(n.flags=u,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=u>>8&1),512&n.flags&&(T[0]=255&u,T[1]=u>>>8&255,n.check=Dt(n.check,T,2,0)),u=0,d=0,n.mode=3;case 3:for(;d<32;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}n.head&&(n.head.time=u),512&n.flags&&(T[0]=255&u,T[1]=u>>>8&255,T[2]=u>>>16&255,T[3]=u>>>24&255,n.check=Dt(n.check,T,4,0)),u=0,d=0,n.mode=4;case 4:for(;d<16;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}n.head&&(n.head.xflags=255&u,n.head.os=u>>8),512&n.flags&&(T[0]=255&u,T[1]=u>>>8&255,n.check=Dt(n.check,T,2,0)),u=0,d=0,n.mode=5;case 5:if(1024&n.flags){for(;d<16;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}n.length=u,n.head&&(n.head.extra_len=u),512&n.flags&&(T[0]=255&u,T[1]=u>>>8&255,n.check=Dt(n.check,T,2,0)),u=0,d=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((h=n.length)>a&&(h=a),h&&(n.head&&(S=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),Ye.arraySet(n.head.extra,r,o,h,S)),512&n.flags&&(n.check=Dt(n.check,r,h,o)),a-=h,o+=h,n.length-=h),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===a)break e;h=0;do{S=r[o+h++],n.head&&S&&n.length<65536&&(n.head.name+=String.fromCharCode(S))}while(S&&h<a);if(512&n.flags&&(n.check=Dt(n.check,r,h,o)),a-=h,o+=h,S)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===a)break e;h=0;do{S=r[o+h++],n.head&&S&&n.length<65536&&(n.head.comment+=String.fromCharCode(S))}while(S&&h<a);if(512&n.flags&&(n.check=Dt(n.check,r,h,o)),a-=h,o+=h,S)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;d<16;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}if(u!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}u=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;d<32;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}e.adler=n.check=gn(u),u=0,d=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,n.hold=u,n.bits=d,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){u>>>=7&d,d-=7&d,n.mode=27;break}for(;d<3;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}switch(n.last=1&u,d-=1,3&(u>>>=1)){case 0:n.mode=14;break;case 1:if(Tn(n),n.mode=20,6===t){u>>>=2,d-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}u>>>=2,d-=2;break;case 14:for(u>>>=7&d,d-=7&d;d<32;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&u,u=0,d=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(h=n.length){if(h>a&&(h=a),h>c&&(h=c),0===h)break e;Ye.arraySet(i,r,o,h,s),a-=h,o+=h,c-=h,s+=h,n.length-=h;break}n.mode=12;break;case 17:for(;d<14;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}if(n.nlen=257+(31&u),u>>>=5,d-=5,n.ndist=1+(31&u),u>>>=5,d-=5,n.ncode=4+(15&u),u>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;d<3;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}n.lens[I[n.have++]]=7&u,u>>>=3,d-=3}for(;n.have<19;)n.lens[I[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,C={bits:n.lenbits},w=_n(0,n.lens,0,19,n.lencode,0,n.work,C),n.lenbits=C.bits,w){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;_=(R=n.lencode[u&(1<<n.lenbits)-1])>>>16&255,g=65535&R,!((v=R>>>24)<=d);){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}if(g<16)u>>>=v,d-=v,n.lens[n.have++]=g;else{if(16===g){for(k=v+2;d<k;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}if(u>>>=v,d-=v,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}S=n.lens[n.have-1],h=3+(3&u),u>>>=2,d-=2}else if(17===g){for(k=v+3;d<k;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}d-=v,S=0,h=3+(7&(u>>>=v)),u>>>=3,d-=3}else{for(k=v+7;d<k;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}d-=v,S=0,h=11+(127&(u>>>=v)),u>>>=7,d-=7}if(n.have+h>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;h--;)n.lens[n.have++]=S}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,C={bits:n.lenbits},w=_n(1,n.lens,0,n.nlen,n.lencode,0,n.work,C),n.lenbits=C.bits,w){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,C={bits:n.distbits},w=_n(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,C),n.distbits=C.bits,w){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(a>=6&&c>=258){e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,n.hold=u,n.bits=d,fn(e,f),s=e.next_out,i=e.output,c=e.avail_out,o=e.next_in,r=e.input,a=e.avail_in,u=n.hold,d=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;_=(R=n.lencode[u&(1<<n.lenbits)-1])>>>16&255,g=65535&R,!((v=R>>>24)<=d);){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}if(_&&0==(240&_)){for(y=v,b=_,E=g;_=(R=n.lencode[E+((u&(1<<y+b)-1)>>y)])>>>16&255,g=65535&R,!(y+(v=R>>>24)<=d);){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}u>>>=y,d-=y,n.back+=y}if(u>>>=v,d-=v,n.back+=v,n.length=g,0===_){n.mode=26;break}if(32&_){n.back=-1,n.mode=12;break}if(64&_){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&_,n.mode=22;case 22:if(n.extra){for(k=n.extra;d<k;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;_=(R=n.distcode[u&(1<<n.distbits)-1])>>>16&255,g=65535&R,!((v=R>>>24)<=d);){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}if(0==(240&_)){for(y=v,b=_,E=g;_=(R=n.distcode[E+((u&(1<<y+b)-1)>>y)])>>>16&255,g=65535&R,!(y+(v=R>>>24)<=d);){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}u>>>=y,d-=y,n.back+=y}if(u>>>=v,d-=v,n.back+=v,64&_){e.msg="invalid distance code",n.mode=30;break}n.offset=g,n.extra=15&_,n.mode=24;case 24:if(n.extra){for(k=n.extra;d<k;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===c)break e;if(h=f-c,n.offset>h){if((h=n.offset-h)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}h>n.wnext?(h-=n.wnext,p=n.wsize-h):p=n.wnext-h,h>n.length&&(h=n.length),m=n.window}else m=i,p=s-n.offset,h=n.length;h>c&&(h=c),c-=h,n.length-=h;do{i[s++]=m[p++]}while(--h);0===n.length&&(n.mode=21);break;case 26:if(0===c)break e;i[s++]=n.length,c--,n.mode=21;break;case 27:if(n.wrap){for(;d<32;){if(0===a)break e;a--,u|=r[o++]<<d,d+=8}if(f-=c,e.total_out+=f,n.total+=f,f&&(e.adler=n.check=n.flags?Dt(n.check,i,f,s-f):It(n.check,i,f,s-f)),f=c,(n.flags?u:gn(u))!==n.check){e.msg="incorrect data check",n.mode=30;break}u=0,d=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;d<32;){if(0===a)break e;a--,u+=r[o++]<<d,d+=8}if(u!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}u=0,d=0}n.mode=29;case 29:w=1;break e;case 30:w=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,n.hold=u,n.bits=d,(n.wsize||f!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&In(e,e.output,e.next_out,f-e.avail_out),l-=e.avail_in,f-=e.avail_out,e.total_in+=l,e.total_out+=f,n.total+=f,n.wrap&&f&&(e.adler=n.check=n.flags?Dt(n.check,i,f,e.next_out-f):It(n.check,i,f,e.next_out-f)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===l&&0===f||4===t)&&0===w&&(w=-5),w},inflateEnd:function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},inflateGetHeader:function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?-2:(n.head=t,t.done=!1,0):-2},inflateSetDictionary:function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?-2:11===n.mode&&It(1,t,r,0)!==n.check?-3:In(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,0):-2},inflateInfo:"pako inflate (from Nodeca project)"},An={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};var Dn=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Pn=Object.prototype.toString;function xn(e){if(!(this instanceof xn))return new xn(e);this.options=Ye.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new an,this.strm.avail_out=0;var n=On.inflateInit2(this.strm,t.windowBits);if(n!==An.Z_OK)throw new Error(Pt[n]);if(this.header=new Dn,On.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=tn(t.dictionary):"[object ArrayBuffer]"===Pn.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=On.inflateSetDictionary(this.strm,t.dictionary))!==An.Z_OK))throw new Error(Pt[n])}function Mn(e,t){var n=new xn(t);if(n.push(e,!0),n.err)throw n.msg||Pt[n.err];return n.result}xn.prototype.push=function(e,t){var n,r,i,o,s,a=this.strm,c=this.options.chunkSize,u=this.options.dictionary,d=!1;if(this.ended)return!1;r=t===~~t?t:!0===t?An.Z_FINISH:An.Z_NO_FLUSH,"string"==typeof e?a.input=rn(e):"[object ArrayBuffer]"===Pn.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new Ye.Buf8(c),a.next_out=0,a.avail_out=c),(n=On.inflate(a,An.Z_NO_FLUSH))===An.Z_NEED_DICT&&u&&(n=On.inflateSetDictionary(this.strm,u)),n===An.Z_BUF_ERROR&&!0===d&&(n=An.Z_OK,d=!1),n!==An.Z_STREAM_END&&n!==An.Z_OK)return this.onEnd(n),this.ended=!0,!1;a.next_out&&(0!==a.avail_out&&n!==An.Z_STREAM_END&&(0!==a.avail_in||r!==An.Z_FINISH&&r!==An.Z_SYNC_FLUSH)||("string"===this.options.to?(i=sn(a.output,a.next_out),o=a.next_out-i,s=on(a.output,i),a.next_out=o,a.avail_out=c-o,o&&Ye.arraySet(a.output,a.output,i,o,0),this.onData(s)):this.onData(Ye.shrinkBuf(a.output,a.next_out)))),0===a.avail_in&&0===a.avail_out&&(d=!0)}while((a.avail_in>0||0===a.avail_out)&&n!==An.Z_STREAM_END);return n===An.Z_STREAM_END&&(r=An.Z_FINISH),r===An.Z_FINISH?(n=On.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===An.Z_OK):r!==An.Z_SYNC_FLUSH||(this.onEnd(An.Z_OK),a.avail_out=0,!0)},xn.prototype.onData=function(e){this.chunks.push(e)},xn.prototype.onEnd=function(e){e===An.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ye.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Ln={Inflate:xn,inflate:Mn,inflateRaw:function(e,t){return(t=t||{}).raw=!0,Mn(e,t)},ungzip:Mn},jn={};(0,Ye.assign)(jn,ln,Ln,An);var Nn=jn;function Bn(e){return(Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Un=function(){for(var e,t,n=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],r=[],i=0;i<n.length;i+=1)r[n[i]]=i;var o=function(n){e=n,t=0},s=function(){if(!e)return-1;if(t>=e.length)return-1;var n=255&e.charCodeAt(t);return t+=1,n},a=function(){if(!e)return-1;for(;;){if(t>=e.length)return-1;var n=e.charAt(t);if(t+=1,r[n])return r[n];if("A"===n)return 0}},c=function(e){var t=e.toString(16);return 1===t.length&&(t="0".concat(t)),t="%".concat(t),unescape(t)};return{encodeBase64:function(e){var t,r,i;o(e),t="";var a=new Array(3);for(r=0,i=!1;!i&&-1!==(a[0]=s());)a[1]=s(),a[2]=s(),t+=n[a[0]>>2],-1!==a[1]?(t+=n[a[0]<<4&48|a[1]>>4],-1!==a[2]?(t+=n[a[1]<<2&60|a[2]>>6],t+=n[63&a[2]]):(t+=n[a[1]<<2&60],t="".concat(t,"="),i=!0)):(t+=n[a[0]<<4&48],t="".concat(t,"="),t="".concat(t,"="),i=!0),(r+=4)>=76&&(t="".concat(t,"\n"),r=0);return t},decodeBase64:function(e){var t,n;o(e),t="";var r=new Array(4);for(n=!1;!n&&-1!==(r[0]=a())&&-1!==(r[1]=a());)r[2]=a(),r[3]=a(),t+=c(r[0]<<2&255|r[1]>>4),-1!==r[2]?(t+=c(r[1]<<4&255|r[2]>>2),-1!==r[3]?t+=c(r[2]<<6&255|r[3]):n=!0):n=!0;return t}}}(),zn={maxkbps:1400,screen:!1,audio:!0,video:!0},Fn=0,Gn=1,Hn=2,Kn=0,Vn=0,qn=function(){function e(){}return e.getDeviceId=function(){if(e.deviceId)return e.deviceId;var t=localStorage.getItem("DEVICE_ID_KEY");return t||(t=We(),localStorage.setItem("DEVICE_ID_KEY",t)),e.deviceId=t,t},e.getSessionId=function(){if(e.sessionId)return e.sessionId;var t=localStorage.getItem("SESSION_ID_KEY");return t||(t=We(),localStorage.setItem("SESSION_ID_KEY",t)),e.sessionId=t,t},e.token2auth=function(t,n,r,i){return t?"Bearer "+t:"Basic "+e.createUnsafeToken(n,r,i)},e.createUnsafeToken=function(e,t,n){return Un.encodeBase64([e,t,n].join(":"))},e.merge=function(t,n){void 0===t&&(t={}),void 0===n&&(n={});for(var r=0,i=Object.entries(t);r<i.length;r++){var o=i[r],s=o[0],a=o[1];null!==a&&"object"===Bn(a)?e.merge(t[s],n[s]):void 0!==n[s]&&(t[s]=n[s])}},e.mergePublishConstraints=function(t){return void 0===t&&(t={}),t.screen&&(t.audio=!1),e.merge(zn,t),s({},zn)},e.mergeTranscodeConstraints=function(e,t){return t.transcodeMeta&&(t.transcodeMeta.transcode={url:e}),t},e.ab2obj=function(e){try{var t=String.fromCharCode.apply(null,new Uint8Array(e));return JSON.parse(t)}catch(e){return{}}},e.ab2string=function(e){try{return String.fromCharCode.apply(null,new Uint8Array(e))}catch(e){return""}},e.str2ab=function(e){var t=new ArrayBuffer(e.length);try{for(var n=new Uint8Array(t),r=0,i=e.length;r<i;r++)n[r]=e.charCodeAt(r);return t}catch(e){return t}},e}(),Wn={unknown:900001,invalidParameter:100001,notInRoom:100002,inRoom:100003,connectingRoom:100004,autoSubscribe:100005,dataChannelCannotConnect:100006,dataChannelTimeout:100007,start_connect:200001,connected:200002,connect_error:200003,connect_timeout:200004,reconnected:200005,reconnect_error:200006,reconnect_failed:200007,disconnect:200008,error:200009,streamFailed:300001,iceFailed:300002,connectionFailed:300003,setAnswerFailed:300004},Yn=function(e){function t(t,n){var r=e.call(this,n)||this;return r.code=t,r}return o(t,e),t}(Error);function Jn(e){var t=e.method,n=e.url,r=e.body,i=void 0===r?{}:r,o=e.headers,s=void 0===o?{}:o,u=e.stringify,d=void 0===u||u;return a(this,void 0,void 0,(function(){return c(this,(function(e){return[2,new Promise((function(e,r){var o=new XMLHttpRequest;o.open(t,n,!0);for(var a=0,c=Object.entries(s);a<c.length;a++){var u=c[a],l=u[0],f=u[1];o.setRequestHeader(l,f)}o.onreadystatechange=function(){4===o.readyState&&200===o.status&&e(JSON.parse(o.responseText)),o.status>=400&&(r({message:o.statusText,code:1e3*o.status}),o.abort())},o.onerror=function(e){var t=Wn.unknown;o.status>=400&&(t=1e3*o.status),r({code:t,message:o.responseText||"unknow"})},d&&(i=JSON.stringify(i)),o.send(i)}))]}))}))}function $n(e,t,n,r){return a(this,void 0,void 0,(function(){return c(this,(function(i){return[2,Jn({method:"POST",url:e,body:t,headers:n,stringify:r})]}))}))}var Xn=["https://common.rtc.volcvideo.com/decision/v1/multi","https://common-hl.rtc.volcvideo.com/decision/v1/multi"],Zn="https://web-log-report.rtc.volcvideo.com/video/v1/webrtc_log/",Qn=new(function(){function e(){var e=this;this._header={product_line:"rtc",project_key:"_app_name_",report_version:"5",rtc_sdk_version:"3.18.29",rtc_sdk_version_num:"3.18.29".split(".").map((function(e,t){return parseInt(e)*Math.pow(10,[12,9,6,0][t])})).reduce((function(e,t){return e+t}),0),user_agent:window.navigator.userAgent,device_id:qn.getDeviceId(),engine_id:We(),rtc_app_id:"",oner_app_id:"",room_id:"",user_id:"",rtc_business_id:"",rtc_call_id:"",report_time:"",report_log_count:0,config_server:""},this._reportId=0,this._inRoom=0,this._cache=[],this._getPropsFromStore(),De.subscribe((function(){return e._getPropsFromStore()}))}return e.prototype._getPropsFromStore=function(){var e=De.getState(),t=e.appId,n=e.roomId,r=e.clientId,i=e.configServer,o=e.callId;this._appId=this._header.rtc_app_id=t,this._roomId=this._header.room_id=n,this._userId=this._header.user_id=r,this._callId=this._header.rtc_call_id=o,this._header.config_server=JSON.stringify(i)},e.prototype.start=function(){var e=this;this._send2server({}),window.addEventListener("unload",(function(){return e._send2server({sendByBeacon:!0})}))},e.prototype.stop=function(){clearTimeout(this._timer),this._send2server({goon:!1})},e.prototype.addLog=function(e){for(var t={event_type:"event",report_id:this._reportId++,in_room:this._inRoom,session_id:null,error_code:0,time:Date.now()},n=0,r=Object.entries(e);n<r.length;n++){var i=r[n],o=i[0],s=i[1];"code"!==o||"number"!=typeof s?t[o]=s:t.error_code=s}this._cache.push(t)},e.prototype._send2server=function(e){var t=void 0===e?{}:e,n=t.sendByBeacon,r=void 0!==n&&n,i=t.goon,o=void 0===i||i;return a(this,void 0,void 0,(function(){var e,t,n,i;return c(this,(function(s){switch(s.label){case 0:return(e=this._cache.length)?(this._header.report_time=(new Date).toLocaleString(),this._header.report_log_count=e,t={data:u(this._cache),header:this._header,from:"web",os:"web",version:"3.18.29"},r?(navigator.sendBeacon(Zn,JSON.stringify(t)),[2]):(n=void 0,e>20?(i={"Content-Encoding":"gzip","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},[4,$n(Zn,Nn.gzip(JSON.stringify(t)),i,!1)]):[3,2])):[3,5];case 1:return n=s.sent(),[3,4];case 2:return[4,$n(Zn,t)];case 3:n=s.sent(),s.label=4;case 4:0===(null==n?void 0:n.StatusCode)&&this._cache.splice(0,e),s.label=5;case 5:return o&&(this._timer=setTimeout(this._send2server.bind(this),5e3)),[2]}}))}))},Object.defineProperty(e.prototype,"inRoom",{set:function(e){this._inRoom=e?1:0},enumerable:!1,configurable:!0}),e}()),er=["","*","*WARN* *ERROR*","*ERROR*"],tr=function(){function e(e){e?(this._debug=ze.debug("ByteRTC:"+e),this._warn=ze.debug("ByteRTC:WARN:"+e),this._error=ze.debug("ByteRTC:ERROR:"+e)):(this._debug=ze.debug("ByteRTC"),this._warn=ze.debug("ByteRTC:WARN"),this._error=ze.debug("ByteRTC:ERROR")),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}return e.prototype.debug=function(e,t){void 0===t&&(t=!0);var n=e.message,r=e.event_key,i=e.sdk_api_name,o=void 0===i?" ":i;t&&this._debug("%s %s %o",r,o||" ",n),e.event_key&&Qn.addLog(e)},Object.defineProperty(e.prototype,"info",{get:function(){return this._debug},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"warn",{get:function(){return this._warn},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),e.setLogLevel=function(e){window.localStorage.setItem("debug",er[e])},e}(),nr=L((function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new i(r,o||e,s),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,s=new Array(o);i<o;i++)s[i]=r[i].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,o,s){var a=n?n+e:e;if(!this._events[a])return!1;var c,u,d=this._events[a],l=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),l){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,r),!0;case 4:return d.fn.call(d.context,t,r,i),!0;case 5:return d.fn.call(d.context,t,r,i,o),!0;case 6:return d.fn.call(d.context,t,r,i,o,s),!0}for(u=1,c=new Array(l-1);u<l;u++)c[u-1]=arguments[u];d.fn.apply(d.context,c)}else{var f,h=d.length;for(u=0;u<h;u++)switch(d[u].once&&this.removeListener(e,d[u].fn,void 0,!0),l){case 1:d[u].fn.call(d[u].context);break;case 2:d[u].fn.call(d[u].context,t);break;case 3:d[u].fn.call(d[u].context,t,r);break;case 4:d[u].fn.call(d[u].context,t,r,i);break;default:if(!c)for(f=1,c=new Array(l-1);f<l;f++)c[f-1]=arguments[f];d[u].fn.apply(d[u].context,c)}}return!0},a.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||s(this,o);else{for(var c=0,u=[],d=a.length;c<d;c++)(a[c].fn!==t||i&&!a[c].once||r&&a[c].context!==r)&&u.push(a[c]);u.length?this._events[o]=1===u.length?u[0]:u:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a})),rr=new tr("EnhancedEventEmitter"),ir=function(e){function t(){return e.call(this)||this}return o(t,e),t.prototype.safeEmit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.listenerCount(e);try{return this.emit.apply(this,u([e],t))}catch(t){return rr.error("safeEmit() | event listener threw an error [event:%s]:%o",e,t),Boolean(r)}},t.prototype.safeEmitAsPromise=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return a(this,void 0,void 0,(function(){var n=this;return c(this,(function(r){return[2,new Promise((function(r,i){try{n.emit.apply(n,u([e],t,[r,i]))}catch(t){rr.error("safeEmitAsPromise() | event listener threw an error [event:%s]:%o",e,t),i(t)}}))]}))}))},t}(nr.EventEmitter),or=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,sr=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],ar=function(e){var t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));for(var i=or.exec(e||""),o={},s=14;s--;)o[sr[s]]=i[s]||"";return-1!=n&&-1!=r&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o},cr=36e5,ur=24*cr,dr=function(e,t){return t=t||{},"string"==typeof e?function(e){if((e=""+e).length>1e4)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"days":case"day":case"d":return n*ur;case"hours":case"hour":case"hrs":case"hr":case"h":return n*cr;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*n;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}(e):t.long?function(e){return lr(e,ur,"day")||lr(e,cr,"hour")||lr(e,6e4,"minute")||lr(e,1e3,"second")||e+" ms"}(e):function(e){return e>=ur?Math.round(e/ur)+"d":e>=cr?Math.round(e/cr)+"h":e>=6e4?Math.round(e/6e4)+"m":e>=1e3?Math.round(e/1e3)+"s":e+"ms"}(e)};function lr(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var fr=L((function(e,t){(t=e.exports=function(e){function r(){}function o(){var e=o,r=+new Date,s=r-(n||r);e.diff=s,e.prev=n,e.curr=r,n=r,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=i());var a=Array.prototype.slice.call(arguments);a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&(a=["%o"].concat(a));var c=0;a[0]=a[0].replace(/%([a-z%])/g,(function(n,r){if("%%"===n)return n;c++;var i=t.formatters[r];if("function"==typeof i){var o=a[c];n=i.call(e,o),a.splice(c,1),c--}return n})),"function"==typeof t.formatArgs&&(a=t.formatArgs.apply(e,a));var u=o.log||t.log||console.log.bind(console);u.apply(e,a)}r.enabled=!1,o.enabled=!0;var s=t.enabled(e)?o:r;return s.namespace=e,s}).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e);for(var n=(e||"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&("-"===(e=n[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=dr,t.names=[],t.skips=[],t.formatters={};var n,r=0;function i(){return t.colors[r++%t.colors.length]}})),hr=L((function(e,t){function n(){var e;try{e=t.storage.debug}catch(e){}return e}(t=e.exports=fr).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,o=0;return e[0].replace(/%[a-z%]/g,(function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))})),e.splice(o,0,r),e},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(n())})),pr=hr("socket.io-client:url"),mr=function(e,t){var n=e;t=t||x.location;null==e&&(e=t.protocol+"//"+t.host);"string"==typeof e&&("/"==e.charAt(0)&&(e="/"==e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(pr("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),pr("parse %s",e),n=ar(e));n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443"));n.path=n.path||"/";var r=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+r+":"+n.port,n.href=n.protocol+"://"+r+(t&&t.port==n.port?"":":"+n.port),n};var vr=36e5,_r=24*vr,gr=function(e,t){return t=t||{},"string"==typeof e?function(e){if((e=""+e).length>1e4)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"days":case"day":case"d":return n*_r;case"hours":case"hour":case"hrs":case"hr":case"h":return n*vr;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*n;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}(e):t.long?function(e){return yr(e,_r,"day")||yr(e,vr,"hour")||yr(e,6e4,"minute")||yr(e,1e3,"second")||e+" ms"}(e):function(e){return e>=_r?Math.round(e/_r)+"d":e>=vr?Math.round(e/vr)+"h":e>=6e4?Math.round(e/6e4)+"m":e>=1e3?Math.round(e/1e3)+"s":e+"ms"}(e)};function yr(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var br=L((function(e,t){(t=e.exports=function(e){function r(){}function o(){var e=o,r=+new Date,s=r-(n||r);e.diff=s,e.prev=n,e.curr=r,n=r,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=i());var a=Array.prototype.slice.call(arguments);a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&(a=["%o"].concat(a));var c=0;a[0]=a[0].replace(/%([a-z%])/g,(function(n,r){if("%%"===n)return n;c++;var i=t.formatters[r];if("function"==typeof i){var o=a[c];n=i.call(e,o),a.splice(c,1),c--}return n})),"function"==typeof t.formatArgs&&(a=t.formatArgs.apply(e,a));var u=o.log||t.log||console.log.bind(console);u.apply(e,a)}r.enabled=!1,o.enabled=!0;var s=t.enabled(e)?o:r;return s.namespace=e,s}).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e);for(var n=(e||"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&("-"===(e=n[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=gr,t.names=[],t.skips=[],t.formatters={};var n,r=0;function i(){return t.colors[r++%t.colors.length]}})),Er=L((function(e,t){function n(){var e;try{e=t.storage.debug}catch(e){}return e}(t=e.exports=br).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,o=0;return e[0].replace(/%[a-z%]/g,(function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))})),e.splice(o,0,r),e},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(n())})),Sr=L((function(e,t){(function(){var n={function:!0,object:!0},r=n.object&&t&&!t.nodeType&&t,i=n[typeof window]&&window||this,o=r&&n.object&&e&&!e.nodeType&&"object"==typeof x&&x;function s(e,t){e||(e=i.Object()),t||(t=i.Object());var r=e.Number||i.Number,o=e.String||i.String,a=e.Object||i.Object,c=e.Date||i.Date,u=e.SyntaxError||i.SyntaxError,d=e.TypeError||i.TypeError,l=e.Math||i.Math,f=e.JSON||i.JSON;"object"==typeof f&&f&&(t.stringify=f.stringify,t.parse=f.parse);var h,p,m=a.prototype,v=m.toString,_=new c(-0xc782b5b800cec);try{_=-109252==_.getUTCFullYear()&&0===_.getUTCMonth()&&1===_.getUTCDate()&&10==_.getUTCHours()&&37==_.getUTCMinutes()&&6==_.getUTCSeconds()&&708==_.getUTCMilliseconds()}catch(e){}function g(e){if(void 0!==g[e])return g[e];var n;if("bug-string-char-index"==e)n="a"!="a"[0];else if("json"==e)n=g("json-stringify")&&g("json-parse");else{var i,s='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var a=t.stringify,u="function"==typeof a&&_;if(u){(i=function(){return 1}).toJSON=i;try{u="0"===a(0)&&"0"===a(new r)&&'""'==a(new o)&&void 0===a(v)&&void 0===a(void 0)&&void 0===a()&&"1"===a(i)&&"[1]"==a([i])&&"[null]"==a([void 0])&&"null"==a(null)&&"[null,null,null]"==a([void 0,v,null])&&a({a:[i,!0,!1,null,"\0\b\n\f\r\t"]})==s&&"1"===a(null,i)&&"[\n 1,\n 2\n]"==a([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==a(new c(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==a(new c(864e13))&&'"-000001-01-01T00:00:00.000Z"'==a(new c(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==a(new c(-1))}catch(e){u=!1}}n=u}if("json-parse"==e){var d=t.parse;if("function"==typeof d)try{if(0===d("0")&&!d(!1)){var l=5==(i=d(s)).a.length&&1===i.a[0];if(l){try{l=!d('"\t"')}catch(e){}if(l)try{l=1!==d("01")}catch(e){}if(l)try{l=1!==d("1.")}catch(e){}}}}catch(e){l=!1}n=l}}return g[e]=!!n}if(!g("json")){var y=g("bug-string-char-index");if(!_)var b=l.floor,E=[0,31,59,90,120,151,181,212,243,273,304,334],S=function(e,t){return E[t]+365*(e-1970)+b((e-1969+(t=+(t>1)))/4)-b((e-1901+t)/100)+b((e-1601+t)/400)};if((h=m.hasOwnProperty)||(h=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=v?h=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,h=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,h.call(this,e)}),p=function(e,t){var r,i,o,s=0;for(o in(r=function(){this.valueOf=0}).prototype.valueOf=0,i=new r)h.call(i,o)&&s++;return r=i=null,s?p=2==s?function(e,t){var n,r={},i="[object Function]"==v.call(e);for(n in e)i&&"prototype"==n||h.call(r,n)||!(r[n]=1)||!h.call(e,n)||t(n)}:function(e,t){var n,r,i="[object Function]"==v.call(e);for(n in e)i&&"prototype"==n||!h.call(e,n)||(r="constructor"===n)||t(n);(r||h.call(e,n="constructor"))&&t(n)}:(i=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],p=function(e,t){var r,o,s="[object Function]"==v.call(e),a=!s&&"function"!=typeof e.constructor&&n[typeof e.hasOwnProperty]&&e.hasOwnProperty||h;for(r in e)s&&"prototype"==r||!a.call(e,r)||t(r);for(o=i.length;r=i[--o];a.call(e,r)&&t(r));}),p(e,t)},!g("json-stringify")){var w={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},C=function(e,t){return("000000"+(t||0)).slice(-e)},k=function(e){for(var t='"',n=0,r=e.length,i=!y||r>10,o=i&&(y?e.split(""):e);n<r;n++){var s=e.charCodeAt(n);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=w[s];break;default:if(s<32){t+="\\u00"+C(2,s.toString(16));break}t+=i?o[n]:e.charAt(n)}}return t+'"'},R=function(e,t,n,r,i,o,s){var a,c,u,l,f,m,_,g,y,E,w,T,I,O,A,D;try{a=t[e]}catch(e){}if("object"==typeof a&&a)if("[object Date]"!=(c=v.call(a))||h.call(a,"toJSON"))"function"==typeof a.toJSON&&("[object Number]"!=c&&"[object String]"!=c&&"[object Array]"!=c||h.call(a,"toJSON"))&&(a=a.toJSON(e));else if(a>-1/0&&a<1/0){if(S){for(f=b(a/864e5),u=b(f/365.2425)+1970-1;S(u+1,0)<=f;u++);for(l=b((f-S(u,0))/30.42);S(u,l+1)<=f;l++);f=1+f-S(u,l),_=b((m=(a%864e5+864e5)%864e5)/36e5)%24,g=b(m/6e4)%60,y=b(m/1e3)%60,E=m%1e3}else u=a.getUTCFullYear(),l=a.getUTCMonth(),f=a.getUTCDate(),_=a.getUTCHours(),g=a.getUTCMinutes(),y=a.getUTCSeconds(),E=a.getUTCMilliseconds();a=(u<=0||u>=1e4?(u<0?"-":"+")+C(6,u<0?-u:u):C(4,u))+"-"+C(2,l+1)+"-"+C(2,f)+"T"+C(2,_)+":"+C(2,g)+":"+C(2,y)+"."+C(3,E)+"Z"}else a=null;if(n&&(a=n.call(t,e,a)),null===a)return"null";if("[object Boolean]"==(c=v.call(a)))return""+a;if("[object Number]"==c)return a>-1/0&&a<1/0?""+a:"null";if("[object String]"==c)return k(""+a);if("object"==typeof a){for(O=s.length;O--;)if(s[O]===a)throw d();if(s.push(a),w=[],A=o,o+=i,"[object Array]"==c){for(I=0,O=a.length;I<O;I++)T=R(I,a,n,r,i,o,s),w.push(void 0===T?"null":T);D=w.length?i?"[\n"+o+w.join(",\n"+o)+"\n"+A+"]":"["+w.join(",")+"]":"[]"}else p(r||a,(function(e){var t=R(e,a,n,r,i,o,s);void 0!==t&&w.push(k(e)+":"+(i?" ":"")+t)})),D=w.length?i?"{\n"+o+w.join(",\n"+o)+"\n"+A+"}":"{"+w.join(",")+"}":"{}";return s.pop(),D}};t.stringify=function(e,t,r){var i,o,s,a;if(n[typeof t]&&t)if("[object Function]"==(a=v.call(t)))o=t;else if("[object Array]"==a){s={};for(var c,u=0,d=t.length;u<d;c=t[u++],("[object String]"==(a=v.call(c))||"[object Number]"==a)&&(s[c]=1));}if(r)if("[object Number]"==(a=v.call(r))){if((r-=r%1)>0)for(i="",r>10&&(r=10);i.length<r;i+=" ");}else"[object String]"==a&&(i=r.length<=10?r:r.slice(0,10));return R("",((c={})[""]=e,c),o,s,i,"",[])}}if(!g("json-parse")){var T,I,O=o.fromCharCode,A={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},D=function(){throw T=I=null,u()},P=function(){for(var e,t,n,r,i,o=I,s=o.length;T<s;)switch(i=o.charCodeAt(T)){case 9:case 10:case 13:case 32:T++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=y?o.charAt(T):o[T],T++,e;case 34:for(e="@",T++;T<s;)if((i=o.charCodeAt(T))<32)D();else if(92==i)switch(i=o.charCodeAt(++T)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=A[i],T++;break;case 117:for(t=++T,n=T+4;T<n;T++)(i=o.charCodeAt(T))>=48&&i<=57||i>=97&&i<=102||i>=65&&i<=70||D();e+=O("0x"+o.slice(t,T));break;default:D()}else{if(34==i)break;for(i=o.charCodeAt(T),t=T;i>=32&&92!=i&&34!=i;)i=o.charCodeAt(++T);e+=o.slice(t,T)}if(34==o.charCodeAt(T))return T++,e;D();default:if(t=T,45==i&&(r=!0,i=o.charCodeAt(++T)),i>=48&&i<=57){for(48==i&&((i=o.charCodeAt(T+1))>=48&&i<=57)&&D(),r=!1;T<s&&((i=o.charCodeAt(T))>=48&&i<=57);T++);if(46==o.charCodeAt(T)){for(n=++T;n<s&&((i=o.charCodeAt(n))>=48&&i<=57);n++);n==T&&D(),T=n}if(101==(i=o.charCodeAt(T))||69==i){for(43!=(i=o.charCodeAt(++T))&&45!=i||T++,n=T;n<s&&((i=o.charCodeAt(n))>=48&&i<=57);n++);n==T&&D(),T=n}return+o.slice(t,T)}if(r&&D(),"true"==o.slice(T,T+4))return T+=4,!0;if("false"==o.slice(T,T+5))return T+=5,!1;if("null"==o.slice(T,T+4))return T+=4,null;D()}return"$"},x=function(e){var t,n;if("$"==e&&D(),"string"==typeof e){if("@"==(y?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];"]"!=(e=P());n||(n=!0))n&&(","==e?"]"==(e=P())&&D():D()),","==e&&D(),t.push(x(e));return t}if("{"==e){for(t={};"}"!=(e=P());n||(n=!0))n&&(","==e?"}"==(e=P())&&D():D()),","!=e&&"string"==typeof e&&"@"==(y?e.charAt(0):e[0])&&":"==P()||D(),t[e.slice(1)]=x(P());return t}D()}return e},M=function(e,t,n){var r=L(e,t,n);void 0===r?delete e[t]:e[t]=r},L=function(e,t,n){var r,i=e[t];if("object"==typeof i&&i)if("[object Array]"==v.call(i))for(r=i.length;r--;)M(i,r,n);else p(i,(function(e){M(i,e,n)}));return n.call(e,t,i)};t.parse=function(e,t){var n,r;return T=0,I=""+e,n=x(P()),"$"!=P()&&D(),T=I=null,t&&"[object Function]"==v.call(t)?L(((r={})[""]=n,r),"",t):n}}}return t.runInContext=s,t}if(!o||o.global!==o&&o.window!==o&&o.self!==o||(i=o),r)s(i,r);else{var a=i.JSON,c=i.JSON3,u=!1,d=s(i,i.JSON3={noConflict:function(){return u||(u=!0,i.JSON=a,i.JSON3=c,a=c=null),d}});i.JSON={parse:d.parse,stringify:d.stringify}}}).call(x)})),wr=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},Cr=kr;function kr(e){if(e)return function(e){for(var t in kr.prototype)e[t]=kr.prototype[t];return e}(e)}kr.prototype.on=kr.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},kr.prototype.once=function(e,t){var n=this;function r(){n.off(e,r),t.apply(this,arguments)}return this._callbacks=this._callbacks||{},r.fn=t,this.on(e,r),this},kr.prototype.off=kr.prototype.removeListener=kr.prototype.removeAllListeners=kr.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks[e];if(!r)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return this},kr.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t);return this},kr.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},kr.prototype.hasListeners=function(e){return!!this.listeners(e).length};var Rr=function(e){return x.Buffer&&x.Buffer.isBuffer(e)||x.ArrayBuffer&&e instanceof ArrayBuffer};var Tr=function(e){var t=[],n=e.data;var r=e;return r.data=function e(n){if(!n)return n;if(Rr(n)){var r={_placeholder:!0,num:t.length};return t.push(n),r}if(wr(n)){for(var i=new Array(n.length),o=0;o<n.length;o++)i[o]=e(n[o]);return i}if("object"==typeof n&&!(n instanceof Date)){i={};for(var s in n)i[s]=e(n[s]);return i}return n}(n),r.attachments=t.length,{packet:r,buffers:t}},Ir=function(e,t){return e.data=function e(n){if(n&&n._placeholder)return t[n.num];if(wr(n)){for(var r=0;r<n.length;r++)n[r]=e(n[r]);return n}if(n&&"object"==typeof n){for(var i in n)n[i]=e(n[i]);return n}return n}(e.data),e.attachments=void 0,e},Or=function(e,t){var n=0,r=e;!function e(i,o,s){if(!i)return i;if(x.Blob&&i instanceof Blob||x.File&&i instanceof File){n++;var a=new FileReader;a.onload=function(){s?s[o]=this.result:r=this.result,--n||t(r)},a.readAsArrayBuffer(i)}else if(wr(i))for(var c=0;c<i.length;c++)e(i[c],c,i);else if(i&&"object"==typeof i&&!Rr(i))for(var u in i)e(i[u],u,i)}(r),n||t(r)},Ar=L((function(e,t){var n=Er("socket.io-parser");function r(){}function i(e){var r="",i=!1;return r+=e.type,t.BINARY_EVENT!=e.type&&t.BINARY_ACK!=e.type||(r+=e.attachments,r+="-"),e.nsp&&"/"!=e.nsp&&(i=!0,r+=e.nsp),null!=e.id&&(i&&(r+=",",i=!1),r+=e.id),null!=e.data&&(i&&(r+=","),r+=Sr.stringify(e.data)),n("encoded %j as %s",e,r),r}function o(){this.reconstructor=null}function s(e){this.reconPack=e,this.buffers=[]}function a(e){return{type:t.ERROR,data:"parser error"}}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=r,t.Decoder=o,r.prototype.encode=function(e,r){(n("encoding packet %j",e),t.BINARY_EVENT==e.type||t.BINARY_ACK==e.type)?function(e,t){Or(e,(function(e){var n=Tr(e),r=i(n.packet),o=n.buffers;o.unshift(r),t(o)}))}(e,r):r([i(e)])},Cr(o.prototype),o.prototype.add=function(e){var r;if("string"==typeof e)r=function(e){var r={},i=0;if(r.type=Number(e.charAt(0)),null==t.types[r.type])return a();if(t.BINARY_EVENT==r.type||t.BINARY_ACK==r.type){for(var o="";"-"!=e.charAt(++i)&&(o+=e.charAt(i),i!=e.length););if(o!=Number(o)||"-"!=e.charAt(i))throw new Error("Illegal attachments");r.attachments=Number(o)}if("/"==e.charAt(i+1))for(r.nsp="";++i;){if(","==(c=e.charAt(i)))break;if(r.nsp+=c,i==e.length)break}else r.nsp="/";var s=e.charAt(i+1);if(""!==s&&Number(s)==s){for(r.id="";++i;){var c;if(null==(c=e.charAt(i))||Number(c)!=c){--i;break}if(r.id+=e.charAt(i),i==e.length)break}r.id=Number(r.id)}if(e.charAt(++i))try{r.data=Sr.parse(e.substr(i))}catch(e){return a()}return n("decoded %s as %j",e,r),r}(e),t.BINARY_EVENT==r.type||t.BINARY_ACK==r.type?(this.reconstructor=new s(r),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",r)):this.emit("decoded",r);else{if(!Rr(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(r=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",r))}},o.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},s.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length==this.reconPack.attachments){var t=Ir(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},s.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}})),Dr=L((function(e){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}})),Pr=function(e){var t=e.xdomain,n=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||Dr))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&r)return new XDomainRequest}catch(e){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}},xr=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t},Mr=function(e){return function e(t){if(!t)return!1;if(x.Buffer&&x.Buffer.isBuffer(t)||x.ArrayBuffer&&t instanceof ArrayBuffer||x.Blob&&t instanceof Blob||x.File&&t instanceof File)return!0;if(wr(t)){for(var n=0;n<t.length;n++)if(e(t[n]))return!0}else if(t&&"object"==typeof t)for(var r in t.toJSON&&(t=t.toJSON()),t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return!0;return!1}(e)};var Lr=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(e),o=new Uint8Array(n-t),s=t,a=0;s<n;s++,a++)o[a]=i[s];return o.buffer},jr=L((function(e,t){var n;n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t.encode=function(e){var t,r=new Uint8Array(e),i=r.length,o="";for(t=0;t<i;t+=3)o+=n[r[t]>>2],o+=n[(3&r[t])<<4|r[t+1]>>4],o+=n[(15&r[t+1])<<2|r[t+2]>>6],o+=n[63&r[t+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,r,i,o,s,a=.75*e.length,c=e.length,u=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var d=new ArrayBuffer(a),l=new Uint8Array(d);for(t=0;t<c;t+=4)r=n.indexOf(e[t]),i=n.indexOf(e[t+1]),o=n.indexOf(e[t+2]),s=n.indexOf(e[t+3]),l[u++]=r<<2|i>>4,l[u++]=(15&i)<<4|o>>2,l[u++]=(3&o)<<6|63&s;return d}})),Nr=function(e,t,n){var r=!1;return n=n||Br,i.count=e,0===e?t():i;function i(e,o){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(r=!0,t(e),t=n):0!==i.count||r||t(null,o)}};function Br(){}
/*! https://mths.be/utf8js v2.0.0 by @mathias */var Ur=L((function(e,t){!function(n){var r=t,i=e&&e.exports==r&&e,o="object"==typeof x&&x;o.global!==o&&o.window!==o||(n=o);var s,a,c,u=String.fromCharCode;function d(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function l(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function f(e,t){return u(e>>t&63|128)}function h(e){if(0==(4294967168&e))return u(e);var t="";return 0==(4294965248&e)?t=u(e>>6&31|192):0==(4294901760&e)?(l(e),t=u(e>>12&15|224),t+=f(e,6)):0==(4292870144&e)&&(t=u(e>>18&7|240),t+=f(e,12),t+=f(e,6)),t+=u(63&e|128)}function p(){if(c>=a)throw Error("Invalid byte index");var e=255&s[c];if(c++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function m(){var e,t;if(c>a)throw Error("Invalid byte index");if(c==a)return!1;if(e=255&s[c],c++,0==(128&e))return e;if(192==(224&e)){if((t=(31&e)<<6|p())>=128)return t;throw Error("Invalid continuation byte")}if(224==(240&e)){if((t=(15&e)<<12|p()<<6|p())>=2048)return l(t),t;throw Error("Invalid continuation byte")}if(240==(248&e)&&(t=(15&e)<<18|p()<<12|p()<<6|p())>=65536&&t<=1114111)return t;throw Error("Invalid UTF-8 detected")}var v={version:"2.0.0",encode:function(e){for(var t=d(e),n=t.length,r=-1,i="";++r<n;)i+=h(t[r]);return i},decode:function(e){s=d(e),a=s.length,c=0;for(var t,n=[];!1!==(t=m());)n.push(t);return function(e){for(var t,n=e.length,r=-1,i="";++r<n;)(t=e[r])>65535&&(i+=u((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=u(t);return i}(n)}};if(r&&!r.nodeType)if(i)i.exports=v;else{var _={}.hasOwnProperty;for(var g in v)_.call(v,g)&&(r[g]=v[g])}else n.utf8=v}(x)})),zr=x.BlobBuilder||x.WebKitBlobBuilder||x.MSBlobBuilder||x.MozBlobBuilder,Fr=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),Gr=Fr&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),Hr=zr&&zr.prototype.append&&zr.prototype.getBlob;function Kr(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var i=new Uint8Array(n.byteLength);i.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=i.buffer}e[t]=r}}}function Vr(e,t){t=t||{};var n=new zr;Kr(e);for(var r=0;r<e.length;r++)n.append(e[r]);return t.type?n.getBlob(t.type):n.getBlob()}function qr(e,t){return Kr(e),new Blob(e,t||{})}var Wr=Fr?Gr?x.Blob:qr:Hr?Vr:void 0,Yr=L((function(e,t){var n=navigator.userAgent.match(/Android/i),r=/PhantomJS/i.test(navigator.userAgent),i=n||r;t.protocol=3;var o=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},s=xr(o),a={type:"error",data:"parser error"};function c(e,t,n){for(var r=new Array(e.length),i=Nr(e.length,n),o=function(e,n,i){t(n,(function(t,n){r[e]=n,i(t,r)}))},s=0;s<e.length;s++)o(s,e[s],i)}t.encodePacket=function(e,n,r,s){"function"==typeof n&&(s=n,n=!1),"function"==typeof r&&(s=r,r=null);var a=void 0===e.data?void 0:e.data.buffer||e.data;if(x.ArrayBuffer&&a instanceof ArrayBuffer)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=e.data,s=new Uint8Array(i),a=new Uint8Array(1+i.byteLength);a[0]=o[e.type];for(var c=0;c<s.length;c++)a[c+1]=s[c];return r(a.buffer)}(e,n,s);if(Wr&&a instanceof x.Blob)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(i)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=new FileReader;return i.onload=function(){e.data=i.result,t.encodePacket(e,n,!0,r)},i.readAsArrayBuffer(e.data)}(e,n,r);var s=new Uint8Array(1);s[0]=o[e.type];var a=new Wr([s.buffer,e.data]);return r(a)}(e,n,s);if(a&&a.base64)return function(e,n){var r="b"+t.packets[e.type]+e.data.data;return n(r)}(e,s);var c=o[e.type];return void 0!==e.data&&(c+=r?Ur.encode(String(e.data)):String(e.data)),s(""+c)},t.encodeBase64Packet=function(e,n){var r,i="b"+t.packets[e.type];if(Wr&&e.data instanceof x.Blob){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];n(i+e)},o.readAsDataURL(e.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var s=new Uint8Array(e.data),a=new Array(s.length),c=0;c<s.length;c++)a[c]=s[c];r=String.fromCharCode.apply(null,a)}return i+=x.btoa(r),n(i)},t.decodePacket=function(e,n,r){if("string"==typeof e||void 0===e){if("b"==e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r)try{e=Ur.decode(e)}catch(e){return a}var i=e.charAt(0);return Number(i)==i&&s[i]?e.length>1?{type:s[i],data:e.substring(1)}:{type:s[i]}:a}i=new Uint8Array(e)[0];var o=Lr(e,1);return Wr&&"blob"===n&&(o=new Wr([o])),{type:s[i],data:o}},t.decodeBase64Packet=function(e,t){var n=s[e.charAt(0)];if(!x.ArrayBuffer)return{type:n,data:{base64:!0,data:e.substr(1)}};var r=jr.decode(e.substr(1));return"blob"===t&&Wr&&(r=new Wr([r])),{type:n,data:r}},t.encodePayload=function(e,n,r){"function"==typeof n&&(r=n,n=null);var o=Mr(e);if(n&&o)return Wr&&!i?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r);if(!e.length)return r("0:");c(e,(function(e,r){t.encodePacket(e,!!o&&n,!0,(function(e){r(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return r(t.join(""))}))},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);var i;if("function"==typeof n&&(r=n,n=null),""==e)return r(a,0,1);for(var o,s,c="",u=0,d=e.length;u<d;u++){var l=e.charAt(u);if(":"!=l)c+=l;else{if(""==c||c!=(o=Number(c)))return r(a,0,1);if(c!=(s=e.substr(u+1,o)).length)return r(a,0,1);if(s.length){if(i=t.decodePacket(s,n,!0),a.type==i.type&&a.data==i.data)return r(a,0,1);if(!1===r(i,u+o,d))return}u+=o,c=""}}return""!=c?r(a,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));c(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){return n(null,e)}))}),(function(e,t){var r=t.reduce((function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2}),0),i=new Uint8Array(r),o=0;return t.forEach((function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),s=0;s<e.length;s++)r[s]=e.charCodeAt(s);n=r.buffer}i[o++]=t?0:1;var a=n.byteLength.toString();for(s=0;s<a.length;s++)i[o++]=parseInt(a[s]);i[o++]=255;for(r=new Uint8Array(n),s=0;s<r.length;s++)i[o++]=r[s]})),n(i.buffer)}))},t.encodePayloadAsBlob=function(e,n){c(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);e=r.buffer,t[0]=0}var o=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),s=new Uint8Array(o.length+1);for(i=0;i<o.length;i++)s[i]=parseInt(o[i]);if(s[o.length]=255,Wr){var a=new Wr([t.buffer,s.buffer,e]);n(null,a)}}))}),(function(e,t){return n(new Wr(t))}))},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var i=e,o=[],s=!1;i.byteLength>0;){for(var c=new Uint8Array(i),u=0===c[0],d="",l=1;255!=c[l];l++){if(d.length>310){s=!0;break}d+=c[l]}if(s)return r(a,0,1);i=Lr(i,2+d.length),d=parseInt(d);var f=Lr(i,0,d);if(u)try{f=String.fromCharCode.apply(null,new Uint8Array(f))}catch(e){var h=new Uint8Array(f);f="";for(l=0;l<h.length;l++)f+=String.fromCharCode(h[l])}o.push(f),i=Lr(i,d)}var p=o.length;o.forEach((function(e,i){r(t.decodePacket(e,n,!0),i,p)}))}})),Jr=$r;function $r(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders}Cr($r.prototype),$r.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},$r.prototype.open=function(){return"closed"!=this.readyState&&""!=this.readyState||(this.readyState="opening",this.doOpen()),this},$r.prototype.close=function(){return"opening"!=this.readyState&&"open"!=this.readyState||(this.doClose(),this.onClose()),this},$r.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},$r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},$r.prototype.onData=function(e){var t=Yr.decodePacket(e,this.socket.binaryType);this.onPacket(t)},$r.prototype.onPacket=function(e){this.emit("packet",e)},$r.prototype.onClose=function(){this.readyState="closed",this.emit("close")};var Xr,Zr=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},Qr=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t},ei=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},ti="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),ni={},ri=0,ii=0;function oi(e){var t="";do{t=ti[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function si(){var e=oi(+new Date);return e!==Xr?(ri=0,Xr=e):e+"."+oi(ri++)}for(;ii<64;ii++)ni[ti[ii]]=ii;si.encode=oi,si.decode=function(e){var t=0;for(ii=0;ii<e.length;ii++)t=64*t+ni[e.charAt(ii)];return t};var ai=si,ci=36e5,ui=24*ci,di=function(e,t){return t=t||{},"string"==typeof e?function(e){if((e=""+e).length>1e4)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"days":case"day":case"d":return n*ui;case"hours":case"hour":case"hrs":case"hr":case"h":return n*ci;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*n;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}(e):t.long?function(e){return li(e,ui,"day")||li(e,ci,"hour")||li(e,6e4,"minute")||li(e,1e3,"second")||e+" ms"}(e):function(e){return e>=ui?Math.round(e/ui)+"d":e>=ci?Math.round(e/ci)+"h":e>=6e4?Math.round(e/6e4)+"m":e>=1e3?Math.round(e/1e3)+"s":e+"ms"}(e)};function li(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var fi=L((function(e,t){(t=e.exports=function(e){function r(){}function o(){var e=o,r=+new Date,s=r-(n||r);e.diff=s,e.prev=n,e.curr=r,n=r,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=i());var a=Array.prototype.slice.call(arguments);a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&(a=["%o"].concat(a));var c=0;a[0]=a[0].replace(/%([a-z%])/g,(function(n,r){if("%%"===n)return n;c++;var i=t.formatters[r];if("function"==typeof i){var o=a[c];n=i.call(e,o),a.splice(c,1),c--}return n})),"function"==typeof t.formatArgs&&(a=t.formatArgs.apply(e,a));var u=o.log||t.log||console.log.bind(console);u.apply(e,a)}r.enabled=!1,o.enabled=!0;var s=t.enabled(e)?o:r;return s.namespace=e,s}).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e);for(var n=(e||"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&("-"===(e=n[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=di,t.names=[],t.skips=[],t.formatters={};var n,r=0;function i(){return t.colors[r++%t.colors.length]}})),hi=L((function(e,t){function n(){var e;try{e=t.storage.debug}catch(e){}return e}(t=e.exports=fi).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,o=0;return e[0].replace(/%[a-z%]/g,(function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))})),e.splice(o,0,r),e},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(n())})),pi=hi("engine.io-client:polling"),mi=_i,vi=null!=new Pr({xdomain:!1}).responseType;function _i(e){var t=e&&e.forceBase64;vi&&!t||(this.supportsBinary=!1),Jr.call(this,e)}ei(_i,Jr),_i.prototype.name="polling",_i.prototype.doOpen=function(){this.poll()},_i.prototype.pause=function(e){var t=this;function n(){pi("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(pi("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){pi("pre-pause polling complete"),--r||n()}))),this.writable||(pi("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){pi("pre-pause writing complete"),--r||n()})))}else n()},_i.prototype.poll=function(){pi("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},_i.prototype.onData=function(e){var t=this;pi("polling got data %s",e);Yr.decodePayload(e,this.socket.binaryType,(function(e,n,r){if("opening"==t.readyState&&t.onOpen(),"close"==e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():pi('ignoring poll - transport state "%s"',this.readyState))},_i.prototype.doClose=function(){var e=this;function t(){pi("writing close packet"),e.write([{type:"close"}])}"open"==this.readyState?(pi("transport open - closing"),t()):(pi("transport not open - deferring close"),this.once("open",t))},_i.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};t=this;Yr.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,n)}))},_i.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=ai()),this.supportsBinary||e.sid||(e.b64=1),e=Zr(e),this.port&&("https"==t&&443!=this.port||"http"==t&&80!=this.port)&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e};var gi=hi("engine.io-client:polling-xhr"),yi=Si,bi=wi;function Ei(){}function Si(e){if(mi.call(this,e),x.location){var t="https:"==location.protocol,n=location.port;n||(n=t?443:80),this.xd=e.hostname!=x.location.hostname||n!=e.port,this.xs=e.secure!=t}else this.extraHeaders=e.extraHeaders}function wi(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=null!=e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function Ci(){for(var e in wi.requests)wi.requests.hasOwnProperty(e)&&wi.requests[e].abort()}ei(Si,mi),Si.prototype.supportsBinary=!0,Si.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.extraHeaders=this.extraHeaders,new wi(e)},Si.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),i=this;r.on("success",t),r.on("error",(function(e){i.onError("xhr post error",e)})),this.sendXhr=r},Si.prototype.doPoll=function(){gi("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},Cr(wi.prototype),wi.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new Pr(e),n=this;try{gi("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var r in t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(r)&&t.setRequestHeader(r,this.extraHeaders[r])}catch(e){}if(this.supportsBinary&&(t.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){4==t.readyState&&(200==t.status||1223==t.status?n.onLoad():setTimeout((function(){n.onError(t.status)}),0))},gi("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){n.onError(e)}),0)}x.document&&(this.index=wi.requestsCount++,wi.requests[this.index]=this)},wi.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},wi.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},wi.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},wi.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=Ei:this.xhr.onreadystatechange=Ei,e)try{this.xhr.abort()}catch(e){}x.document&&delete wi.requests[this.index],this.xhr=null}},wi.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(e){}if("application/octet-stream"===t)e=this.xhr.response;else if(this.supportsBinary)try{e=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(t){for(var n=new Uint8Array(this.xhr.response),r=[],i=0,o=n.length;i<o;i++)r.push(n[i]);e=String.fromCharCode.apply(null,r)}else e=this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},wi.prototype.hasXDR=function(){return void 0!==x.XDomainRequest&&!this.xs&&this.enablesXDR},wi.prototype.abort=function(){this.cleanup()},x.document&&(wi.requestsCount=0,wi.requests={},x.attachEvent?x.attachEvent("onunload",Ci):x.addEventListener&&x.addEventListener("beforeunload",Ci,!1)),yi.Request=bi;var ki,Ri=Ai,Ti=/\n/g,Ii=/\\n/g;function Oi(){}function Ai(e){mi.call(this,e),this.query=this.query||{},ki||(x.___eio||(x.___eio=[]),ki=x.___eio),this.index=ki.length;var t=this;ki.push((function(e){t.onData(e)})),this.query.j=this.index,x.document&&x.addEventListener&&x.addEventListener("beforeunload",(function(){t.script&&(t.script.onerror=Oi)}),!1)}ei(Ai,mi),Ai.prototype.supportsBinary=!1,Ai.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),mi.prototype.doClose.call(this)},Ai.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},Ai.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,i=document.createElement("form"),o=document.createElement("textarea"),s=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=s,i.method="POST",i.setAttribute("accept-charset","utf-8"),o.name="d",i.appendChild(o),document.body.appendChild(i),this.form=i,this.area=o}function a(){c(),t()}function c(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),c(),e=e.replace(Ii,"\\\n"),this.area.value=e.replace(Ti,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==n.iframe.readyState&&a()}:this.iframe.onload=a};var Di=M(Object.freeze({__proto__:null,default:{}})),Pi=hi("engine.io-client:websocket"),xi=x.WebSocket||x.MozWebSocket,Mi=xi;if(!Mi&&"undefined"==typeof window)try{Mi=Di}catch(e){}var Li=ji;function ji(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,Jr.call(this,e)}ei(ji,Jr),ji.prototype.name="websocket",ji.prototype.supportsBinary=!0,ji.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t={agent:this.agent,perMessageDeflate:this.perMessageDeflate};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(t.headers=this.extraHeaders),this.ws=xi?new Mi(e):new Mi(e,void 0,t),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="buffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},ji.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(ji.prototype.onData=function(e){var t=this;setTimeout((function(){Jr.prototype.onData.call(t,e)}),0)}),ji.prototype.write=function(e){var t=this;this.writable=!1;for(var n=e.length,r=0,i=n;r<i;r++)!function(e){Yr.encodePacket(e,t.supportsBinary,(function(r){if(!xi){var i={};if(e.options&&(i.compress=e.options.compress),t.perMessageDeflate)("string"==typeof r?x.Buffer.byteLength(r):r.length)<t.perMessageDeflate.threshold&&(i.compress=!1)}try{xi?t.ws.send(r):t.ws.send(r,i)}catch(e){Pi("websocket closed before onclose event")}--n||o()}))}(e[r]);function o(){t.emit("flush"),setTimeout((function(){t.writable=!0,t.emit("drain")}),0)}},ji.prototype.onClose=function(){Jr.prototype.onClose.call(this)},ji.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},ji.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"==t&&443!=this.port||"ws"==t&&80!=this.port)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=ai()),this.supportsBinary||(e.b64=1),(e=Zr(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},ji.prototype.check=function(){return!(!Mi||"__initialize"in Mi&&this.name===ji.prototype.name)};var Ni={polling:function(e){var t=!1,n=!1,r=!1!==e.jsonp;if(x.location){var i="https:"==location.protocol,o=location.port;o||(o=i?443:80),t=e.hostname!=location.hostname||o!=e.port,n=e.secure!=i}if(e.xdomain=t,e.xscheme=n,"open"in new Pr(e)&&!e.forceJSONP)return new yi(e);if(!r)throw new Error("JSONP disabled");return new Ri(e)},websocket:Li},Bi=[].indexOf,Ui=function(e,t){if(Bi)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1},zi=/^[\],:{}\s]*$/,Fi=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,Gi=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Hi=/(?:^|:|,)(?:\s*\[)+/g,Ki=/^\s+/,Vi=/\s+$/,qi=hi("engine.io-client:socket"),Wi=Yi;function Yi(e,t){if(!(this instanceof Yi))return new Yi(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=ar(e),t.hostname=e.host,t.secure="https"==e.protocol||"wss"==e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=ar(t.host).host),this.secure=null!=t.secure?t.secure:x.location&&"https:"==location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||(x.location?location.hostname:"localhost"),this.port=t.port||(x.location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=Qr(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized?null:t.rejectUnauthorized;var n="object"==typeof x&&x;n.global===n&&t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),this.open()}Yi.priorWebsocketSuccess=!1,Cr(Yi.prototype),Yi.protocol=Yr.protocol,Yi.Socket=Yi,Yi.Transport=Jr,Yi.transports=Ni,Yi.parser=Yr,Yi.prototype.createTransport=function(e){qi('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);return t.EIO=Yr.protocol,t.transport=e,this.id&&(t.sid=this.id),new Ni[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders})},Yi.prototype.open=function(){var e;if(this.rememberUpgrade&&Yi.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},Yi.prototype.setTransport=function(e){qi("setting transport %s",e.name);var t=this;this.transport&&(qi("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},Yi.prototype.probe=function(e){qi('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;function i(){if(r.onlyBinaryUpgrades){var i=!this.supportsBinary&&r.transport.supportsBinary;n=n||i}n||(qi('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(i){if(!n)if("pong"==i.type&&"probe"==i.data){if(qi('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;Yi.priorWebsocketSuccess="websocket"==t.name,qi('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!=r.readyState&&(qi("changing transport and sending upgrade packet"),d(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())}))}else{qi('probe transport "%s" failed',e);var o=new Error("probe error");o.transport=t.name,r.emit("upgradeError",o)}})))}function o(){n||(n=!0,d(),t.close(),t=null)}function s(n){var i=new Error("probe error: "+n);i.transport=t.name,o(),qi('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",i)}function a(){s("transport closed")}function c(){s("socket closed")}function u(e){t&&e.name!=t.name&&(qi('"%s" works - aborting "%s"',e.name,t.name),o())}function d(){t.removeListener("open",i),t.removeListener("error",s),t.removeListener("close",a),r.removeListener("close",c),r.removeListener("upgrading",u)}Yi.priorWebsocketSuccess=!1,t.once("open",i),t.once("error",s),t.once("close",a),this.once("close",c),this.once("upgrading",u),t.open()},Yi.prototype.onOpen=function(){if(qi("socket open"),this.readyState="open",Yi.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){qi("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},Yi.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState)switch(qi('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake("string"==typeof(n=e.data)&&n?(n=n.replace(Ki,"").replace(Vi,""),x.JSON&&JSON.parse?JSON.parse(n):zi.test(n.replace(Fi,"@").replace(Gi,"]").replace(Hi,""))?new Function("return "+n)():void 0):null);break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else qi('packet received with socket readyState "%s"',this.readyState);var n},Yi.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},Yi.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!=t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},Yi.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){qi("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},Yi.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},Yi.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},Yi.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(qi("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},Yi.prototype.write=Yi.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},Yi.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!=this.readyState&&"closed"!=this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},Yi.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():t()})):this.upgrading?r():t()}function t(){e.onClose("forced close"),qi("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},Yi.prototype.onError=function(e){qi("socket error %j",e),Yi.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},Yi.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){qi('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},Yi.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~Ui(this.transports,e[n])&&t.push(e[n]);return t};var Ji=Wi,$i=Yr;Ji.parser=$i;var Xi=Ji,Zi=Qi;function Qi(e){if(e)return function(e){for(var t in Qi.prototype)e[t]=Qi.prototype[t];return e}(e)}Qi.prototype.on=Qi.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},Qi.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},Qi.prototype.off=Qi.prototype.removeListener=Qi.prototype.removeAllListeners=Qi.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return this},Qi.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t);return this},Qi.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},Qi.prototype.hasListeners=function(e){return!!this.listeners(e).length};var eo=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n};var to=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}};var no=[].slice,ro=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var n=no.call(arguments,2);return function(){return t.apply(e,n.concat(no.call(arguments)))}},io=function(e){return function e(t){if(!t)return!1;if(x.Buffer&&x.Buffer.isBuffer&&x.Buffer.isBuffer(t)||x.ArrayBuffer&&t instanceof ArrayBuffer||x.Blob&&t instanceof Blob||x.File&&t instanceof File)return!0;if(wr(t)){for(var n=0;n<t.length;n++)if(e(t[n]))return!0}else if(t&&"object"==typeof t)for(var r in t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return!0;return!1}(e)};var oo=L((function(e,t){var n=hr("socket.io-client:socket");e.exports=o;var r={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},i=Zi.prototype.emit;function o(e,t){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.io.autoConnect&&this.open()}Zi(o.prototype),o.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[to(e,"open",ro(this,"onopen")),to(e,"packet",ro(this,"onpacket")),to(e,"close",ro(this,"onclose"))]}},o.prototype.open=o.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this.emit("connecting")),this},o.prototype.send=function(){var e=eo(arguments);return e.unshift("message"),this.emit.apply(this,e),this},o.prototype.emit=function(e){if(r.hasOwnProperty(e))return i.apply(this,arguments),this;var t=eo(arguments),o=Ar.EVENT;io(t)&&(o=Ar.BINARY_EVENT);var s={type:o,data:t,options:{}};return s.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(n("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),s.id=this.ids++),this.connected?this.packet(s):this.sendBuffer.push(s),delete this.flags,this},o.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},o.prototype.onopen=function(){n("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:Ar.CONNECT})},o.prototype.onclose=function(e){n("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},o.prototype.onpacket=function(e){if(e.nsp==this.nsp)switch(e.type){case Ar.CONNECT:this.onconnect();break;case Ar.EVENT:case Ar.BINARY_EVENT:this.onevent(e);break;case Ar.ACK:case Ar.BINARY_ACK:this.onack(e);break;case Ar.DISCONNECT:this.ondisconnect();break;case Ar.ERROR:this.emit("error",e.data)}},o.prototype.onevent=function(e){var t=e.data||[];n("emitting event %j",t),null!=e.id&&(n("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?i.apply(this,t):this.receiveBuffer.push(t)},o.prototype.ack=function(e){var t=this,r=!1;return function(){if(!r){r=!0;var i=eo(arguments);n("sending ack %j",i);var o=io(i)?Ar.BINARY_ACK:Ar.ACK;t.packet({type:o,id:e,data:i})}}},o.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(n("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):n("bad ack %s",e.id)},o.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},o.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)i.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},o.prototype.ondisconnect=function(){n("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},o.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},o.prototype.close=o.prototype.disconnect=function(){return this.connected&&(n("performing disconnect (%s)",this.nsp),this.packet({type:Ar.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},o.prototype.compress=function(e){return this.flags=this.flags||{},this.flags.compress=e,this}})),so=ao;function ao(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}ao.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},ao.prototype.reset=function(){this.attempts=0},ao.prototype.setMin=function(e){this.ms=e},ao.prototype.setMax=function(e){this.max=e},ao.prototype.setJitter=function(e){this.jitter=e};var co=hr("socket.io-client:manager"),uo=Object.prototype.hasOwnProperty,lo=fo;function fo(e,t){if(!(this instanceof fo))return new fo(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new so({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new Ar.Encoder,this.decoder=new Ar.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}fo.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)uo.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},fo.prototype.updateSocketIds=function(){for(var e in this.nsps)uo.call(this.nsps,e)&&(this.nsps[e].id=this.engine.id)},Zi(fo.prototype),fo.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},fo.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},fo.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},fo.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},fo.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},fo.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},fo.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},fo.prototype.open=fo.prototype.connect=function(e){if(co("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;co("opening %s",this.uri),this.engine=Xi(this.uri,this.opts);var t=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var r=to(t,"open",(function(){n.onopen(),e&&e()})),i=to(t,"error",(function(t){if(co("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),e){var r=new Error("Connection error");r.data=t,e(r)}else n.maybeReconnectOnOpen()}));if(!1!==this._timeout){var o=this._timeout;co("connect attempt will timeout after %d",o);var s=setTimeout((function(){co("connect attempt timed out after %d",o),r.destroy(),t.close(),t.emit("error","timeout"),n.emitAll("connect_timeout",o)}),o);this.subs.push({destroy:function(){clearTimeout(s)}})}return this.subs.push(r),this.subs.push(i),this},fo.prototype.onopen=function(){co("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(to(e,"data",ro(this,"ondata"))),this.subs.push(to(e,"ping",ro(this,"onping"))),this.subs.push(to(e,"pong",ro(this,"onpong"))),this.subs.push(to(e,"error",ro(this,"onerror"))),this.subs.push(to(e,"close",ro(this,"onclose"))),this.subs.push(to(this.decoder,"decoded",ro(this,"ondecoded")))},fo.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},fo.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},fo.prototype.ondata=function(e){this.decoder.add(e)},fo.prototype.ondecoded=function(e){this.emit("packet",e)},fo.prototype.onerror=function(e){co("error",e),this.emitAll("error",e)},fo.prototype.socket=function(e){var t=this.nsps[e];if(!t){t=new oo(this,e),this.nsps[e]=t;var n=this;t.on("connecting",r),t.on("connect",(function(){t.id=n.engine.id})),this.autoConnect&&r()}function r(){~Ui(n.connecting,t)||n.connecting.push(t)}return t},fo.prototype.destroy=function(e){var t=Ui(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},fo.prototype.packet=function(e){co("writing packet %j",e);var t=this;t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()})))},fo.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},fo.prototype.cleanup=function(){var e;for(co("cleanup");e=this.subs.shift();)e.destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},fo.prototype.close=fo.prototype.disconnect=function(){co("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"==this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},fo.prototype.onclose=function(e){co("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},fo.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)co("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();co("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout((function(){e.skipReconnect||(co("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(co("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(co("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(n)}})}},fo.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)};var ho,po=L((function(e,t){var n=hr("socket.io-client");e.exports=t=i;var r=t.managers={};function i(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,o=mr(e),s=o.source,a=o.id,c=o.path,u=r[a]&&c in r[a].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||u?(n("ignoring socket cache for %s",s),i=lo(s,t)):(r[a]||(n("new io instance for %s",s),r[a]=lo(s,t)),i=r[a]),i.socket(o.path)}t.protocol=Ar.protocol,t.connect=i,t.Manager=lo,t.Socket=oo})),mo=new tr("SocketClient"),vo=function(e){function t(t){var n=e.call(this)||this;return mo.info("constructor() %o",t),n._name="SocketClient",n._getPropsFromStore(),De.subscribe((function(){return n._getPropsFromStore()})),n}return o(t,e),t.prototype._getPropsFromStore=function(){var e=De.getState(),t=e.appId,n=e.roomId,r=e.clientId,i=e.configServer,o=e.token,s=e._mediaServerAddr,a=e._signalServerHost;this._appId=t,this._roomId=n,this._clientId=r,this._token=o,this._configServer=i,this._mediaServerAddr=s,this._signalServerHost=a},t.prototype.join=function(){return a(this,void 0,void 0,(function(){var e,t;return c(this,(function(n){switch(n.label){case 0:return this._signalServerHost?(e={host:this._signalServerHost,path:"/socket.io/",secure:!0},[4,this._connect(e)]):[3,2];case 1:return n.sent(),[3,5];case 2:return[4,this._getServerConfig()];case 3:return(null==(t=n.sent())?void 0:t.domain)?[4,this._connect(t.domain)]:(mo.error("join() fail"),[2]);case 4:n.sent(),n.label=5;case 5:return[2,this._joinRoom()]}}))}))},t.prototype.leave=function(e){var t=this;if(void 0===e&&(e=!1),e)return this._disconnect(),this._socket.removeAllListeners(),Promise.resolve({code:200});var n={Authorization:qn.token2auth(this._token,this._appId,this._roomId,this._clientId),roomId:this._roomId,sessionId:qn.getSessionId()};return new Promise((function(e,r){t._socket.emit("leaveRoom",n,(function(n){200===(null==n?void 0:n.code)?(e(n),t._disconnect(),t._socket.removeAllListeners()):r(n)}))}))},t.prototype._getServerConfig=function(){return a(this,void 0,void 0,(function(){var e,t;return c(this,(function(n){return e={deviceType:"web",deviceID:qn.getDeviceId(),appID:this._appId,businessID:void 0,roomID:this._roomId,userID:this._clientId,productPlatform:"VolcEngine",keys:["domain"],sdkVersion:"3.18.29"},t=this._configServer.map((function(t){return $n(t,e)})),[2,Promise.race(t).then((function(e){return mo.debug({message:e,event_key:"rtc_get_config"}),e})).catch((function(e){throw mo.debug({message:e,event_key:"rtc_get_config"}),e}))]}))}))},t.prototype._connect=function(e){var t=e.host,n=e.path,r=e.secure;return a(this,void 0,void 0,(function(){var e,i;return c(this,(function(o){return e={reconnection:!0,reconnectionAttempts:1e3,secure:r,forceNew:!0,transports:["websocket"],rejectUnauthorized:!1,query:{wsid:We(),appid:this._appId,ua:"web-3.18.29"}},this.emit("@socket/events","start_connect"),i="wss://"+t+n,this._socket=po.connect(i,e),this._handle(),[2]}))}))},t.prototype._disconnect=function(){var e;return a(this,void 0,void 0,(function(){return c(this,(function(t){return(null===(e=this._socket)||void 0===e?void 0:e.connected)&&(mo.info("_disconnect()"),this._socket.disconnect()),[2]}))}))},t.prototype._joinRoom=function(){var e=this,t={Authorization:qn.token2auth(this._token,this._appId,this._roomId,this._clientId),sessionId:qn.getSessionId(),timestamp:Date.now(),userAttributes:{enableaudio:!0,enablevideo:!0},params:{deviceType:"web",userAgent:window.navigator.userAgent,sdkVersion:"3.18.29",deviceId:qn.getDeviceId(),appId:this._appId,roomId:this._roomId,userId:this._clientId,businessId:""}};return this._mediaServerAddr&&(t._mediaServerAddr=this._mediaServerAddr),this._joinRoomBody=t,new Promise((function(n){e._socket.emit("joinRoom",t,(function(e){return n(e)}))}))},t.prototype.sendMessage=function(e,t){var n=this;return new Promise((function(r,i){n._socket.emit(e,t,(function(e){200===(null==e?void 0:e.code)?r(e):i(e)})),mo.debug({message:t,event_key:"rtc_signaling",direction:"up",signaling_event:e})}))},t.prototype._handle=function(){var e=this;this._socket.on("connect",(function(t){mo.debug({message:t,event_key:"rtc_websocket",websocket_event:"connect"}),e.emit("@socket/events","connected")})),this._socket.on("reconnect",(function(){mo.debug({message:"reconnect()",event_key:"rtc_reconnect"}),e._socket.emit("reconnected",e._joinRoomBody,(function(t){mo.debug({message:"ret",event_key:"rtc_reconnected",code:(null==t?void 0:t.code)||0}),200===t.code&&(e.emit("@socket/events","reconnected"),e.emit("@socket/reconnectedSuccess"))}))})),this._socket.on("streamFailed",(function(t){return e.emit("@socket/streamFailed",t)})),["connect_error","connect_timeout","reconnect_error","reconnect_failed","error","disconnect"].forEach((function(t){e._socket.on(t,(function(n){mo.debug({message:n,event_key:"rtc_websocket",websocket_event:t}),mo.info("sokcet error: %s",t),e.emit("@socket/events",t,n)}))})),["signalingMessageRelay","onAddStream","onRemoveStream","userConnection","userDisconnection","onCustomMessage"].forEach((function(t){e._socket.on(t,e._autoReply(t,(function(n){mo.info(t+" ret: %o",n),e.emit("@socket/"+t,n)})))})),this._socket.on("postProcessingMessage",(function(t){if(null==t?void 0:t.body){var n=t.body,r=n.error;n.message||"number"!=typeof r||(t.body.message=["转推成功","参数错误","订阅流超时无帧","ffmpeg处理错误","cdn推流错误"][r])}mo.debug({event_key:"rtc_signaling",message:t,websocket_event:"postProcessingMessage"}),e.emit("@socket/postProcessingMessage",null==t?void 0:t.body)}))},t.prototype._autoReply=function(e,t){var n=this;return function(r){mo.debug({message:r,event_key:"rtc_signaling",direction:"down",signaling_event:e}),(null==r?void 0:r.messageId)&&n.sendMessage(e+"-res",{messageId:r.messageId}),t(r)}},Object.defineProperty(t.prototype,"roomId",{set:function(e){this._roomId=e},enumerable:!1,configurable:!0}),t}(ir),_o=L((function(e,t){(function(){var n="Expected a function",r="__lodash_placeholder__",i=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],o="[object Arguments]",s="[object Array]",a="[object Boolean]",c="[object Date]",u="[object Error]",d="[object Function]",l="[object GeneratorFunction]",f="[object Map]",h="[object Number]",p="[object Object]",m="[object RegExp]",v="[object Set]",_="[object String]",g="[object Symbol]",y="[object WeakMap]",b="[object ArrayBuffer]",E="[object DataView]",S="[object Float32Array]",w="[object Float64Array]",C="[object Int8Array]",k="[object Int16Array]",R="[object Int32Array]",T="[object Uint8Array]",I="[object Uint16Array]",O="[object Uint32Array]",A=/\b__p \+= '';/g,D=/\b(__p \+=) '' \+/g,P=/(__e\(.*?\)|\b__t\)) \+\n'';/g,M=/&(?:amp|lt|gt|quot|#39);/g,L=/[&<>"']/g,j=RegExp(M.source),N=RegExp(L.source),B=/<%-([\s\S]+?)%>/g,U=/<%([\s\S]+?)%>/g,z=/<%=([\s\S]+?)%>/g,F=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,G=/^\w*$/,H=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,K=/[\\^$.*+?()[\]{}|]/g,V=RegExp(K.source),q=/^\s+|\s+$/g,W=/^\s+/,Y=/\s+$/,J=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,$=/\{\n\/\* \[wrapped with (.+)\] \*/,X=/,? & /,Z=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Q=/\\(\\)?/g,ee=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,te=/\w*$/,ne=/^[-+]0x[0-9a-f]+$/i,re=/^0b[01]+$/i,ie=/^\[object .+?Constructor\]$/,oe=/^0o[0-7]+$/i,se=/^(?:0|[1-9]\d*)$/,ae=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ce=/($^)/,ue=/['\n\r\u2028\u2029\\]/g,de="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",le="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",fe="[\\ud800-\\udfff]",he="["+le+"]",pe="["+de+"]",me="\\d+",ve="[\\u2700-\\u27bf]",_e="[a-z\\xdf-\\xf6\\xf8-\\xff]",ge="[^\\ud800-\\udfff"+le+me+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",ye="\\ud83c[\\udffb-\\udfff]",be="[^\\ud800-\\udfff]",Ee="(?:\\ud83c[\\udde6-\\uddff]){2}",Se="[\\ud800-\\udbff][\\udc00-\\udfff]",we="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Ce="(?:"+_e+"|"+ge+")",ke="(?:"+we+"|"+ge+")",Re="(?:"+pe+"|"+ye+")"+"?",Te="[\\ufe0e\\ufe0f]?"+Re+("(?:\\u200d(?:"+[be,Ee,Se].join("|")+")[\\ufe0e\\ufe0f]?"+Re+")*"),Ie="(?:"+[ve,Ee,Se].join("|")+")"+Te,Oe="(?:"+[be+pe+"?",pe,Ee,Se,fe].join("|")+")",Ae=RegExp("['’]","g"),De=RegExp(pe,"g"),Pe=RegExp(ye+"(?="+ye+")|"+Oe+Te,"g"),xe=RegExp([we+"?"+_e+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[he,we,"$"].join("|")+")",ke+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[he,we+Ce,"$"].join("|")+")",we+"?"+Ce+"+(?:['’](?:d|ll|m|re|s|t|ve))?",we+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",me,Ie].join("|"),"g"),Me=RegExp("[\\u200d\\ud800-\\udfff"+de+"\\ufe0e\\ufe0f]"),Le=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,je=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ne=-1,Be={};Be[S]=Be[w]=Be[C]=Be[k]=Be[R]=Be[T]=Be["[object Uint8ClampedArray]"]=Be[I]=Be[O]=!0,Be[o]=Be[s]=Be[b]=Be[a]=Be[E]=Be[c]=Be[u]=Be[d]=Be[f]=Be[h]=Be[p]=Be[m]=Be[v]=Be[_]=Be[y]=!1;var Ue={};Ue[o]=Ue[s]=Ue[b]=Ue[E]=Ue[a]=Ue[c]=Ue[S]=Ue[w]=Ue[C]=Ue[k]=Ue[R]=Ue[f]=Ue[h]=Ue[p]=Ue[m]=Ue[v]=Ue[_]=Ue[g]=Ue[T]=Ue["[object Uint8ClampedArray]"]=Ue[I]=Ue[O]=!0,Ue[u]=Ue[d]=Ue[y]=!1;var ze={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Fe=parseFloat,Ge=parseInt,He="object"==typeof x&&x&&x.Object===Object&&x,Ke="object"==typeof self&&self&&self.Object===Object&&self,Ve=He||Ke||Function("return this")(),qe=t&&!t.nodeType&&t,We=qe&&e&&!e.nodeType&&e,Ye=We&&We.exports===qe,Je=Ye&&He.process,$e=function(){try{var e=We&&We.require&&We.require("util").types;return e||Je&&Je.binding&&Je.binding("util")}catch(e){}}(),Xe=$e&&$e.isArrayBuffer,Ze=$e&&$e.isDate,Qe=$e&&$e.isMap,et=$e&&$e.isRegExp,tt=$e&&$e.isSet,nt=$e&&$e.isTypedArray;function rt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function it(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(r,s,n(s),e)}return r}function ot(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function st(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function at(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function ct(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}function ut(e,t){return!!(null==e?0:e.length)&&yt(e,t,0)>-1}function dt(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function lt(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function ft(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function ht(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function pt(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function mt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var vt=wt("length");function _t(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function gt(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function yt(e,t,n){return t==t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):gt(e,Et,n)}function bt(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function Et(e){return e!=e}function St(e,t){var n=null==e?0:e.length;return n?Rt(e,t)/n:NaN}function wt(e){return function(t){return null==t?void 0:t[e]}}function Ct(e){return function(t){return null==e?void 0:e[t]}}function kt(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function Rt(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);void 0!==o&&(n=void 0===n?o:n+o)}return n}function Tt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function It(e){return function(t){return e(t)}}function Ot(e,t){return lt(t,(function(t){return e[t]}))}function At(e,t){return e.has(t)}function Dt(e,t){for(var n=-1,r=e.length;++n<r&&yt(t,e[n],0)>-1;);return n}function Pt(e,t){for(var n=e.length;n--&&yt(t,e[n],0)>-1;);return n}function xt(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}var Mt=Ct({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Lt=Ct({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function jt(e){return"\\"+ze[e]}function Nt(e){return Me.test(e)}function Bt(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function Ut(e,t){return function(n){return e(t(n))}}function zt(e,t){for(var n=-1,i=e.length,o=0,s=[];++n<i;){var a=e[n];a!==t&&a!==r||(e[n]=r,s[o++]=n)}return s}function Ft(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function Gt(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function Ht(e){return Nt(e)?function(e){var t=Pe.lastIndex=0;for(;Pe.test(e);)++t;return t}(e):vt(e)}function Kt(e){return Nt(e)?function(e){return e.match(Pe)||[]}(e):function(e){return e.split("")}(e)}var Vt=Ct({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var qt=function e(t){var x,de=(t=null==t?Ve:qt.defaults(Ve.Object(),t,qt.pick(Ve,je))).Array,le=t.Date,fe=t.Error,he=t.Function,pe=t.Math,me=t.Object,ve=t.RegExp,_e=t.String,ge=t.TypeError,ye=de.prototype,be=he.prototype,Ee=me.prototype,Se=t["__core-js_shared__"],we=be.toString,Ce=Ee.hasOwnProperty,ke=0,Re=(x=/[^.]+$/.exec(Se&&Se.keys&&Se.keys.IE_PROTO||""))?"Symbol(src)_1."+x:"",Te=Ee.toString,Ie=we.call(me),Oe=Ve._,Pe=ve("^"+we.call(Ce).replace(K,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Me=Ye?t.Buffer:void 0,ze=t.Symbol,He=t.Uint8Array,Ke=Me?Me.allocUnsafe:void 0,qe=Ut(me.getPrototypeOf,me),We=me.create,Je=Ee.propertyIsEnumerable,$e=ye.splice,vt=ze?ze.isConcatSpreadable:void 0,Ct=ze?ze.iterator:void 0,Wt=ze?ze.toStringTag:void 0,Yt=function(){try{var e=Qi(me,"defineProperty");return e({},"",{}),e}catch(e){}}(),Jt=t.clearTimeout!==Ve.clearTimeout&&t.clearTimeout,$t=le&&le.now!==Ve.Date.now&&le.now,Xt=t.setTimeout!==Ve.setTimeout&&t.setTimeout,Zt=pe.ceil,Qt=pe.floor,en=me.getOwnPropertySymbols,tn=Me?Me.isBuffer:void 0,nn=t.isFinite,rn=ye.join,on=Ut(me.keys,me),sn=pe.max,an=pe.min,cn=le.now,un=t.parseInt,dn=pe.random,ln=ye.reverse,fn=Qi(t,"DataView"),hn=Qi(t,"Map"),pn=Qi(t,"Promise"),mn=Qi(t,"Set"),vn=Qi(t,"WeakMap"),_n=Qi(me,"create"),gn=vn&&new vn,yn={},bn=To(fn),En=To(hn),Sn=To(pn),wn=To(mn),Cn=To(vn),kn=ze?ze.prototype:void 0,Rn=kn?kn.valueOf:void 0,Tn=kn?kn.toString:void 0;function In(e){if(Ks(e)&&!xs(e)&&!(e instanceof Pn)){if(e instanceof Dn)return e;if(Ce.call(e,"__wrapped__"))return Io(e)}return new Dn(e)}var On=function(){function e(){}return function(t){if(!Hs(t))return{};if(We)return We(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function An(){}function Dn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function Pn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function xn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Mn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Ln(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function jn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Ln;++t<n;)this.add(e[t])}function Nn(e){var t=this.__data__=new Mn(e);this.size=t.size}function Bn(e,t){var n=xs(e),r=!n&&Ps(e),i=!n&&!r&&Ns(e),o=!n&&!r&&!i&&Zs(e),s=n||r||i||o,a=s?Tt(e.length,_e):[],c=a.length;for(var u in e)!t&&!Ce.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||so(u,c))||a.push(u);return a}function Un(e){var t=e.length;return t?e[jr(0,t-1)]:void 0}function zn(e,t){return Co(_i(e),Jn(t,0,e.length))}function Fn(e){return Co(_i(e))}function Gn(e,t,n){(void 0!==n&&!Os(e[t],n)||void 0===n&&!(t in e))&&Wn(e,t,n)}function Hn(e,t,n){var r=e[t];Ce.call(e,t)&&Os(r,n)&&(void 0!==n||t in e)||Wn(e,t,n)}function Kn(e,t){for(var n=e.length;n--;)if(Os(e[n][0],t))return n;return-1}function Vn(e,t,n,r){return er(e,(function(e,i,o){t(r,e,n(e),o)})),r}function qn(e,t){return e&&gi(t,ba(t),e)}function Wn(e,t,n){"__proto__"==t&&Yt?Yt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Yn(e,t){for(var n=-1,r=t.length,i=de(r),o=null==e;++n<r;)i[n]=o?void 0:ma(e,t[n]);return i}function Jn(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}function $n(e,t,n,r,i,s){var u,y=1&t,A=2&t,D=4&t;if(n&&(u=i?n(e,r,i,s):n(e)),void 0!==u)return u;if(!Hs(e))return e;var P=xs(e);if(P){if(u=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&Ce.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!y)return _i(e,u)}else{var x=no(e),M=x==d||x==l;if(Ns(e))return li(e,y);if(x==p||x==o||M&&!i){if(u=A||M?{}:io(e),!y)return A?function(e,t){return gi(e,to(e),t)}(e,function(e,t){return e&&gi(t,Ea(t),e)}(u,e)):function(e,t){return gi(e,eo(e),t)}(e,qn(u,e))}else{if(!Ue[x])return i?e:{};u=function(e,t,n){var r=e.constructor;switch(t){case b:return fi(e);case a:case c:return new r(+e);case E:return function(e,t){var n=t?fi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case S:case w:case C:case k:case R:case T:case"[object Uint8ClampedArray]":case I:case O:return hi(e,n);case f:return new r;case h:case _:return new r(e);case m:return function(e){var t=new e.constructor(e.source,te.exec(e));return t.lastIndex=e.lastIndex,t}(e);case v:return new r;case g:return i=e,Rn?me(Rn.call(i)):{}}var i}(e,x,y)}}s||(s=new Nn);var L=s.get(e);if(L)return L;s.set(e,u),Js(e)?e.forEach((function(r){u.add($n(r,t,n,r,e,s))})):Vs(e)&&e.forEach((function(r,i){u.set(i,$n(r,t,n,i,e,s))}));var j=P?void 0:(D?A?qi:Vi:A?Ea:ba)(e);return ot(j||e,(function(r,i){j&&(r=e[i=r]),Hn(u,i,$n(r,t,n,i,e,s))})),u}function Xn(e,t,n){var r=n.length;if(null==e)return!r;for(e=me(e);r--;){var i=n[r],o=t[i],s=e[i];if(void 0===s&&!(i in e)||!o(s))return!1}return!0}function Zn(e,t,r){if("function"!=typeof e)throw new ge(n);return bo((function(){e.apply(void 0,r)}),t)}function Qn(e,t,n,r){var i=-1,o=ut,s=!0,a=e.length,c=[],u=t.length;if(!a)return c;n&&(t=lt(t,It(n))),r?(o=dt,s=!1):t.length>=200&&(o=At,s=!1,t=new jn(t));e:for(;++i<a;){var d=e[i],l=null==n?d:n(d);if(d=r||0!==d?d:0,s&&l==l){for(var f=u;f--;)if(t[f]===l)continue e;c.push(d)}else o(t,l,r)||c.push(d)}return c}In.templateSettings={escape:B,evaluate:U,interpolate:z,variable:"",imports:{_:In}},In.prototype=An.prototype,In.prototype.constructor=In,Dn.prototype=On(An.prototype),Dn.prototype.constructor=Dn,Pn.prototype=On(An.prototype),Pn.prototype.constructor=Pn,xn.prototype.clear=function(){this.__data__=_n?_n(null):{},this.size=0},xn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},xn.prototype.get=function(e){var t=this.__data__;if(_n){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Ce.call(t,e)?t[e]:void 0},xn.prototype.has=function(e){var t=this.__data__;return _n?void 0!==t[e]:Ce.call(t,e)},xn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=_n&&void 0===t?"__lodash_hash_undefined__":t,this},Mn.prototype.clear=function(){this.__data__=[],this.size=0},Mn.prototype.delete=function(e){var t=this.__data__,n=Kn(t,e);return!(n<0)&&(n==t.length-1?t.pop():$e.call(t,n,1),--this.size,!0)},Mn.prototype.get=function(e){var t=this.__data__,n=Kn(t,e);return n<0?void 0:t[n][1]},Mn.prototype.has=function(e){return Kn(this.__data__,e)>-1},Mn.prototype.set=function(e,t){var n=this.__data__,r=Kn(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Ln.prototype.clear=function(){this.size=0,this.__data__={hash:new xn,map:new(hn||Mn),string:new xn}},Ln.prototype.delete=function(e){var t=Xi(this,e).delete(e);return this.size-=t?1:0,t},Ln.prototype.get=function(e){return Xi(this,e).get(e)},Ln.prototype.has=function(e){return Xi(this,e).has(e)},Ln.prototype.set=function(e,t){var n=Xi(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},jn.prototype.add=jn.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},jn.prototype.has=function(e){return this.__data__.has(e)},Nn.prototype.clear=function(){this.__data__=new Mn,this.size=0},Nn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Nn.prototype.get=function(e){return this.__data__.get(e)},Nn.prototype.has=function(e){return this.__data__.has(e)},Nn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Mn){var r=n.__data__;if(!hn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Ln(r)}return n.set(e,t),this.size=n.size,this};var er=Ei(cr),tr=Ei(ur,!0);function nr(e,t){var n=!0;return er(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function rr(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],s=t(o);if(null!=s&&(void 0===a?s==s&&!Xs(s):n(s,a)))var a=s,c=o}return c}function ir(e,t){var n=[];return er(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function or(e,t,n,r,i){var o=-1,s=e.length;for(n||(n=oo),i||(i=[]);++o<s;){var a=e[o];t>0&&n(a)?t>1?or(a,t-1,n,r,i):ft(i,a):r||(i[i.length]=a)}return i}var sr=Si(),ar=Si(!0);function cr(e,t){return e&&sr(e,t,ba)}function ur(e,t){return e&&ar(e,t,ba)}function dr(e,t){return ct(t,(function(t){return zs(e[t])}))}function lr(e,t){for(var n=0,r=(t=ai(t,e)).length;null!=e&&n<r;)e=e[Ro(t[n++])];return n&&n==r?e:void 0}function fr(e,t,n){var r=t(e);return xs(e)?r:ft(r,n(e))}function hr(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Wt&&Wt in me(e)?function(e){var t=Ce.call(e,Wt),n=e[Wt];try{e[Wt]=void 0;var r=!0}catch(e){}var i=Te.call(e);r&&(t?e[Wt]=n:delete e[Wt]);return i}(e):function(e){return Te.call(e)}(e)}function pr(e,t){return e>t}function mr(e,t){return null!=e&&Ce.call(e,t)}function vr(e,t){return null!=e&&t in me(e)}function _r(e,t,n){for(var r=n?dt:ut,i=e[0].length,o=e.length,s=o,a=de(o),c=1/0,u=[];s--;){var d=e[s];s&&t&&(d=lt(d,It(t))),c=an(d.length,c),a[s]=!n&&(t||i>=120&&d.length>=120)?new jn(s&&d):void 0}d=e[0];var l=-1,f=a[0];e:for(;++l<i&&u.length<c;){var h=d[l],p=t?t(h):h;if(h=n||0!==h?h:0,!(f?At(f,p):r(u,p,n))){for(s=o;--s;){var m=a[s];if(!(m?At(m,p):r(e[s],p,n)))continue e}f&&f.push(p),u.push(h)}}return u}function gr(e,t,n){var r=null==(e=vo(e,t=ai(t,e)))?e:e[Ro(Uo(t))];return null==r?void 0:rt(r,e,n)}function yr(e){return Ks(e)&&hr(e)==o}function br(e,t,n,r,i){return e===t||(null==e||null==t||!Ks(e)&&!Ks(t)?e!=e&&t!=t:function(e,t,n,r,i,d){var l=xs(e),y=xs(t),S=l?s:no(e),w=y?s:no(t),C=(S=S==o?p:S)==p,k=(w=w==o?p:w)==p,R=S==w;if(R&&Ns(e)){if(!Ns(t))return!1;l=!0,C=!1}if(R&&!C)return d||(d=new Nn),l||Zs(e)?Hi(e,t,n,r,i,d):function(e,t,n,r,i,o,s){switch(n){case E:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case b:return!(e.byteLength!=t.byteLength||!o(new He(e),new He(t)));case a:case c:case h:return Os(+e,+t);case u:return e.name==t.name&&e.message==t.message;case m:case _:return e==t+"";case f:var d=Bt;case v:var l=1&r;if(d||(d=Ft),e.size!=t.size&&!l)return!1;var p=s.get(e);if(p)return p==t;r|=2,s.set(e,t);var y=Hi(d(e),d(t),r,i,o,s);return s.delete(e),y;case g:if(Rn)return Rn.call(e)==Rn.call(t)}return!1}(e,t,S,n,r,i,d);if(!(1&n)){var T=C&&Ce.call(e,"__wrapped__"),I=k&&Ce.call(t,"__wrapped__");if(T||I){var O=T?e.value():e,A=I?t.value():t;return d||(d=new Nn),i(O,A,n,r,d)}}if(!R)return!1;return d||(d=new Nn),function(e,t,n,r,i,o){var s=1&n,a=Vi(e),c=a.length,u=Vi(t).length;if(c!=u&&!s)return!1;var d=c;for(;d--;){var l=a[d];if(!(s?l in t:Ce.call(t,l)))return!1}var f=o.get(e),h=o.get(t);if(f&&h)return f==t&&h==e;var p=!0;o.set(e,t),o.set(t,e);var m=s;for(;++d<c;){l=a[d];var v=e[l],_=t[l];if(r)var g=s?r(_,v,l,t,e,o):r(v,_,l,e,t,o);if(!(void 0===g?v===_||i(v,_,n,r,o):g)){p=!1;break}m||(m="constructor"==l)}if(p&&!m){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(p=!1)}return o.delete(e),o.delete(t),p}(e,t,n,r,i,d)}(e,t,n,r,br,i))}function Er(e,t,n,r){var i=n.length,o=i,s=!r;if(null==e)return!o;for(e=me(e);i--;){var a=n[i];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){var c=(a=n[i])[0],u=e[c],d=a[1];if(s&&a[2]){if(void 0===u&&!(c in e))return!1}else{var l=new Nn;if(r)var f=r(u,d,c,e,t,l);if(!(void 0===f?br(d,u,3,r,l):f))return!1}}return!0}function Sr(e){return!(!Hs(e)||(t=e,Re&&Re in t))&&(zs(e)?Pe:ie).test(To(e));var t}function wr(e){return"function"==typeof e?e:null==e?qa:"object"==typeof e?xs(e)?Or(e[0],e[1]):Ir(e):tc(e)}function Cr(e){if(!fo(e))return on(e);var t=[];for(var n in me(e))Ce.call(e,n)&&"constructor"!=n&&t.push(n);return t}function kr(e){if(!Hs(e))return function(e){var t=[];if(null!=e)for(var n in me(e))t.push(n);return t}(e);var t=fo(e),n=[];for(var r in e)("constructor"!=r||!t&&Ce.call(e,r))&&n.push(r);return n}function Rr(e,t){return e<t}function Tr(e,t){var n=-1,r=Ls(e)?de(e.length):[];return er(e,(function(e,i,o){r[++n]=t(e,i,o)})),r}function Ir(e){var t=Zi(e);return 1==t.length&&t[0][2]?po(t[0][0],t[0][1]):function(n){return n===e||Er(n,e,t)}}function Or(e,t){return co(e)&&ho(t)?po(Ro(e),t):function(n){var r=ma(n,e);return void 0===r&&r===t?va(n,e):br(t,r,3)}}function Ar(e,t,n,r,i){e!==t&&sr(t,(function(o,s){if(i||(i=new Nn),Hs(o))!function(e,t,n,r,i,o,s){var a=go(e,n),c=go(t,n),u=s.get(c);if(u)return void Gn(e,n,u);var d=o?o(a,c,n+"",e,t,s):void 0,l=void 0===d;if(l){var f=xs(c),h=!f&&Ns(c),p=!f&&!h&&Zs(c);d=c,f||h||p?xs(a)?d=a:js(a)?d=_i(a):h?(l=!1,d=li(c,!0)):p?(l=!1,d=hi(c,!0)):d=[]:Ws(c)||Ps(c)?(d=a,Ps(a)?d=sa(a):Hs(a)&&!zs(a)||(d=io(c))):l=!1}l&&(s.set(c,d),i(d,c,r,o,s),s.delete(c));Gn(e,n,d)}(e,t,s,n,Ar,r,i);else{var a=r?r(go(e,s),o,s+"",e,t,i):void 0;void 0===a&&(a=o),Gn(e,s,a)}}),Ea)}function Dr(e,t){var n=e.length;if(n)return so(t+=t<0?n:0,n)?e[t]:void 0}function Pr(e,t,n){t=t.length?lt(t,(function(e){return xs(e)?function(t){return lr(t,1===e.length?e[0]:e)}:e})):[qa];var r=-1;return t=lt(t,It($i())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(Tr(e,(function(e,n,i){return{criteria:lt(t,(function(t){return t(e)})),index:++r,value:e}})),(function(e,t){return function(e,t,n){var r=-1,i=e.criteria,o=t.criteria,s=i.length,a=n.length;for(;++r<s;){var c=pi(i[r],o[r]);if(c){if(r>=a)return c;var u=n[r];return c*("desc"==u?-1:1)}}return e.index-t.index}(e,t,n)}))}function xr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=lr(e,s);n(a,s)&&Fr(o,ai(s,e),a)}return o}function Mr(e,t,n,r){var i=r?bt:yt,o=-1,s=t.length,a=e;for(e===t&&(t=_i(t)),n&&(a=lt(e,It(n)));++o<s;)for(var c=0,u=t[o],d=n?n(u):u;(c=i(a,d,c,r))>-1;)a!==e&&$e.call(a,c,1),$e.call(e,c,1);return e}function Lr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;so(i)?$e.call(e,i,1):Qr(e,i)}}return e}function jr(e,t){return e+Qt(dn()*(t-e+1))}function Nr(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=Qt(t/2))&&(e+=e)}while(t);return n}function Br(e,t){return Eo(mo(e,t,qa),e+"")}function Ur(e){return Un(Oa(e))}function zr(e,t){var n=Oa(e);return Co(n,Jn(t,0,n.length))}function Fr(e,t,n,r){if(!Hs(e))return e;for(var i=-1,o=(t=ai(t,e)).length,s=o-1,a=e;null!=a&&++i<o;){var c=Ro(t[i]),u=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(i!=s){var d=a[c];void 0===(u=r?r(d,c,a):void 0)&&(u=Hs(d)?d:so(t[i+1])?[]:{})}Hn(a,c,u),a=a[c]}return e}var Gr=gn?function(e,t){return gn.set(e,t),e}:qa,Hr=Yt?function(e,t){return Yt(e,"toString",{configurable:!0,enumerable:!1,value:Ha(t),writable:!0})}:qa;function Kr(e){return Co(Oa(e))}function Vr(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=de(i);++r<i;)o[r]=e[r+t];return o}function qr(e,t){var n;return er(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function Wr(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,s=e[o];null!==s&&!Xs(s)&&(n?s<=t:s<t)?r=o+1:i=o}return i}return Yr(e,t,qa,n)}function Yr(e,t,n,r){var i=0,o=null==e?0:e.length;if(0===o)return 0;for(var s=(t=n(t))!=t,a=null===t,c=Xs(t),u=void 0===t;i<o;){var d=Qt((i+o)/2),l=n(e[d]),f=void 0!==l,h=null===l,p=l==l,m=Xs(l);if(s)var v=r||p;else v=u?p&&(r||f):a?p&&f&&(r||!h):c?p&&f&&!h&&(r||!m):!h&&!m&&(r?l<=t:l<t);v?i=d+1:o=d}return an(o,4294967294)}function Jr(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n],a=t?t(s):s;if(!n||!Os(a,c)){var c=a;o[i++]=0===s?0:s}}return o}function $r(e){return"number"==typeof e?e:Xs(e)?NaN:+e}function Xr(e){if("string"==typeof e)return e;if(xs(e))return lt(e,Xr)+"";if(Xs(e))return Tn?Tn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Zr(e,t,n){var r=-1,i=ut,o=e.length,s=!0,a=[],c=a;if(n)s=!1,i=dt;else if(o>=200){var u=t?null:Ni(e);if(u)return Ft(u);s=!1,i=At,c=new jn}else c=t?[]:a;e:for(;++r<o;){var d=e[r],l=t?t(d):d;if(d=n||0!==d?d:0,s&&l==l){for(var f=c.length;f--;)if(c[f]===l)continue e;t&&c.push(l),a.push(d)}else i(c,l,n)||(c!==a&&c.push(l),a.push(d))}return a}function Qr(e,t){return null==(e=vo(e,t=ai(t,e)))||delete e[Ro(Uo(t))]}function ei(e,t,n,r){return Fr(e,t,n(lr(e,t)),r)}function ti(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?Vr(e,r?0:o,r?o+1:i):Vr(e,r?o+1:0,r?i:o)}function ni(e,t){var n=e;return n instanceof Pn&&(n=n.value()),ht(t,(function(e,t){return t.func.apply(t.thisArg,ft([e],t.args))}),n)}function ri(e,t,n){var r=e.length;if(r<2)return r?Zr(e[0]):[];for(var i=-1,o=de(r);++i<r;)for(var s=e[i],a=-1;++a<r;)a!=i&&(o[i]=Qn(o[i]||s,e[a],t,n));return Zr(or(o,1),t,n)}function ii(e,t,n){for(var r=-1,i=e.length,o=t.length,s={};++r<i;){var a=r<o?t[r]:void 0;n(s,e[r],a)}return s}function oi(e){return js(e)?e:[]}function si(e){return"function"==typeof e?e:qa}function ai(e,t){return xs(e)?e:co(e,t)?[e]:ko(aa(e))}var ci=Br;function ui(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:Vr(e,t,n)}var di=Jt||function(e){return Ve.clearTimeout(e)};function li(e,t){if(t)return e.slice();var n=e.length,r=Ke?Ke(n):new e.constructor(n);return e.copy(r),r}function fi(e){var t=new e.constructor(e.byteLength);return new He(t).set(new He(e)),t}function hi(e,t){var n=t?fi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function pi(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e==e,o=Xs(e),s=void 0!==t,a=null===t,c=t==t,u=Xs(t);if(!a&&!u&&!o&&e>t||o&&s&&c&&!a&&!u||r&&s&&c||!n&&c||!i)return 1;if(!r&&!o&&!u&&e<t||u&&n&&i&&!r&&!o||a&&n&&i||!s&&i||!c)return-1}return 0}function mi(e,t,n,r){for(var i=-1,o=e.length,s=n.length,a=-1,c=t.length,u=sn(o-s,0),d=de(c+u),l=!r;++a<c;)d[a]=t[a];for(;++i<s;)(l||i<o)&&(d[n[i]]=e[i]);for(;u--;)d[a++]=e[i++];return d}function vi(e,t,n,r){for(var i=-1,o=e.length,s=-1,a=n.length,c=-1,u=t.length,d=sn(o-a,0),l=de(d+u),f=!r;++i<d;)l[i]=e[i];for(var h=i;++c<u;)l[h+c]=t[c];for(;++s<a;)(f||i<o)&&(l[h+n[s]]=e[i++]);return l}function _i(e,t){var n=-1,r=e.length;for(t||(t=de(r));++n<r;)t[n]=e[n];return t}function gi(e,t,n,r){var i=!n;n||(n={});for(var o=-1,s=t.length;++o<s;){var a=t[o],c=r?r(n[a],e[a],a,n,e):void 0;void 0===c&&(c=e[a]),i?Wn(n,a,c):Hn(n,a,c)}return n}function yi(e,t){return function(n,r){var i=xs(n)?it:Vn,o=t?t():{};return i(n,e,$i(r,2),o)}}function bi(e){return Br((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&ao(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),t=me(t);++r<i;){var a=n[r];a&&e(t,a,r,o)}return t}))}function Ei(e,t){return function(n,r){if(null==n)return n;if(!Ls(n))return e(n,r);for(var i=n.length,o=t?i:-1,s=me(n);(t?o--:++o<i)&&!1!==r(s[o],o,s););return n}}function Si(e){return function(t,n,r){for(var i=-1,o=me(t),s=r(t),a=s.length;a--;){var c=s[e?a:++i];if(!1===n(o[c],c,o))break}return t}}function wi(e){return function(t){var n=Nt(t=aa(t))?Kt(t):void 0,r=n?n[0]:t.charAt(0),i=n?ui(n,1).join(""):t.slice(1);return r[e]()+i}}function Ci(e){return function(t){return ht(za(Pa(t).replace(Ae,"")),e,"")}}function ki(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=On(e.prototype),r=e.apply(n,t);return Hs(r)?r:n}}function Ri(e){return function(t,n,r){var i=me(t);if(!Ls(t)){var o=$i(n,3);t=ba(t),n=function(e){return o(i[e],e,i)}}var s=e(t,n,r);return s>-1?i[o?t[s]:s]:void 0}}function Ti(e){return Ki((function(t){var r=t.length,i=r,o=Dn.prototype.thru;for(e&&t.reverse();i--;){var s=t[i];if("function"!=typeof s)throw new ge(n);if(o&&!a&&"wrapper"==Yi(s))var a=new Dn([],!0)}for(i=a?i:r;++i<r;){var c=Yi(s=t[i]),u="wrapper"==c?Wi(s):void 0;a=u&&uo(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?a[Yi(u[0])].apply(a,u[3]):1==s.length&&uo(s)?a[c]():a.thru(s)}return function(){var e=arguments,n=e[0];if(a&&1==e.length&&xs(n))return a.plant(n).value();for(var i=0,o=r?t[i].apply(this,e):n;++i<r;)o=t[i].call(this,o);return o}}))}function Ii(e,t,n,r,i,o,s,a,c,u){var d=128&t,l=1&t,f=2&t,h=24&t,p=512&t,m=f?void 0:ki(e);return function v(){for(var _=arguments.length,g=de(_),y=_;y--;)g[y]=arguments[y];if(h)var b=Ji(v),E=xt(g,b);if(r&&(g=mi(g,r,i,h)),o&&(g=vi(g,o,s,h)),_-=E,h&&_<u){var S=zt(g,b);return Li(e,t,Ii,v.placeholder,n,g,S,a,c,u-_)}var w=l?n:this,C=f?w[e]:e;return _=g.length,a?g=_o(g,a):p&&_>1&&g.reverse(),d&&c<_&&(g.length=c),this&&this!==Ve&&this instanceof v&&(C=m||ki(C)),C.apply(w,g)}}function Oi(e,t){return function(n,r){return function(e,t,n,r){return cr(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}function Ai(e,t){return function(n,r){var i;if(void 0===n&&void 0===r)return t;if(void 0!==n&&(i=n),void 0!==r){if(void 0===i)return r;"string"==typeof n||"string"==typeof r?(n=Xr(n),r=Xr(r)):(n=$r(n),r=$r(r)),i=e(n,r)}return i}}function Di(e){return Ki((function(t){return t=lt(t,It($i())),Br((function(n){var r=this;return e(t,(function(e){return rt(e,r,n)}))}))}))}function Pi(e,t){var n=(t=void 0===t?" ":Xr(t)).length;if(n<2)return n?Nr(t,e):t;var r=Nr(t,Zt(e/Ht(t)));return Nt(t)?ui(Kt(r),0,e).join(""):r.slice(0,e)}function xi(e){return function(t,n,r){return r&&"number"!=typeof r&&ao(t,n,r)&&(n=r=void 0),t=na(t),void 0===n?(n=t,t=0):n=na(n),function(e,t,n,r){for(var i=-1,o=sn(Zt((t-e)/(n||1)),0),s=de(o);o--;)s[r?o:++i]=e,e+=n;return s}(t,n,r=void 0===r?t<n?1:-1:na(r),e)}}function Mi(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=oa(t),n=oa(n)),e(t,n)}}function Li(e,t,n,r,i,o,s,a,c,u){var d=8&t;t|=d?32:64,4&(t&=~(d?64:32))||(t&=-4);var l=[e,t,i,d?o:void 0,d?s:void 0,d?void 0:o,d?void 0:s,a,c,u],f=n.apply(void 0,l);return uo(e)&&yo(f,l),f.placeholder=r,So(f,e,t)}function ji(e){var t=pe[e];return function(e,n){if(e=oa(e),(n=null==n?0:an(ra(n),292))&&nn(e)){var r=(aa(e)+"e").split("e");return+((r=(aa(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Ni=mn&&1/Ft(new mn([,-0]))[1]==1/0?function(e){return new mn(e)}:Xa;function Bi(e){return function(t){var n=no(t);return n==f?Bt(t):n==v?Gt(t):function(e,t){return lt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Ui(e,t,i,o,s,a,c,u){var d=2&t;if(!d&&"function"!=typeof e)throw new ge(n);var l=o?o.length:0;if(l||(t&=-97,o=s=void 0),c=void 0===c?c:sn(ra(c),0),u=void 0===u?u:ra(u),l-=s?s.length:0,64&t){var f=o,h=s;o=s=void 0}var p=d?void 0:Wi(e),m=[e,t,i,o,s,f,h,a,c,u];if(p&&function(e,t){var n=e[1],i=t[1],o=n|i,s=o<131,a=128==i&&8==n||128==i&&256==n&&e[7].length<=t[8]||384==i&&t[7].length<=t[8]&&8==n;if(!s&&!a)return e;1&i&&(e[2]=t[2],o|=1&n?0:4);var c=t[3];if(c){var u=e[3];e[3]=u?mi(u,c,t[4]):c,e[4]=u?zt(e[3],r):t[4]}(c=t[5])&&(u=e[5],e[5]=u?vi(u,c,t[6]):c,e[6]=u?zt(e[5],r):t[6]);(c=t[7])&&(e[7]=c);128&i&&(e[8]=null==e[8]?t[8]:an(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=o}(m,p),e=m[0],t=m[1],i=m[2],o=m[3],s=m[4],!(u=m[9]=void 0===m[9]?d?0:e.length:sn(m[9]-l,0))&&24&t&&(t&=-25),t&&1!=t)v=8==t||16==t?function(e,t,n){var r=ki(e);return function i(){for(var o=arguments.length,s=de(o),a=o,c=Ji(i);a--;)s[a]=arguments[a];var u=o<3&&s[0]!==c&&s[o-1]!==c?[]:zt(s,c);if((o-=u.length)<n)return Li(e,t,Ii,i.placeholder,void 0,s,u,void 0,void 0,n-o);var d=this&&this!==Ve&&this instanceof i?r:e;return rt(d,this,s)}}(e,t,u):32!=t&&33!=t||s.length?Ii.apply(void 0,m):function(e,t,n,r){var i=1&t,o=ki(e);return function t(){for(var s=-1,a=arguments.length,c=-1,u=r.length,d=de(u+a),l=this&&this!==Ve&&this instanceof t?o:e;++c<u;)d[c]=r[c];for(;a--;)d[c++]=arguments[++s];return rt(l,i?n:this,d)}}(e,t,i,o);else var v=function(e,t,n){var r=1&t,i=ki(e);return function t(){var o=this&&this!==Ve&&this instanceof t?i:e;return o.apply(r?n:this,arguments)}}(e,t,i);return So((p?Gr:yo)(v,m),e,t)}function zi(e,t,n,r){return void 0===e||Os(e,Ee[n])&&!Ce.call(r,n)?t:e}function Fi(e,t,n,r,i,o){return Hs(e)&&Hs(t)&&(o.set(t,e),Ar(e,t,void 0,Fi,o),o.delete(t)),e}function Gi(e){return Ws(e)?void 0:e}function Hi(e,t,n,r,i,o){var s=1&n,a=e.length,c=t.length;if(a!=c&&!(s&&c>a))return!1;var u=o.get(e),d=o.get(t);if(u&&d)return u==t&&d==e;var l=-1,f=!0,h=2&n?new jn:void 0;for(o.set(e,t),o.set(t,e);++l<a;){var p=e[l],m=t[l];if(r)var v=s?r(m,p,l,t,e,o):r(p,m,l,e,t,o);if(void 0!==v){if(v)continue;f=!1;break}if(h){if(!mt(t,(function(e,t){if(!At(h,t)&&(p===e||i(p,e,n,r,o)))return h.push(t)}))){f=!1;break}}else if(p!==m&&!i(p,m,n,r,o)){f=!1;break}}return o.delete(e),o.delete(t),f}function Ki(e){return Eo(mo(e,void 0,Mo),e+"")}function Vi(e){return fr(e,ba,eo)}function qi(e){return fr(e,Ea,to)}var Wi=gn?function(e){return gn.get(e)}:Xa;function Yi(e){for(var t=e.name+"",n=yn[t],r=Ce.call(yn,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function Ji(e){return(Ce.call(In,"placeholder")?In:e).placeholder}function $i(){var e=In.iteratee||Wa;return e=e===Wa?wr:e,arguments.length?e(arguments[0],arguments[1]):e}function Xi(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Zi(e){for(var t=ba(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,ho(i)]}return t}function Qi(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Sr(n)?n:void 0}var eo=en?function(e){return null==e?[]:(e=me(e),ct(en(e),(function(t){return Je.call(e,t)})))}:ic,to=en?function(e){for(var t=[];e;)ft(t,eo(e)),e=qe(e);return t}:ic,no=hr;function ro(e,t,n){for(var r=-1,i=(t=ai(t,e)).length,o=!1;++r<i;){var s=Ro(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Gs(i)&&so(s,i)&&(xs(e)||Ps(e))}function io(e){return"function"!=typeof e.constructor||fo(e)?{}:On(qe(e))}function oo(e){return xs(e)||Ps(e)||!!(vt&&e&&e[vt])}function so(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&se.test(e))&&e>-1&&e%1==0&&e<t}function ao(e,t,n){if(!Hs(n))return!1;var r=typeof t;return!!("number"==r?Ls(n)&&so(t,n.length):"string"==r&&t in n)&&Os(n[t],e)}function co(e,t){if(xs(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Xs(e))||(G.test(e)||!F.test(e)||null!=t&&e in me(t))}function uo(e){var t=Yi(e),n=In[t];if("function"!=typeof n||!(t in Pn.prototype))return!1;if(e===n)return!0;var r=Wi(n);return!!r&&e===r[0]}(fn&&no(new fn(new ArrayBuffer(1)))!=E||hn&&no(new hn)!=f||pn&&"[object Promise]"!=no(pn.resolve())||mn&&no(new mn)!=v||vn&&no(new vn)!=y)&&(no=function(e){var t=hr(e),n=t==p?e.constructor:void 0,r=n?To(n):"";if(r)switch(r){case bn:return E;case En:return f;case Sn:return"[object Promise]";case wn:return v;case Cn:return y}return t});var lo=Se?zs:oc;function fo(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ee)}function ho(e){return e==e&&!Hs(e)}function po(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in me(n)))}}function mo(e,t,n){return t=sn(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=sn(r.length-t,0),s=de(o);++i<o;)s[i]=r[t+i];i=-1;for(var a=de(t+1);++i<t;)a[i]=r[i];return a[t]=n(s),rt(e,this,a)}}function vo(e,t){return t.length<2?e:lr(e,Vr(t,0,-1))}function _o(e,t){for(var n=e.length,r=an(t.length,n),i=_i(e);r--;){var o=t[r];e[r]=so(o,n)?i[o]:void 0}return e}function go(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var yo=wo(Gr),bo=Xt||function(e,t){return Ve.setTimeout(e,t)},Eo=wo(Hr);function So(e,t,n){var r=t+"";return Eo(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(J,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return ot(i,(function(n){var r="_."+n[0];t&n[1]&&!ut(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match($);return t?t[1].split(X):[]}(r),n)))}function wo(e){var t=0,n=0;return function(){var r=cn(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function Co(e,t){var n=-1,r=e.length,i=r-1;for(t=void 0===t?r:t;++n<t;){var o=jr(n,i),s=e[o];e[o]=e[n],e[n]=s}return e.length=t,e}var ko=function(e){var t=ws(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(H,(function(e,n,r,i){t.push(r?i.replace(Q,"$1"):n||e)})),t}));function Ro(e){if("string"==typeof e||Xs(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function To(e){if(null!=e){try{return we.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Io(e){if(e instanceof Pn)return e.clone();var t=new Dn(e.__wrapped__,e.__chain__);return t.__actions__=_i(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Oo=Br((function(e,t){return js(e)?Qn(e,or(t,1,js,!0)):[]})),Ao=Br((function(e,t){var n=Uo(t);return js(n)&&(n=void 0),js(e)?Qn(e,or(t,1,js,!0),$i(n,2)):[]})),Do=Br((function(e,t){var n=Uo(t);return js(n)&&(n=void 0),js(e)?Qn(e,or(t,1,js,!0),void 0,n):[]}));function Po(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ra(n);return i<0&&(i=sn(r+i,0)),gt(e,$i(t,3),i)}function xo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=ra(n),i=n<0?sn(r+i,0):an(i,r-1)),gt(e,$i(t,3),i,!0)}function Mo(e){return(null==e?0:e.length)?or(e,1):[]}function Lo(e){return e&&e.length?e[0]:void 0}var jo=Br((function(e){var t=lt(e,oi);return t.length&&t[0]===e[0]?_r(t):[]})),No=Br((function(e){var t=Uo(e),n=lt(e,oi);return t===Uo(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?_r(n,$i(t,2)):[]})),Bo=Br((function(e){var t=Uo(e),n=lt(e,oi);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?_r(n,void 0,t):[]}));function Uo(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var zo=Br(Fo);function Fo(e,t){return e&&e.length&&t&&t.length?Mr(e,t):e}var Go=Ki((function(e,t){var n=null==e?0:e.length,r=Yn(e,t);return Lr(e,lt(t,(function(e){return so(e,n)?+e:e})).sort(pi)),r}));function Ho(e){return null==e?e:ln.call(e)}var Ko=Br((function(e){return Zr(or(e,1,js,!0))})),Vo=Br((function(e){var t=Uo(e);return js(t)&&(t=void 0),Zr(or(e,1,js,!0),$i(t,2))})),qo=Br((function(e){var t=Uo(e);return t="function"==typeof t?t:void 0,Zr(or(e,1,js,!0),void 0,t)}));function Wo(e){if(!e||!e.length)return[];var t=0;return e=ct(e,(function(e){if(js(e))return t=sn(e.length,t),!0})),Tt(t,(function(t){return lt(e,wt(t))}))}function Yo(e,t){if(!e||!e.length)return[];var n=Wo(e);return null==t?n:lt(n,(function(e){return rt(t,void 0,e)}))}var Jo=Br((function(e,t){return js(e)?Qn(e,t):[]})),$o=Br((function(e){return ri(ct(e,js))})),Xo=Br((function(e){var t=Uo(e);return js(t)&&(t=void 0),ri(ct(e,js),$i(t,2))})),Zo=Br((function(e){var t=Uo(e);return t="function"==typeof t?t:void 0,ri(ct(e,js),void 0,t)})),Qo=Br(Wo);var es=Br((function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,Yo(e,n)}));function ts(e){var t=In(e);return t.__chain__=!0,t}function ns(e,t){return t(e)}var rs=Ki((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return Yn(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Pn&&so(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:ns,args:[i],thisArg:void 0}),new Dn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(i)}));var is=yi((function(e,t,n){Ce.call(e,n)?++e[n]:Wn(e,n,1)}));var os=Ri(Po),ss=Ri(xo);function as(e,t){return(xs(e)?ot:er)(e,$i(t,3))}function cs(e,t){return(xs(e)?st:tr)(e,$i(t,3))}var us=yi((function(e,t,n){Ce.call(e,n)?e[n].push(t):Wn(e,n,[t])}));var ds=Br((function(e,t,n){var r=-1,i="function"==typeof t,o=Ls(e)?de(e.length):[];return er(e,(function(e){o[++r]=i?rt(t,e,n):gr(e,t,n)})),o})),ls=yi((function(e,t,n){Wn(e,n,t)}));function fs(e,t){return(xs(e)?lt:Tr)(e,$i(t,3))}var hs=yi((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var ps=Br((function(e,t){if(null==e)return[];var n=t.length;return n>1&&ao(e,t[0],t[1])?t=[]:n>2&&ao(t[0],t[1],t[2])&&(t=[t[0]]),Pr(e,or(t,1),[])})),ms=$t||function(){return Ve.Date.now()};function vs(e,t,n){return t=n?void 0:t,Ui(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)}function _s(e,t){var r;if("function"!=typeof t)throw new ge(n);return e=ra(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}}var gs=Br((function(e,t,n){var r=1;if(n.length){var i=zt(n,Ji(gs));r|=32}return Ui(e,r,t,n,i)})),ys=Br((function(e,t,n){var r=3;if(n.length){var i=zt(n,Ji(ys));r|=32}return Ui(t,r,e,n,i)}));function bs(e,t,r){var i,o,s,a,c,u,d=0,l=!1,f=!1,h=!0;if("function"!=typeof e)throw new ge(n);function p(t){var n=i,r=o;return i=o=void 0,d=t,a=e.apply(r,n)}function m(e){return d=e,c=bo(_,t),l?p(e):a}function v(e){var n=e-u;return void 0===u||n>=t||n<0||f&&e-d>=s}function _(){var e=ms();if(v(e))return g(e);c=bo(_,function(e){var n=t-(e-u);return f?an(n,s-(e-d)):n}(e))}function g(e){return c=void 0,h&&i?p(e):(i=o=void 0,a)}function y(){var e=ms(),n=v(e);if(i=arguments,o=this,u=e,n){if(void 0===c)return m(u);if(f)return di(c),c=bo(_,t),p(u)}return void 0===c&&(c=bo(_,t)),a}return t=oa(t)||0,Hs(r)&&(l=!!r.leading,s=(f="maxWait"in r)?sn(oa(r.maxWait)||0,t):s,h="trailing"in r?!!r.trailing:h),y.cancel=function(){void 0!==c&&di(c),d=0,i=u=o=c=void 0},y.flush=function(){return void 0===c?a:g(ms())},y}var Es=Br((function(e,t){return Zn(e,1,t)})),Ss=Br((function(e,t,n){return Zn(e,oa(t)||0,n)}));function ws(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new ge(n);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=e.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(ws.Cache||Ln),r}function Cs(e){if("function"!=typeof e)throw new ge(n);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}ws.Cache=Ln;var ks=ci((function(e,t){var n=(t=1==t.length&&xs(t[0])?lt(t[0],It($i())):lt(or(t,1),It($i()))).length;return Br((function(r){for(var i=-1,o=an(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return rt(e,this,r)}))})),Rs=Br((function(e,t){return Ui(e,32,void 0,t,zt(t,Ji(Rs)))})),Ts=Br((function(e,t){return Ui(e,64,void 0,t,zt(t,Ji(Ts)))})),Is=Ki((function(e,t){return Ui(e,256,void 0,void 0,void 0,t)}));function Os(e,t){return e===t||e!=e&&t!=t}var As=Mi(pr),Ds=Mi((function(e,t){return e>=t})),Ps=yr(function(){return arguments}())?yr:function(e){return Ks(e)&&Ce.call(e,"callee")&&!Je.call(e,"callee")},xs=de.isArray,Ms=Xe?It(Xe):function(e){return Ks(e)&&hr(e)==b};function Ls(e){return null!=e&&Gs(e.length)&&!zs(e)}function js(e){return Ks(e)&&Ls(e)}var Ns=tn||oc,Bs=Ze?It(Ze):function(e){return Ks(e)&&hr(e)==c};function Us(e){if(!Ks(e))return!1;var t=hr(e);return t==u||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!Ws(e)}function zs(e){if(!Hs(e))return!1;var t=hr(e);return t==d||t==l||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Fs(e){return"number"==typeof e&&e==ra(e)}function Gs(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Hs(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ks(e){return null!=e&&"object"==typeof e}var Vs=Qe?It(Qe):function(e){return Ks(e)&&no(e)==f};function qs(e){return"number"==typeof e||Ks(e)&&hr(e)==h}function Ws(e){if(!Ks(e)||hr(e)!=p)return!1;var t=qe(e);if(null===t)return!0;var n=Ce.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&we.call(n)==Ie}var Ys=et?It(et):function(e){return Ks(e)&&hr(e)==m};var Js=tt?It(tt):function(e){return Ks(e)&&no(e)==v};function $s(e){return"string"==typeof e||!xs(e)&&Ks(e)&&hr(e)==_}function Xs(e){return"symbol"==typeof e||Ks(e)&&hr(e)==g}var Zs=nt?It(nt):function(e){return Ks(e)&&Gs(e.length)&&!!Be[hr(e)]};var Qs=Mi(Rr),ea=Mi((function(e,t){return e<=t}));function ta(e){if(!e)return[];if(Ls(e))return $s(e)?Kt(e):_i(e);if(Ct&&e[Ct])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Ct]());var t=no(e);return(t==f?Bt:t==v?Ft:Oa)(e)}function na(e){return e?(e=oa(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function ra(e){var t=na(e),n=t%1;return t==t?n?t-n:t:0}function ia(e){return e?Jn(ra(e),0,4294967295):0}function oa(e){if("number"==typeof e)return e;if(Xs(e))return NaN;if(Hs(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Hs(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(q,"");var n=re.test(e);return n||oe.test(e)?Ge(e.slice(2),n?2:8):ne.test(e)?NaN:+e}function sa(e){return gi(e,Ea(e))}function aa(e){return null==e?"":Xr(e)}var ca=bi((function(e,t){if(fo(t)||Ls(t))gi(t,ba(t),e);else for(var n in t)Ce.call(t,n)&&Hn(e,n,t[n])})),ua=bi((function(e,t){gi(t,Ea(t),e)})),da=bi((function(e,t,n,r){gi(t,Ea(t),e,r)})),la=bi((function(e,t,n,r){gi(t,ba(t),e,r)})),fa=Ki(Yn);var ha=Br((function(e,t){e=me(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&ao(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],s=Ea(o),a=-1,c=s.length;++a<c;){var u=s[a],d=e[u];(void 0===d||Os(d,Ee[u])&&!Ce.call(e,u))&&(e[u]=o[u])}return e})),pa=Br((function(e){return e.push(void 0,Fi),rt(wa,void 0,e)}));function ma(e,t,n){var r=null==e?void 0:lr(e,t);return void 0===r?n:r}function va(e,t){return null!=e&&ro(e,t,vr)}var _a=Oi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Te.call(t)),e[t]=n}),Ha(qa)),ga=Oi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Te.call(t)),Ce.call(e,t)?e[t].push(n):e[t]=[n]}),$i),ya=Br(gr);function ba(e){return Ls(e)?Bn(e):Cr(e)}function Ea(e){return Ls(e)?Bn(e,!0):kr(e)}var Sa=bi((function(e,t,n){Ar(e,t,n)})),wa=bi((function(e,t,n,r){Ar(e,t,n,r)})),Ca=Ki((function(e,t){var n={};if(null==e)return n;var r=!1;t=lt(t,(function(t){return t=ai(t,e),r||(r=t.length>1),t})),gi(e,qi(e),n),r&&(n=$n(n,7,Gi));for(var i=t.length;i--;)Qr(n,t[i]);return n}));var ka=Ki((function(e,t){return null==e?{}:function(e,t){return xr(e,t,(function(t,n){return va(e,n)}))}(e,t)}));function Ra(e,t){if(null==e)return{};var n=lt(qi(e),(function(e){return[e]}));return t=$i(t),xr(e,n,(function(e,n){return t(e,n[0])}))}var Ta=Bi(ba),Ia=Bi(Ea);function Oa(e){return null==e?[]:Ot(e,ba(e))}var Aa=Ci((function(e,t,n){return t=t.toLowerCase(),e+(n?Da(t):t)}));function Da(e){return Ua(aa(e).toLowerCase())}function Pa(e){return(e=aa(e))&&e.replace(ae,Mt).replace(De,"")}var xa=Ci((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Ma=Ci((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),La=wi("toLowerCase");var ja=Ci((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Na=Ci((function(e,t,n){return e+(n?" ":"")+Ua(t)}));var Ba=Ci((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ua=wi("toUpperCase");function za(e,t,n){return e=aa(e),void 0===(t=n?void 0:t)?function(e){return Le.test(e)}(e)?function(e){return e.match(xe)||[]}(e):function(e){return e.match(Z)||[]}(e):e.match(t)||[]}var Fa=Br((function(e,t){try{return rt(e,void 0,t)}catch(e){return Us(e)?e:new fe(e)}})),Ga=Ki((function(e,t){return ot(t,(function(t){t=Ro(t),Wn(e,t,gs(e[t],e))})),e}));function Ha(e){return function(){return e}}var Ka=Ti(),Va=Ti(!0);function qa(e){return e}function Wa(e){return wr("function"==typeof e?e:$n(e,1))}var Ya=Br((function(e,t){return function(n){return gr(n,e,t)}})),Ja=Br((function(e,t){return function(n){return gr(e,n,t)}}));function $a(e,t,n){var r=ba(t),i=dr(t,r);null!=n||Hs(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=dr(t,ba(t)));var o=!(Hs(n)&&"chain"in n&&!n.chain),s=zs(e);return ot(i,(function(n){var r=t[n];e[n]=r,s&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__),i=n.__actions__=_i(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,ft([this.value()],arguments))})})),e}function Xa(){}var Za=Di(lt),Qa=Di(at),ec=Di(mt);function tc(e){return co(e)?wt(Ro(e)):function(e){return function(t){return lr(t,e)}}(e)}var nc=xi(),rc=xi(!0);function ic(){return[]}function oc(){return!1}var sc=Ai((function(e,t){return e+t}),0),ac=ji("ceil"),cc=Ai((function(e,t){return e/t}),1),uc=ji("floor");var dc,lc=Ai((function(e,t){return e*t}),1),fc=ji("round"),hc=Ai((function(e,t){return e-t}),0);return In.after=function(e,t){if("function"!=typeof t)throw new ge(n);return e=ra(e),function(){if(--e<1)return t.apply(this,arguments)}},In.ary=vs,In.assign=ca,In.assignIn=ua,In.assignInWith=da,In.assignWith=la,In.at=fa,In.before=_s,In.bind=gs,In.bindAll=Ga,In.bindKey=ys,In.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return xs(e)?e:[e]},In.chain=ts,In.chunk=function(e,t,n){t=(n?ao(e,t,n):void 0===t)?1:sn(ra(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var i=0,o=0,s=de(Zt(r/t));i<r;)s[o++]=Vr(e,i,i+=t);return s},In.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},In.concat=function(){var e=arguments.length;if(!e)return[];for(var t=de(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return ft(xs(n)?_i(n):[n],or(t,1))},In.cond=function(e){var t=null==e?0:e.length,r=$i();return e=t?lt(e,(function(e){if("function"!=typeof e[1])throw new ge(n);return[r(e[0]),e[1]]})):[],Br((function(n){for(var r=-1;++r<t;){var i=e[r];if(rt(i[0],this,n))return rt(i[1],this,n)}}))},In.conforms=function(e){return function(e){var t=ba(e);return function(n){return Xn(n,e,t)}}($n(e,1))},In.constant=Ha,In.countBy=is,In.create=function(e,t){var n=On(e);return null==t?n:qn(n,t)},In.curry=function e(t,n,r){var i=Ui(t,8,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=e.placeholder,i},In.curryRight=function e(t,n,r){var i=Ui(t,16,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=e.placeholder,i},In.debounce=bs,In.defaults=ha,In.defaultsDeep=pa,In.defer=Es,In.delay=Ss,In.difference=Oo,In.differenceBy=Ao,In.differenceWith=Do,In.drop=function(e,t,n){var r=null==e?0:e.length;return r?Vr(e,(t=n||void 0===t?1:ra(t))<0?0:t,r):[]},In.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?Vr(e,0,(t=r-(t=n||void 0===t?1:ra(t)))<0?0:t):[]},In.dropRightWhile=function(e,t){return e&&e.length?ti(e,$i(t,3),!0,!0):[]},In.dropWhile=function(e,t){return e&&e.length?ti(e,$i(t,3),!0):[]},In.fill=function(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&ao(e,t,n)&&(n=0,r=i),function(e,t,n,r){var i=e.length;for((n=ra(n))<0&&(n=-n>i?0:i+n),(r=void 0===r||r>i?i:ra(r))<0&&(r+=i),r=n>r?0:ia(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},In.filter=function(e,t){return(xs(e)?ct:ir)(e,$i(t,3))},In.flatMap=function(e,t){return or(fs(e,t),1)},In.flatMapDeep=function(e,t){return or(fs(e,t),1/0)},In.flatMapDepth=function(e,t,n){return n=void 0===n?1:ra(n),or(fs(e,t),n)},In.flatten=Mo,In.flattenDeep=function(e){return(null==e?0:e.length)?or(e,1/0):[]},In.flattenDepth=function(e,t){return(null==e?0:e.length)?or(e,t=void 0===t?1:ra(t)):[]},In.flip=function(e){return Ui(e,512)},In.flow=Ka,In.flowRight=Va,In.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},In.functions=function(e){return null==e?[]:dr(e,ba(e))},In.functionsIn=function(e){return null==e?[]:dr(e,Ea(e))},In.groupBy=us,In.initial=function(e){return(null==e?0:e.length)?Vr(e,0,-1):[]},In.intersection=jo,In.intersectionBy=No,In.intersectionWith=Bo,In.invert=_a,In.invertBy=ga,In.invokeMap=ds,In.iteratee=Wa,In.keyBy=ls,In.keys=ba,In.keysIn=Ea,In.map=fs,In.mapKeys=function(e,t){var n={};return t=$i(t,3),cr(e,(function(e,r,i){Wn(n,t(e,r,i),e)})),n},In.mapValues=function(e,t){var n={};return t=$i(t,3),cr(e,(function(e,r,i){Wn(n,r,t(e,r,i))})),n},In.matches=function(e){return Ir($n(e,1))},In.matchesProperty=function(e,t){return Or(e,$n(t,1))},In.memoize=ws,In.merge=Sa,In.mergeWith=wa,In.method=Ya,In.methodOf=Ja,In.mixin=$a,In.negate=Cs,In.nthArg=function(e){return e=ra(e),Br((function(t){return Dr(t,e)}))},In.omit=Ca,In.omitBy=function(e,t){return Ra(e,Cs($i(t)))},In.once=function(e){return _s(2,e)},In.orderBy=function(e,t,n,r){return null==e?[]:(xs(t)||(t=null==t?[]:[t]),xs(n=r?void 0:n)||(n=null==n?[]:[n]),Pr(e,t,n))},In.over=Za,In.overArgs=ks,In.overEvery=Qa,In.overSome=ec,In.partial=Rs,In.partialRight=Ts,In.partition=hs,In.pick=ka,In.pickBy=Ra,In.property=tc,In.propertyOf=function(e){return function(t){return null==e?void 0:lr(e,t)}},In.pull=zo,In.pullAll=Fo,In.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Mr(e,t,$i(n,2)):e},In.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Mr(e,t,void 0,n):e},In.pullAt=Go,In.range=nc,In.rangeRight=rc,In.rearg=Is,In.reject=function(e,t){return(xs(e)?ct:ir)(e,Cs($i(t,3)))},In.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=$i(t,3);++r<o;){var s=e[r];t(s,r,e)&&(n.push(s),i.push(r))}return Lr(e,i),n},In.rest=function(e,t){if("function"!=typeof e)throw new ge(n);return Br(e,t=void 0===t?t:ra(t))},In.reverse=Ho,In.sampleSize=function(e,t,n){return t=(n?ao(e,t,n):void 0===t)?1:ra(t),(xs(e)?zn:zr)(e,t)},In.set=function(e,t,n){return null==e?e:Fr(e,t,n)},In.setWith=function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:Fr(e,t,n,r)},In.shuffle=function(e){return(xs(e)?Fn:Kr)(e)},In.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&ao(e,t,n)?(t=0,n=r):(t=null==t?0:ra(t),n=void 0===n?r:ra(n)),Vr(e,t,n)):[]},In.sortBy=ps,In.sortedUniq=function(e){return e&&e.length?Jr(e):[]},In.sortedUniqBy=function(e,t){return e&&e.length?Jr(e,$i(t,2)):[]},In.split=function(e,t,n){return n&&"number"!=typeof n&&ao(e,t,n)&&(t=n=void 0),(n=void 0===n?4294967295:n>>>0)?(e=aa(e))&&("string"==typeof t||null!=t&&!Ys(t))&&!(t=Xr(t))&&Nt(e)?ui(Kt(e),0,n):e.split(t,n):[]},In.spread=function(e,t){if("function"!=typeof e)throw new ge(n);return t=null==t?0:sn(ra(t),0),Br((function(n){var r=n[t],i=ui(n,0,t);return r&&ft(i,r),rt(e,this,i)}))},In.tail=function(e){var t=null==e?0:e.length;return t?Vr(e,1,t):[]},In.take=function(e,t,n){return e&&e.length?Vr(e,0,(t=n||void 0===t?1:ra(t))<0?0:t):[]},In.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?Vr(e,(t=r-(t=n||void 0===t?1:ra(t)))<0?0:t,r):[]},In.takeRightWhile=function(e,t){return e&&e.length?ti(e,$i(t,3),!1,!0):[]},In.takeWhile=function(e,t){return e&&e.length?ti(e,$i(t,3)):[]},In.tap=function(e,t){return t(e),e},In.throttle=function(e,t,r){var i=!0,o=!0;if("function"!=typeof e)throw new ge(n);return Hs(r)&&(i="leading"in r?!!r.leading:i,o="trailing"in r?!!r.trailing:o),bs(e,t,{leading:i,maxWait:t,trailing:o})},In.thru=ns,In.toArray=ta,In.toPairs=Ta,In.toPairsIn=Ia,In.toPath=function(e){return xs(e)?lt(e,Ro):Xs(e)?[e]:_i(ko(aa(e)))},In.toPlainObject=sa,In.transform=function(e,t,n){var r=xs(e),i=r||Ns(e)||Zs(e);if(t=$i(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:Hs(e)&&zs(o)?On(qe(e)):{}}return(i?ot:cr)(e,(function(e,r,i){return t(n,e,r,i)})),n},In.unary=function(e){return vs(e,1)},In.union=Ko,In.unionBy=Vo,In.unionWith=qo,In.uniq=function(e){return e&&e.length?Zr(e):[]},In.uniqBy=function(e,t){return e&&e.length?Zr(e,$i(t,2)):[]},In.uniqWith=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?Zr(e,void 0,t):[]},In.unset=function(e,t){return null==e||Qr(e,t)},In.unzip=Wo,In.unzipWith=Yo,In.update=function(e,t,n){return null==e?e:ei(e,t,si(n))},In.updateWith=function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:ei(e,t,si(n),r)},In.values=Oa,In.valuesIn=function(e){return null==e?[]:Ot(e,Ea(e))},In.without=Jo,In.words=za,In.wrap=function(e,t){return Rs(si(t),e)},In.xor=$o,In.xorBy=Xo,In.xorWith=Zo,In.zip=Qo,In.zipObject=function(e,t){return ii(e||[],t||[],Hn)},In.zipObjectDeep=function(e,t){return ii(e||[],t||[],Fr)},In.zipWith=es,In.entries=Ta,In.entriesIn=Ia,In.extend=ua,In.extendWith=da,$a(In,In),In.add=sc,In.attempt=Fa,In.camelCase=Aa,In.capitalize=Da,In.ceil=ac,In.clamp=function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=oa(n))==n?n:0),void 0!==t&&(t=(t=oa(t))==t?t:0),Jn(oa(e),t,n)},In.clone=function(e){return $n(e,4)},In.cloneDeep=function(e){return $n(e,5)},In.cloneDeepWith=function(e,t){return $n(e,5,t="function"==typeof t?t:void 0)},In.cloneWith=function(e,t){return $n(e,4,t="function"==typeof t?t:void 0)},In.conformsTo=function(e,t){return null==t||Xn(e,t,ba(t))},In.deburr=Pa,In.defaultTo=function(e,t){return null==e||e!=e?t:e},In.divide=cc,In.endsWith=function(e,t,n){e=aa(e),t=Xr(t);var r=e.length,i=n=void 0===n?r:Jn(ra(n),0,r);return(n-=t.length)>=0&&e.slice(n,i)==t},In.eq=Os,In.escape=function(e){return(e=aa(e))&&N.test(e)?e.replace(L,Lt):e},In.escapeRegExp=function(e){return(e=aa(e))&&V.test(e)?e.replace(K,"\\$&"):e},In.every=function(e,t,n){var r=xs(e)?at:nr;return n&&ao(e,t,n)&&(t=void 0),r(e,$i(t,3))},In.find=os,In.findIndex=Po,In.findKey=function(e,t){return _t(e,$i(t,3),cr)},In.findLast=ss,In.findLastIndex=xo,In.findLastKey=function(e,t){return _t(e,$i(t,3),ur)},In.floor=uc,In.forEach=as,In.forEachRight=cs,In.forIn=function(e,t){return null==e?e:sr(e,$i(t,3),Ea)},In.forInRight=function(e,t){return null==e?e:ar(e,$i(t,3),Ea)},In.forOwn=function(e,t){return e&&cr(e,$i(t,3))},In.forOwnRight=function(e,t){return e&&ur(e,$i(t,3))},In.get=ma,In.gt=As,In.gte=Ds,In.has=function(e,t){return null!=e&&ro(e,t,mr)},In.hasIn=va,In.head=Lo,In.identity=qa,In.includes=function(e,t,n,r){e=Ls(e)?e:Oa(e),n=n&&!r?ra(n):0;var i=e.length;return n<0&&(n=sn(i+n,0)),$s(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&yt(e,t,n)>-1},In.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ra(n);return i<0&&(i=sn(r+i,0)),yt(e,t,i)},In.inRange=function(e,t,n){return t=na(t),void 0===n?(n=t,t=0):n=na(n),function(e,t,n){return e>=an(t,n)&&e<sn(t,n)}(e=oa(e),t,n)},In.invoke=ya,In.isArguments=Ps,In.isArray=xs,In.isArrayBuffer=Ms,In.isArrayLike=Ls,In.isArrayLikeObject=js,In.isBoolean=function(e){return!0===e||!1===e||Ks(e)&&hr(e)==a},In.isBuffer=Ns,In.isDate=Bs,In.isElement=function(e){return Ks(e)&&1===e.nodeType&&!Ws(e)},In.isEmpty=function(e){if(null==e)return!0;if(Ls(e)&&(xs(e)||"string"==typeof e||"function"==typeof e.splice||Ns(e)||Zs(e)||Ps(e)))return!e.length;var t=no(e);if(t==f||t==v)return!e.size;if(fo(e))return!Cr(e).length;for(var n in e)if(Ce.call(e,n))return!1;return!0},In.isEqual=function(e,t){return br(e,t)},In.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===r?br(e,t,void 0,n):!!r},In.isError=Us,In.isFinite=function(e){return"number"==typeof e&&nn(e)},In.isFunction=zs,In.isInteger=Fs,In.isLength=Gs,In.isMap=Vs,In.isMatch=function(e,t){return e===t||Er(e,t,Zi(t))},In.isMatchWith=function(e,t,n){return n="function"==typeof n?n:void 0,Er(e,t,Zi(t),n)},In.isNaN=function(e){return qs(e)&&e!=+e},In.isNative=function(e){if(lo(e))throw new fe("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Sr(e)},In.isNil=function(e){return null==e},In.isNull=function(e){return null===e},In.isNumber=qs,In.isObject=Hs,In.isObjectLike=Ks,In.isPlainObject=Ws,In.isRegExp=Ys,In.isSafeInteger=function(e){return Fs(e)&&e>=-9007199254740991&&e<=9007199254740991},In.isSet=Js,In.isString=$s,In.isSymbol=Xs,In.isTypedArray=Zs,In.isUndefined=function(e){return void 0===e},In.isWeakMap=function(e){return Ks(e)&&no(e)==y},In.isWeakSet=function(e){return Ks(e)&&"[object WeakSet]"==hr(e)},In.join=function(e,t){return null==e?"":rn.call(e,t)},In.kebabCase=xa,In.last=Uo,In.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return void 0!==n&&(i=(i=ra(n))<0?sn(r+i,0):an(i,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,i):gt(e,Et,i,!0)},In.lowerCase=Ma,In.lowerFirst=La,In.lt=Qs,In.lte=ea,In.max=function(e){return e&&e.length?rr(e,qa,pr):void 0},In.maxBy=function(e,t){return e&&e.length?rr(e,$i(t,2),pr):void 0},In.mean=function(e){return St(e,qa)},In.meanBy=function(e,t){return St(e,$i(t,2))},In.min=function(e){return e&&e.length?rr(e,qa,Rr):void 0},In.minBy=function(e,t){return e&&e.length?rr(e,$i(t,2),Rr):void 0},In.stubArray=ic,In.stubFalse=oc,In.stubObject=function(){return{}},In.stubString=function(){return""},In.stubTrue=function(){return!0},In.multiply=lc,In.nth=function(e,t){return e&&e.length?Dr(e,ra(t)):void 0},In.noConflict=function(){return Ve._===this&&(Ve._=Oe),this},In.noop=Xa,In.now=ms,In.pad=function(e,t,n){e=aa(e);var r=(t=ra(t))?Ht(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Pi(Qt(i),n)+e+Pi(Zt(i),n)},In.padEnd=function(e,t,n){e=aa(e);var r=(t=ra(t))?Ht(e):0;return t&&r<t?e+Pi(t-r,n):e},In.padStart=function(e,t,n){e=aa(e);var r=(t=ra(t))?Ht(e):0;return t&&r<t?Pi(t-r,n)+e:e},In.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),un(aa(e).replace(W,""),t||0)},In.random=function(e,t,n){if(n&&"boolean"!=typeof n&&ao(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=na(e),void 0===t?(t=e,e=0):t=na(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=dn();return an(e+i*(t-e+Fe("1e-"+((i+"").length-1))),t)}return jr(e,t)},In.reduce=function(e,t,n){var r=xs(e)?ht:kt,i=arguments.length<3;return r(e,$i(t,4),n,i,er)},In.reduceRight=function(e,t,n){var r=xs(e)?pt:kt,i=arguments.length<3;return r(e,$i(t,4),n,i,tr)},In.repeat=function(e,t,n){return t=(n?ao(e,t,n):void 0===t)?1:ra(t),Nr(aa(e),t)},In.replace=function(){var e=arguments,t=aa(e[0]);return e.length<3?t:t.replace(e[1],e[2])},In.result=function(e,t,n){var r=-1,i=(t=ai(t,e)).length;for(i||(i=1,e=void 0);++r<i;){var o=null==e?void 0:e[Ro(t[r])];void 0===o&&(r=i,o=n),e=zs(o)?o.call(e):o}return e},In.round=fc,In.runInContext=e,In.sample=function(e){return(xs(e)?Un:Ur)(e)},In.size=function(e){if(null==e)return 0;if(Ls(e))return $s(e)?Ht(e):e.length;var t=no(e);return t==f||t==v?e.size:Cr(e).length},In.snakeCase=ja,In.some=function(e,t,n){var r=xs(e)?mt:qr;return n&&ao(e,t,n)&&(t=void 0),r(e,$i(t,3))},In.sortedIndex=function(e,t){return Wr(e,t)},In.sortedIndexBy=function(e,t,n){return Yr(e,t,$i(n,2))},In.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=Wr(e,t);if(r<n&&Os(e[r],t))return r}return-1},In.sortedLastIndex=function(e,t){return Wr(e,t,!0)},In.sortedLastIndexBy=function(e,t,n){return Yr(e,t,$i(n,2),!0)},In.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=Wr(e,t,!0)-1;if(Os(e[n],t))return n}return-1},In.startCase=Na,In.startsWith=function(e,t,n){return e=aa(e),n=null==n?0:Jn(ra(n),0,e.length),t=Xr(t),e.slice(n,n+t.length)==t},In.subtract=hc,In.sum=function(e){return e&&e.length?Rt(e,qa):0},In.sumBy=function(e,t){return e&&e.length?Rt(e,$i(t,2)):0},In.template=function(e,t,n){var r=In.templateSettings;n&&ao(e,t,n)&&(t=void 0),e=aa(e),t=da({},t,r,zi);var i,o,s=da({},t.imports,r.imports,zi),a=ba(s),c=Ot(s,a),u=0,d=t.interpolate||ce,l="__p += '",f=ve((t.escape||ce).source+"|"+d.source+"|"+(d===z?ee:ce).source+"|"+(t.evaluate||ce).source+"|$","g"),h="//# sourceURL="+(Ce.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ne+"]")+"\n";e.replace(f,(function(t,n,r,s,a,c){return r||(r=s),l+=e.slice(u,c).replace(ue,jt),n&&(i=!0,l+="' +\n__e("+n+") +\n'"),a&&(o=!0,l+="';\n"+a+";\n__p += '"),r&&(l+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=c+t.length,t})),l+="';\n";var p=Ce.call(t,"variable")&&t.variable;p||(l="with (obj) {\n"+l+"\n}\n"),l=(o?l.replace(A,""):l).replace(D,"$1").replace(P,"$1;"),l="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+l+"return __p\n}";var m=Fa((function(){return he(a,h+"return "+l).apply(void 0,c)}));if(m.source=l,Us(m))throw m;return m},In.times=function(e,t){if((e=ra(e))<1||e>9007199254740991)return[];var n=4294967295,r=an(e,4294967295);e-=4294967295;for(var i=Tt(r,t=$i(t));++n<e;)t(n);return i},In.toFinite=na,In.toInteger=ra,In.toLength=ia,In.toLower=function(e){return aa(e).toLowerCase()},In.toNumber=oa,In.toSafeInteger=function(e){return e?Jn(ra(e),-9007199254740991,9007199254740991):0===e?e:0},In.toString=aa,In.toUpper=function(e){return aa(e).toUpperCase()},In.trim=function(e,t,n){if((e=aa(e))&&(n||void 0===t))return e.replace(q,"");if(!e||!(t=Xr(t)))return e;var r=Kt(e),i=Kt(t);return ui(r,Dt(r,i),Pt(r,i)+1).join("")},In.trimEnd=function(e,t,n){if((e=aa(e))&&(n||void 0===t))return e.replace(Y,"");if(!e||!(t=Xr(t)))return e;var r=Kt(e);return ui(r,0,Pt(r,Kt(t))+1).join("")},In.trimStart=function(e,t,n){if((e=aa(e))&&(n||void 0===t))return e.replace(W,"");if(!e||!(t=Xr(t)))return e;var r=Kt(e);return ui(r,Dt(r,Kt(t))).join("")},In.truncate=function(e,t){var n=30,r="...";if(Hs(t)){var i="separator"in t?t.separator:i;n="length"in t?ra(t.length):n,r="omission"in t?Xr(t.omission):r}var o=(e=aa(e)).length;if(Nt(e)){var s=Kt(e);o=s.length}if(n>=o)return e;var a=n-Ht(r);if(a<1)return r;var c=s?ui(s,0,a).join(""):e.slice(0,a);if(void 0===i)return c+r;if(s&&(a+=c.length-a),Ys(i)){if(e.slice(a).search(i)){var u,d=c;for(i.global||(i=ve(i.source,aa(te.exec(i))+"g")),i.lastIndex=0;u=i.exec(d);)var l=u.index;c=c.slice(0,void 0===l?a:l)}}else if(e.indexOf(Xr(i),a)!=a){var f=c.lastIndexOf(i);f>-1&&(c=c.slice(0,f))}return c+r},In.unescape=function(e){return(e=aa(e))&&j.test(e)?e.replace(M,Vt):e},In.uniqueId=function(e){var t=++ke;return aa(e)+t},In.upperCase=Ba,In.upperFirst=Ua,In.each=as,In.eachRight=cs,In.first=Lo,$a(In,(dc={},cr(In,(function(e,t){Ce.call(In.prototype,t)||(dc[t]=e)})),dc),{chain:!1}),In.VERSION="4.17.20",ot(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){In[e].placeholder=In})),ot(["drop","take"],(function(e,t){Pn.prototype[e]=function(n){n=void 0===n?1:sn(ra(n),0);var r=this.__filtered__&&!t?new Pn(this):this.clone();return r.__filtered__?r.__takeCount__=an(n,r.__takeCount__):r.__views__.push({size:an(n,4294967295),type:e+(r.__dir__<0?"Right":"")}),r},Pn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),ot(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Pn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:$i(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),ot(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Pn.prototype[e]=function(){return this[n](1).value()[0]}})),ot(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Pn.prototype[e]=function(){return this.__filtered__?new Pn(this):this[n](1)}})),Pn.prototype.compact=function(){return this.filter(qa)},Pn.prototype.find=function(e){return this.filter(e).head()},Pn.prototype.findLast=function(e){return this.reverse().find(e)},Pn.prototype.invokeMap=Br((function(e,t){return"function"==typeof e?new Pn(this):this.map((function(n){return gr(n,e,t)}))})),Pn.prototype.reject=function(e){return this.filter(Cs($i(e)))},Pn.prototype.slice=function(e,t){e=ra(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Pn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=ra(t))<0?n.dropRight(-t):n.take(t-e)),n)},Pn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Pn.prototype.toArray=function(){return this.take(4294967295)},cr(Pn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=In[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);i&&(In.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,a=t instanceof Pn,c=s[0],u=a||xs(t),d=function(e){var t=i.apply(In,ft([e],s));return r&&l?t[0]:t};u&&n&&"function"==typeof c&&1!=c.length&&(a=u=!1);var l=this.__chain__,f=!!this.__actions__.length,h=o&&!l,p=a&&!f;if(!o&&u){t=p?t:new Pn(this);var m=e.apply(t,s);return m.__actions__.push({func:ns,args:[d],thisArg:void 0}),new Dn(m,l)}return h&&p?e.apply(this,s):(m=this.thru(d),h?r?m.value()[0]:m.value():m)})})),ot(["pop","push","shift","sort","splice","unshift"],(function(e){var t=ye[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);In.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(xs(i)?i:[],e)}return this[n]((function(n){return t.apply(xs(n)?n:[],e)}))}})),cr(Pn.prototype,(function(e,t){var n=In[t];if(n){var r=n.name+"";Ce.call(yn,r)||(yn[r]=[]),yn[r].push({name:t,func:n})}})),yn[Ii(void 0,2).name]=[{name:"wrapper",func:void 0}],Pn.prototype.clone=function(){var e=new Pn(this.__wrapped__);return e.__actions__=_i(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=_i(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=_i(this.__views__),e},Pn.prototype.reverse=function(){if(this.__filtered__){var e=new Pn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Pn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=xs(e),r=t<0,i=n?e.length:0,o=function(e,t,n){var r=-1,i=n.length;for(;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=an(t,e+s);break;case"takeRight":e=sn(e,t-s)}}return{start:e,end:t}}(0,i,this.__views__),s=o.start,a=o.end,c=a-s,u=r?a:s-1,d=this.__iteratees__,l=d.length,f=0,h=an(c,this.__takeCount__);if(!n||!r&&i==c&&h==c)return ni(e,this.__actions__);var p=[];e:for(;c--&&f<h;){for(var m=-1,v=e[u+=t];++m<l;){var _=d[m],g=_.iteratee,y=_.type,b=g(v);if(2==y)v=b;else if(!b){if(1==y)continue e;break e}}p[f++]=v}return p},In.prototype.at=rs,In.prototype.chain=function(){return ts(this)},In.prototype.commit=function(){return new Dn(this.value(),this.__chain__)},In.prototype.next=function(){void 0===this.__values__&&(this.__values__=ta(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},In.prototype.plant=function(e){for(var t,n=this;n instanceof An;){var r=Io(n);r.__index__=0,r.__values__=void 0,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},In.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Pn){var t=e;return this.__actions__.length&&(t=new Pn(this)),(t=t.reverse()).__actions__.push({func:ns,args:[Ho],thisArg:void 0}),new Dn(t,this.__chain__)}return this.thru(Ho)},In.prototype.toJSON=In.prototype.valueOf=In.prototype.value=function(){return ni(this.__wrapped__,this.__actions__)},In.prototype.first=In.prototype.head,Ct&&(In.prototype[Ct]=function(){return this}),In}();We?((We.exports=qt)._=qt,qe._=qt):Ve._=qt}).call(x)})),go=L((function(e){var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach((function(e){t[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))})),yo=L((function(e,t){var n=function(e){return String(Number(e))===e?Number(e):e},r=function(e,t,r){var i=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:i&&!t[e.name]&&(t[e.name]={});var o=e.push?{}:i?t[e.name]:t;!function(e,t,r,i){if(i&&!r)t[i]=n(e[1]);else for(var o=0;o<r.length;o+=1)null!=e[o+1]&&(t[r[o]]=n(e[o+1]))}(r.match(e.reg),o,e.names,e.name),e.push&&t[e.push].push(o)},i=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},n=[],o=t;return e.split(/(\r\n|\r|\n)/).filter(i).forEach((function(e){var t=e[0],i=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),o=n[n.length-1]);for(var s=0;s<(go[t]||[]).length;s+=1){var a=go[t][s];if(a.reg.test(i))return r(a,o,i)}})),t.media=n,t};var o=function(e,t){var r=t.split(/=(.+)/,2);return 2===r.length?e[r[0]]=n(r[1]):1===r.length&&t.length>1&&(e[r[0]]=void 0),e};t.parseParams=function(e){return e.split(/;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],r=e.split(" ").map(n),i=0;i<r.length;i+=3)t.push({component:r[i],ip:r[i+1],port:r[i+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(o,{})}))},t.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var t,r=!1;return"~"!==e[0]?t=n(e):(t=n(e.substring(1,e.length)),r=!0),{scid:t,paused:r}}))}))}})),bo=/%[sdv%]/g,Eo=function(e){var t=1,n=arguments,r=n.length;return e.replace(bo,(function(e){if(t>=r)return e;var i=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}}))},So=function(e,t,n){var r=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var i=0;i<t.names.length;i+=1){var o=t.names[i];t.name?r.push(n[t.name][o]):r.push(n[t.names[i]])}else r.push(n[t.name]);return Eo.apply(null,r)},wo=["v","o","s","i","u","e","p","c","b","t","r","z","a"],Co=["i","c","b","a"],ko={write:function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var n=t.outerOrder||wo,r=t.innerOrder||Co,i=[];return n.forEach((function(t){go[t].forEach((function(n){n.name in e&&null!=e[n.name]?i.push(So(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){i.push(So(t,n,e))}))}))})),e.media.forEach((function(e){i.push(So("m",go.m[0],e)),r.forEach((function(t){go[t].forEach((function(n){n.name in e&&null!=e[n.name]?i.push(So(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){i.push(So(t,n,e))}))}))}))})),i.join("\r\n")+"\r\n"},parse:yo.parse,parseParams:yo.parseParams,parseFmtpConfig:yo.parseFmtpConfig,parsePayloads:yo.parsePayloads,parseRemoteCandidates:yo.parseRemoteCandidates,parseImageAttributes:yo.parseImageAttributes,parseSimulcastStreamList:yo.parseSimulcastStreamList},Ro=function(){function e(e){this._pc=e}return e.prototype.analyze=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,i,o,s=this;return c(this,(function(a){switch(a.label){case 0:return e={rtt:-1,audioSent:{bitrate:0,audioLevel:-1,codec:"",packetsLostRate:0,jitter:-1},videoSent:{bitrate:0,framerate:0,codec:"",packetsLostRate:0,frameWidth:0,frameHeight:0,jitter:-1,firCount:-1,pliCount:-1,nackCount:-1},audioReceived:{bitrate:0,audioLevel:-1,codec:"",packetsLostRate:0,jitter:-1,jitterBufferDelay:-1,e2e_delay_ms:-1,stallTimeMs:0,totalStallTimeMs:0,totalPlayDurationMs:0,interval_concealed_samples:-1,interval_samples_received:-1},videoReceived:{bitrate:0,framerate:0,codec:"",packetsLostRate:0,frameWidth:0,frameHeight:0,jitter:-1,jitterBufferDelay:-1,e2e_delay_ms:-1,firCount:-1,pliCount:-1,nackCount:-1,decodeTimePerFrame:-1,stallTimeMs:0,totalStallTimeMs:0,totalPlayDurationMs:0}},[4,this._pc.getStats()];case 1:return(null==(t=a.sent())?void 0:t.forEach)?(n=0,r=0,i=0,o=0,t.forEach((function(a){if("candidate-pair"===a.type&&a.nominated)Bn(a.currentRoundTripTime)&&(e.rtt=Math.round(1e3*a.currentRoundTripTime));else if("remote-inbound-rtp"===a.type)-1===e.rtt&&(e.rtt=Math.round(1e3*a.roundTripTime)),"audio"===a.kind?(n=a.packetsLost,e.audioSent.jitter=a.jitter):"video"===a.kind&&(r=a.packetsLost,e.videoSent.jitter=a.jitter);else if("outbound-rtp"===a.type){if("audio"===a.kind||"audio"===a.mediaType){if(a.mediaSourceId){var c=t.get(a.mediaSourceId);e.audioSent.audioLevel=c.audioLevel}i=a.packetsSent,e.audioSent.codec=s._findCodec(t,a),e.audioSent.bitrate=s._calcBitrate(a)}else if(("video"===a.kind||"video"===a.mediaType)&&(e.videoSent.codec=s._findCodec(t,a),e.videoSent.bitrate=s._calcBitrate(a),e.videoSent.framerate=s._calcFramerate(t,a),e.videoSent.firCount=a.firCount,e.videoSent.pliCount=a.pliCount,e.videoSent.nackCount=a.nackCount,o=a.packetsSent,a.trackId)){var u=t.get(a.trackId);e.videoSent.frameWidth=u.frameWidth,e.videoSent.frameHeight=u.frameHeight}}else if("inbound-rtp"===a.type)if("audio"===a.kind||"audio"===a.mediaType){(null==(u=t.get(a.trackId))?void 0:u.audioLevel)&&(e.audioReceived.audioLevel=null==u?void 0:u.audioLevel),(null==u?void 0:u.jitterBufferDelay)&&(null==u?void 0:u.jitterBufferEmittedCount)&&(e.audioReceived.jitterBufferDelay=(null==u?void 0:u.jitterBufferDelay)/(null==u?void 0:u.jitterBufferEmittedCount)),e.audioSent.codec=s._findCodec(t,a),e.audioReceived.bitrate=s._calcBitrate(a,!1),e.audioReceived.packetsLostRate=s._calcReceivePacketsLostRate(a),e.audioReceived.jitter=a.jitter;var d=s._calcAudioSamples(a),l=d.interval_concealed_samples,f=d.interval_samples_received;e.audioReceived.interval_concealed_samples=l,e.audioReceived.interval_samples_received=f}else if("video"===a.kind||"video"===a.mediaType){e.videoReceived.codec=s._findCodec(t,a),e.videoReceived.bitrate=s._calcBitrate(a,!1),e.videoReceived.framerate=s._calcFramerate(t,a,!1),e.videoReceived.firCount=a.firCount,e.videoReceived.pliCount=a.pliCount,e.videoReceived.nackCount=a.nackCount;var h=a.totalDecodeTime/a.framesDecoded;if(e.videoReceived.decodeTimePerFrame=isNaN(h)?0:h,e.videoReceived.packetsLostRate=s._calcReceivePacketsLostRate(a),a.trackId){u=t.get(a.trackId);e.videoReceived.frameWidth=u.frameWidth,e.videoReceived.frameHeight=u.frameHeight,(null==u?void 0:u.jitterBufferDelay)&&(null==u?void 0:u.jitterBufferEmittedCount)&&(e.videoReceived.jitterBufferDelay=(null==u?void 0:u.jitterBufferDelay)/(null==u?void 0:u.jitterBufferEmittedCount))}e.videoReceived.jitter=a.jitter}})),i&&n&&(e.audioSent.packetsLostRate=+(n/i).toFixed(2)),o&&r&&(e.videoSent.packetsLostRate=+(r/o).toFixed(2)),this._prevStats=t,[2,e]):[2,e]}}))}))},e.prototype._calcBitrate=function(e,t){if(void 0===t&&(t=!0),!this._prevStats||!this._prevStats.has(e.id))return 0;try{var n=t?"bytesSent":"bytesReceived",r=e[n],i=this._prevStats.get(e.id),o=8*(r-i[n])/((e.timestamp-i.timestamp)/1e3);return isNaN(o)?0:Math.round(o)}catch(e){return 0}},e.prototype._calcAudioSamples=function(e){var t=0,n=0;if(!this._prevStats||!this._prevStats.has(e.id))return{interval_concealed_samples:t,interval_samples_received:n};try{var r=this._prevStats.get(e.id);t=e.concealedSamples-r.concealedSamples,n=e.totalSamplesReceived-r.totalSamplesReceived}catch(e){}finally{return{interval_concealed_samples:t,interval_samples_received:n}}},e.prototype._calcFramerate=function(e,t,n){if(void 0===n&&(n=!0),!this._prevStats||!this._prevStats.has(t.id))return 0;try{var r=n?"framesSent":"framesReceived",i=t[r];if(!i)i=e.get(t.trackId)[r];var o=this._prevStats.get(t.id),s=o[r];if(!s)s=this._prevStats.get(t.trackId)[r];var a=(i-s)/((t.timestamp-o.timestamp)/1e3);return isNaN(a)?0:Math.round(a)}catch(e){return 0}},e.prototype._findCodec=function(e,t){var n=t.codecId;return n?e.get(n).mimeType:""},e.prototype._calcReceivePacketsLostRate=function(e){if(!this._prevStats||!this._prevStats.has(e.id))return 0;var t=this._prevStats.get(e.id);return+((e.packetsLost-((null==t?void 0:t.packetsLost)||0))/(e.packetsReceived+e.packetsLost-((null==t?void 0:t.packetsReceived)||0)+((null==t?void 0:t.packetsLost)||0))).toFixed(2)},e}(),To=new tr("Peer");function Io(e){return a(this,void 0,void 0,(function(){return c(this,(function(t){return[2,new Promise((function(t){setTimeout(t,e)}))]}))}))}!function(e){e[e.idle=0]="idle",e[e.connecting=1]="connecting",e[e.connected=2]="connected",e[e.closed=3]="closed"}(ho||(ho={}));var Oo=function(e){function t(t){var n=e.call(this)||this;return n._id=We(),n._dataChannelState=ho.idle,n._messageId=0,n._videoStallCount=-1,n._videoStallDuration=-1,n._emited=0,n.sendMessage=function(e,t,r){return void 0===r&&(r=!1),a(n,void 0,void 0,(function(){var n=this;return c(this,(function(i){return[2,new Promise((function(i,o){n._dataChannel&&n._dataChannelState===ho.connected||o(new Yn(Wn.dataChannelCannotConnect,"datachannel not ready"));var s=n._messageId++,a={ver:1,id:s,dir:Fn,type:Kn,err:Vn,time:Date.now(),app:n._appId,room:n._roomId,from:n._clientId,to:e,msg:t};n._ensureReportMessageNotEmpty(a.to),n._reportDataChannelMessage[a.to].dc_send_total++,n._resolveCallbacks[s]=i,r||(n._rejectCallbacks[s]=o,n._dataChannelRejectTimer[s]=setTimeout((function(){var e=n._rejectCallbacks[s];"function"==typeof e&&(n._reportDataChannelMessage[a.to].dc_send_lost_3++,e(new Yn(Wn.dataChannelTimeout,"timeout")),delete n._rejectCallbacks[s],delete n._resolveCallbacks[s])}),3e3)),n._sendByDataChannel(a)}))]}))}))},n.sendBinaryMessage=function(e,t){return a(n,void 0,void 0,(function(){var n=this;return c(this,(function(r){return[2,new Promise((function(r,i){n._dataChannel&&n._dataChannelState===ho.connected||i(new Yn(Wn.dataChannelCannotConnect,"datachannel not ready"));var o=n._messageId++,s={ver:1,id:o,binary:!0,dir:Fn,type:Kn,err:Vn,time:Date.now(),app:n._appId,room:n._roomId,from:n._clientId,to:e,msg:Un.encodeBase64(qn.ab2string(t))};n._ensureReportMessageNotEmpty(s.to),n._reportDataChannelMessage[s.to].dc_send_total++,n._resolveCallbacks[o]=r,n._sendByDataChannel(s)}))]}))}))},n._createDataChannel=function(){return new Promise((function(e,t){var r=n._pc.createDataChannel("DataChannel",{negotiated:!1});r.binaryType="arraybuffer",n._dataChannelState=ho.connecting,r.onopen=function(){n._dataChannelState=ho.connected,n.emit("@peer/data-channel-open"),e({}),To.debug({event_key:"rtc_data_channel",message:{data_channel_event:"open"}})},r.onclose=function(){n._dataChannelState=ho.closed,n.emit("@peer/data-channel-close"),To.debug({event_key:"rtc_data_channel",message:{data_channel_event:"closed"}})},r.onerror=function(){n._dataChannelState=ho.closed,n.emit("@peer/data-channel-error"),To.debug({event_key:"rtc_data_channel",message:{data_channel_event:"error"}})},r.onmessage=function(e){var t=qn.ab2obj(e.data);switch(t.dir){case Fn:case Hn:To.info(">>>>>>>message from user<<<<<<< %o %s",t,t.msg),"__web__rtc__rtt__"!==t.msg&&((null==t?void 0:t.binary)?(t.msg=qn.str2ab(Un.decodeBase64(t.msg)),n.emit("@peer/binary-message-received",{message:t})):n.emit("@peer/message-received",{message:t})),n._feedbackMessage(_o.cloneDeep(t));break;case Gn:To.info(">>>>>>>message from ack<<<<<<< %o %s",s({},t),t.msg),n._handleFeedback(t)}},n._dataChannel=r}))},n._feedbackMessage=function(e){var t=e.from;n._ensureReportMessageNotEmpty(t),n._reportDataChannelMessage[t].dc_recv_total++,e.dir=Gn,e.msg="",n._sendByDataChannel(e)},To.info("constructor()"),n._senders=[],n._direction=t,n._tracks={},n._getPropsFromStore(),De.subscribe((function(){return n._getPropsFromStore()})),n._resolveCallbacks={},n._rejectCallbacks={},n._dataChannelRTT=0,n._dataChannelRejectTimer={},n._reportDataChannelMessage={},n}return o(t,e),t.prototype._getPropsFromStore=function(){var e=De.getState(),t=e.appId,n=e.roomId,r=e.clientId,i=e.needCreateDataChannel;this._appId=t,this._roomId=n,this._clientId=r,this._needCreateDataChannel=i},t.prototype.init=function(){var e=this;return To.info("init()"),this._pc=new RTCPeerConnection,this._handle(),this._needCreateDataChannel&&this._createDataChannel().then((function(){e._clientId!==e._streamClientId&&e._getChannelRTT()})),this._pc},t.prototype.recordVideoStall=function(e,t){this._videoStallCount=e,this._videoStallDuration=t},t.prototype.destroy=function(){var e;To.info("destroy()"),this.emit("@peer/destroy"),this.removeAllListeners(),"connected"===(null===(e=this._pc)||void 0===e?void 0:e.connectionState)&&this._pc.close()},t.prototype.addStream=function(e){var t,n=this;this._pc?(null==e?void 0:e.id)!==(null===(t=this._stream)||void 0===t?void 0:t.id)&&(this._stream=e,this._stream.getTracks().forEach((function(e){var t=n._pc.addTrack(e,n._stream);n._senders.push(t),n._tracks[e.kind]={id:e.id,muted:e.muted}}))):To.error("addStream() error 请先init后再调用addStream")},t.prototype.replaceTrack=function(e){return a(this,void 0,void 0,(function(){var t,n;return c(this,(function(r){return this._pc?(t=this._pc.getSenders(),(n=t.find((function(t){var n;return(null===(n=t.track)||void 0===n?void 0:n.kind)===e.kind})))&&n.replaceTrack(e),[2]):[2,!1]}))}))},t.prototype.removeStream=function(){var e=this;To.info("removeStream()");try{this._senders.forEach((function(t){e._pc.removeTrack(t)}))}catch(e){}this._senders=[],this._tracks={}},t.prototype.close=function(){"connected"===this._pc.connectionState&&(To.info("close()"),this._pc.close())},t.prototype.createOffer=function(){return a(this,void 0,void 0,(function(){var e,t,n,r;return c(this,(function(i){switch(i.label){case 0:return To.debug({message:"createOffer()",event_key:"rtc_begin_create_offer",direction:this._direction,stream_id:this._serverStreamId,pc_session_id:qn.getSessionId()}),e={offerToReceiveVideo:!0,offerToReceiveAudio:!0},[4,this._pc.createOffer(e)];case 1:return t=i.sent(),(n=ko.parse(t.sdp)).media&&(n.media=n.media.map((function(e){return"audio"===e.type&&Array.isArray(e.fmtp)&&(e.fmtp=e.fmtp.map((function(e){return"minptime=10;useinbandfec=1"===(null==e?void 0:e.config)&&(e.config="a=fmtp:111 minptime=10;useinbandfec=1;stereo=1"),e}))),e}))),r=ko.write(n),this._offer=new RTCSessionDescription({type:"offer",sdp:r}),To.debug({message:this._offer,event_key:"rtc_create_offer",direction:this._direction,stream_id:this._serverStreamId,pc_session_id:qn.getSessionId()}),this._pc.setLocalDescription(this._offer),To.debug({message:"setLocalDescription()",event_key:"rtc_set_description",direction:this._direction,stream_id:this._serverStreamId,pc_session_id:qn.getSessionId()}),[2,{sdp:null==t?void 0:t.sdp,type:"offer"}]}}))}))},t.prototype.setAnswer=function(e){return a(this,void 0,void 0,(function(){var t,n;return c(this,(function(r){switch(r.label){case 0:To.debug({message:"setLocalDescription()",event_key:"rtc_set_description",direction:this._direction,stream_id:this._serverStreamId,pc_session_id:qn.getSessionId()}),(t=ko.parse(e.sdp)).media&&(t.media=t.media.map((function(e){return"audio"===e.type&&Array.isArray(e.fmtp)&&(e.fmtp=e.fmtp.map((function(e){return"minptime=10;useinbandfec=1"===(null==e?void 0:e.config)&&(e.config="a=fmtp:111 minptime=10;useinbandfec=1;stereo=1"),e}))),e}))),this._answer=new RTCSessionDescription({sdp:ko.write(t),type:e.type}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._pc.setRemoteDescription(this._answer)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),To.error("setAnswer() error: %o",n),this.emit("@peer/error","setAnswerFailed",{clientId:this._streamClientId,streamId:this._stream.id}),[3,4];case 4:return[2]}}))}))},t.prototype._getChannelRTT=function(){return a(this,void 0,void 0,(function(){var e,t=this;return c(this,(function(n){return this._dataChannel&&this._dataChannelState===ho.connected?(e=Date.now(),this.sendMessage(this._streamClientId,"__web__rtc__rtt__").then((function(){return a(t,void 0,void 0,(function(){var t;return c(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._dataChannelRTT=(t-e)/1e3,To.info("_dataChannelRTT: ",this.streamClientId,this._dataChannelRTT),[4,Io(2e3)];case 1:return n.sent(),this._getChannelRTT(),[2]}}))}))})).catch((function(e){return a(t,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return this._dataChannelRTT=0,To.error("_dataChannelRTT: error",e),[4,Io(2e3)];case 1:return t.sent(),this._getChannelRTT(),[2]}}))}))})),[2]):[2]}))}))},t.prototype.getStats=function(e){return a(this,void 0,void 0,(function(){var t=this;return c(this,(function(n){return this._statsAnalyzer||(this._statsAnalyzer=new Ro(this._pc)),[2,new Promise((function(n){return a(t,void 0,void 0,(function(){var t,r,i,o,a,u,d,l,f,h,p,m,v,_,g,y,b;return c(this,(function(c){switch(c.label){case 0:return e&&this._prevStats?[2,n(this._prevStats)]:[4,this._statsAnalyzer.analyze()];case 1:if(t=c.sent(),r=this.localStreamId||this.serverStreamId,i={},o={},!t)return n({clientId:this._streamClientId,streamId:r,audio:i,video:o}),[2];if(a=t.rtt,u=t.audioSent,d=t.audioReceived,l=t.videoSent,f=t.videoReceived,d.e2e_delay_ms=1e3*(d.jitterBufferDelay+this._dataChannelRTT),f.e2e_delay_ms=1e3*(f.jitterBufferDelay+this._dataChannelRTT+f.decodeTimePerFrame),"up"===this._direction?(i=s({Type:"audio",Direction:"up",rtt:a},u),o=s({Type:"video",Direction:"up",rtt:a},l)):(i=s({Type:"audio",Direction:"down",rtt:a},d),o=s({Type:"video",Direction:"down",rtt:a},f)),To.debug({message:"",event_key:"rtc_media_statistics",stream_user_id:this._streamClientId,pc_session_id:qn.getSessionId(),stream_id:this.serverStreamId,media_type:"audio",direction:this._direction,peer_connection_id:this._id,is_screen:0,bandwidth:i.bitrate,audio_bitrate:i.bitrate,audio_level:i.audioLevel,codec:i.codec,packets_lost_rate:i.packetsLostRate,jitter:i.jitter,interval_concealed_samples:i.interval_concealed_samples,interval_samples_received:i.interval_samples_received,web_e2e_delay:parseInt(i.e2e_delay_ms),jitterBufferDelay:i.jitterBufferDelay,total_rtt_ms:1e3*this._dataChannelRTT},!1),o.stallCount=this._videoStallCount,o.stallDuration=this._videoStallDuration,To.debug({message:"",event_key:"rtc_media_statistics",stream_user_id:this._streamClientId,pc_session_id:qn.getSessionId(),stream_id:this.serverStreamId,media_type:"video",direction:this._direction,peer_connection_id:this._id,is_screen:(null===(b=this._constraints)||void 0===b?void 0:b.screen)?1:0,bandwidth:o.bitrate,video_bitrate:o.bitrate,frame_rate:o.framerate,codec:o.codec,packets_lost_rate:o.packetsLostRate,frame_width:o.frameWidth,frame_height:o.frameHeight,jitter:o.jitter,fir_count:o.firCount,pli_count:o.pliCount,nackCount:o.nackCount,stall_count:o.stallCount,stall_duration:o.stallDuration,web_e2e_delay:parseInt(o.e2e_delay_ms),jitterBufferDelay:o.jitterBufferDelay,total_rtt_ms:1e3*this._dataChannelRTT},!1),Object.keys(this._reportDataChannelMessage).length)for(h=[],p=0,m=Object.entries(this._reportDataChannelMessage);p<m.length;p++)v=m[p],_=v[0],g=v[1],h.push(s({dc_peer_user_id:_,dc_type:"user"},g)),To.debug({message:"",event_key:"rtc_message_statistics",dc_user_message:h});return y={clientId:this._streamClientId,streamId:r,audio:i,video:o},this._prevStats=y,n(y),[2]}}))}))}))]}))}))},t.prototype._ensureReportMessageNotEmpty=function(e){this._reportDataChannelMessage[e]||(this._reportDataChannelMessage[e]={dc_send_total:0,dc_send_lost_3:0,dc_recv_total:0,dc_send_ack:0})},t.prototype._sendByDataChannel=function(e){this._dataChannel.send(qn.str2ab(JSON.stringify(e)))},t.prototype._handleFeedback=function(e){var t=e.id;switch(e.err){case Vn:var n=this._resolveCallbacks[t];"function"==typeof n&&(clearTimeout(this._dataChannelRejectTimer[t]),this._ensureReportMessageNotEmpty(e.to),this._reportDataChannelMessage[e.to].dc_send_ack++,n(e),delete this._resolveCallbacks[t]);break;default:var r=this._rejectCallbacks[t];"function"==typeof r&&(clearTimeout(this._dataChannelRejectTimer[t]),r(e),delete this._rejectCallbacks[t])}},t.prototype._handle=function(){var e=this;this._pc.ontrack=function(t){var n;if(null===(n=null==t?void 0:t.streams)||void 0===n?void 0:n.length){var r=t.streams[0];"down"===e._direction&&e.addStream(r),e._emited++,2===e._emited&&e.emit("@peer/receiveStream",{stream:r,pc:e._pc})}else To.error("ontrack() 触发了事件，竟然没有携带stream")},this._pc.oniceconnectionstatechange=function(t){To.debug({message:e._pc.iceConnectionState,event_key:"rtc_ice_change"});var n=e._pc.iceConnectionState;"failed"!==n&&"closed"!==n||(e.emit("@peer/waiting4reconnection",e),e.emit("@peer/error","iceFailed",{clientId:e._streamClientId,streamId:e._stream.id}))},this._pc.onconnectionstatechange=function(t){To.info("connectionstatechange",e._pc.connectionState);var n=e._pc.connectionState;"failed"!==n&&"closed"!==n||(e.emit("@peer/waiting4reconnection",e),e.emit("@peer/error","connectionFailed",{clientId:e._streamClientId,streamId:e._stream.id}))},this._pc.onsignalingstatechange=function(e){To.info("onsignalingstatechange",e)},this._pc.onicegatheringstatechange=function(e){To.info("icegatheringstatechange",e)}},Object.defineProperty(t.prototype,"constraints",{get:function(){return this._constraints},set:function(e){this._constraints=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localStreamId",{get:function(){return this._localStreamId},set:function(e){this._localStreamId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverStreamId",{get:function(){return this._serverStreamId},set:function(e){this._serverStreamId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"streamClientId",{get:function(){return this._streamClientId},set:function(e){this._streamClientId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stream",{get:function(){return this._stream},set:function(e){this._stream=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screen",{get:function(){var e;return!!(null===(e=this._constraints)||void 0===e?void 0:e.screen)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this._direction},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pc",{get:function(){return this._pc},enumerable:!1,configurable:!0}),t}(ir),Ao=new tr("Room"),Do="DISCONNECTED",Po="CONNECTING",xo="CONNECTED",Mo={deleteProperty:function(e,t){try{if(e[t])return e[t].destroy(),delete e[t],!0}catch(e){}return!0}},Lo=function(e){function t(t){var n=e.call(this)||this;return n._wainting4reconnectPeers=[],n.subscribe=n._subscribe,Ao.info("constructor() %o",t),n._name="Room",n._destroy(),n._getPropsFromStore(),De.subscribe((function(){return n._getPropsFromStore()})),n}return o(t,e),t.prototype._getPropsFromStore=function(){var e=De.getState(),t=e.appId,n=e.roomId,r=e.clientId,i=e.autoSubscribe;this._appId=t,this._roomId=n,this._clientId=r,this._autoSubscribe=i},t.prototype.init=function(){Ao.info("init"),this._socket=new vo({}),this._handleSocket()},t.prototype._destroy=function(){var e;if(null===(e=this._socket)||void 0===e||e._disconnect(),this._localPeers)for(var t=0,n=Object.keys(this._localPeers);t<n.length;t++){var r=n[t];delete this._localPeers[r]}else this._localPeers=new Proxy({},Mo);if(this._remotePeers)for(var i=0,o=Object.keys(this._remotePeers);i<o.length;i++){r=o[i];delete this._remotePeers[r]}else this._remotePeers=new Proxy({},Mo);this._serverLocalMapping={},this._remoteUsers={},this._state=Do,this.removeAllListeners()},t.prototype.join=function(){return a(this,void 0,void 0,(function(){var e;return c(this,(function(t){switch(t.label){case 0:return this._state=Po,Ao.info("socket--- %o",this._socket),[4,this._socket.join()];case 1:if(e=t.sent(),Ao.info("join joinRet: %o",e),200!==(null==e?void 0:e.code))throw this._state=Do,new Yn(null==e?void 0:e.code,null==e?void 0:e.message);return this._state=xo,this._clientId=null==e?void 0:e.clientId,this._handleExistStreams(e),Qn.inRoom=!0,[2,e]}}))}))},t.prototype.leave=function(e){return void 0===e&&(e=!1),a(this,void 0,void 0,(function(){var t;return c(this,(function(n){switch(n.label){case 0:return[4,this._socket.leave(e)];case 1:return t=n.sent(),Ao.info("leave() ret: %o",t),200===(null==t?void 0:t.code)&&(this._destroy(),Qn.inRoom=!1),[2,t]}}))}))},t.prototype.publish=function(e,t){return void 0===t&&(t={}),a(this,void 0,void 0,(function(){var n,r,i,o,s,a,u=this;return c(this,(function(c){switch(c.label){case 0:if(this._state!==xo)throw Ao.warn("publish() 加入房间才可以推流"),new Error("Join the room to push the stream");if(this._localPeers[e.id])throw Ao.warn("publish() 该流已在推送中"),new Error("Sream is under publishing");return n=new Oo("up"),this._handlePeer(n),n.init(),n.addStream(e),[4,n.createOffer()];case 1:r=c.sent(),n.streamClientId=this._clientId,n.localStreamId=e.id,n.constraints=t,i=[];try{e.getVideoTracks().length&&(o=e.getVideoTracks()[0],s=o.getSettings(),i.push({width:(null==s?void 0:s.width)||1280,height:(null==s?void 0:s.height)||720,framerate:(null==s?void 0:s.frameRate)?Math.round(null==s?void 0:s.frameRate):25,maxkbps:(null==t?void 0:t.maxkbps)||1400}))}catch(e){}return a={currentStreamId:e.id,eventSessionId:qn.getSessionId(),initStreamId:e.id,pc_session_id:qn.getSessionId(),sdpInfo:r,screen:null==t?void 0:t.screen,audio:null==t?void 0:t.audio,video:null==t?void 0:t.video,state:"relay",attributes:{audiostream:!0,localaudio:!0,videostream:!0,localvideo:!0,videoDescriptions:i}},[2,this._socket.sendMessage("publish",a).then((function(t){Ao.info("publish ret %o",t),u._localPeers[e.id]=n,u._serverLocalMapping[t.streamId]=e.id}))]}}))}))},t.prototype.unsubscribe=function(e){return a(this,void 0,void 0,(function(){var t=this;return c(this,(function(n){if(!this._remotePeers[e])throw new Yn(Wn.invalidParameter,"Stream not subscribed");return[2,this._socket.sendMessage("unsubscribe",{roomId:this._roomId,streamId:e,video:!0,audio:!0}).then((function(n){return 200===(null==n?void 0:n.code)&&delete t._remotePeers[e],n}))]}))}))},t.prototype.replaceTrack=function(e,t){return a(this,void 0,void 0,(function(){var n;return c(this,(function(r){return(n=this._localPeers[e.id])?[2,n.replaceTrack(t)]:[2,!1]}))}))},t.prototype.unpublish=function(e){return a(this,void 0,void 0,(function(){var t,n,r;return c(this,(function(i){if(!(t=this._localPeers[e.id]))throw Ao.warn("unpublish() 传入的流未在推流"),new Error("Stream not in release");return n=t.serverStreamId,r={roomId:this._roomId,initStreamId:e.id,streamId:n,eventSessionId:qn.getSessionId()},[2,this._socket.sendMessage("unpublish",r).then((function(e){Ao.info("unpublish() %o",e),Ao.info("delete peer: 11111")}))]}))}))},t.prototype.startLiveStreaming=function(e){return a(this,void 0,void 0,(function(){return c(this,(function(t){return this._transcodeConstraints=e,[2,this._socket.sendMessage("controlMessage",e)]}))}))},t.prototype.stopLiveStreaming=function(){return a(this,void 0,void 0,(function(){return c(this,(function(e){return this._transcodeConstraints=null,[2,this._socket.sendMessage("controlMessage",{type:"transcode",action:"stopped"})]}))}))},t.prototype.getStats=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,i;return c(this,(function(o){for(e=s(s({},this._localPeers),this._remotePeers),t=[],n=0,r=Object.values(e);n<r.length;n++)i=r[n],t.push(i.getStats());return[2,Promise.all(t).then((function(e){var t=[];return e.forEach((function(e){var n=t.find((function(t){return t.clientId===e.clientId}));n?n.stats.push(e):t.push({clientId:e.clientId,stats:[e]})})),t}))]}))}))},t.prototype.sendCustomMessage=function(e){return a(this,void 0,void 0,(function(){return c(this,(function(t){return[2,this._socket.sendMessage("customMessage",s({roomId:this._roomId},e))]}))}))},t.prototype._clearWainting4reconnectPeers=function(){for(;this._wainting4reconnectPeers.length;){var e=this._wainting4reconnectPeers.shift();Ao.info("需要重新发送的peer %o",e),"down"===e.direction?this._subscribe({clientId:e.streamClientId,streamId:e.serverStreamId,screen:e.screen}):(this.publish(e.stream,e.constraints),this._transcodeConstraints&&this.startLiveStreaming(this._transcodeConstraints))}},t.prototype._handleSocket=function(){var e=this;this._socket.on("@socket/events",(function(t,n){e.emit("@room/socket/events",{code:Wn[t]||Wn.unknown,message:t,data:n})})),this._socket.on("@socket/signalingMessageRelay",(function(t){var n;if(void 0===t&&(t={}),"answer"===(null===(n=null==t?void 0:t.message)||void 0===n?void 0:n.type))if(Ao.debug({message:t.message,event_key:"rtc_revc_answer",direction:(null==t?void 0:t.peerStreamId)?"down":"up",stream_id:(null==t?void 0:t.peerStreamId)||(null==t?void 0:t.streamId)}),null==t?void 0:t.peerStreamId){var r=e._remotePeers[t.peerStreamId];r&&r.setAnswer(t.message)}else{var i=null==t?void 0:t.streamId,o=e._serverLocalMapping[i];if(o){var s=e._localPeers[o];s.serverStreamId=i,s.setAnswer(t.message)}}})),this._socket.on("@socket/onAddStream",(function(t){void 0===t&&(t={});var n=t.clientId;if(n!==e._clientId)e._remotePeers[t.streamId]||(e._autoSubscribe&&e._subscribe(t),e.emit("@room/stream-added",t));else{var r=t.initStreamId,i=e._localPeers[r];e.emit("@room/stream-published",{pc:i,clientId:n,stream:e._localPeers[r].stream,screen:e._localPeers[r].screen})}})),this._socket.on("@socket/onRemoveStream",(function(t){void 0===t&&(t={});var n,r=t.streamId,i=t.clientId;if(e._clientId===i){Ao.info("delete peer: 22222");var o=e._serverLocalMapping[r];n=e._localPeers[o],delete e._serverLocalMapping[r],delete e._localPeers[o]}else n=e._remotePeers[r],delete e._remotePeers[r];n?e.emit("@room/onRemoveStream",{clientId:n.streamClientId,screen:n.screen,stream:n.stream,pc:n}):Ao.error("removedPeer is undefined",e._serverLocalMapping,r)})),this._socket.on("@socket/userConnection",(function(t){void 0===t&&(t={}),(null==t?void 0:t.clientId)&&(e._remoteUsers[null==t?void 0:t.clientId]=t,e.emit("@room/userConnection",{clientId:null==t?void 0:t.clientId}))})),this._socket.on("@socket/userDisconnection",(function(t){void 0===t&&(t={}),(null==t?void 0:t.clientId)&&(delete e._remoteUsers[null==t?void 0:t.clientId],e.emit("@room/userDisconnection",{clientId:null==t?void 0:t.clientId}))})),this._socket.on("@socket/onCustomMessage",(function(t){void 0===t&&(t={}),e.emit("@room/onCustomMessage",t)})),this._socket.on("@socket/postProcessingMessage",(function(t){void 0===t&&(t={}),e.emit("@room/postProcessingMessage",t)})),this._socket.on("@socket/streamFailed",(function(t){var n,r=null===(n=null==t?void 0:t.message)||void 0===n?void 0:n.code;if(r<400||r>=500){var i=null==t?void 0:t.streamId;if("publish"===(null==t?void 0:t.type)){var o=e._serverLocalMapping[i],s=e._localPeers[o];return Ao.info("streamFailed peer: %o",s),void(s?(delete e._localPeers[o],e.publish(s.stream,s.constraints)):e._clearWainting4reconnectPeers())}if("subscribe"===(null==t?void 0:t.type))return void((s=e._remotePeers[i])?(delete e._remotePeers[i],e._subscribe({clientId:s.streamClientId,streamId:i,screen:s.screen})):e._clearWainting4reconnectPeers())}else e.emit("@room/error",{code:Wn.streamFailed,message:"streamFailed",data:t})})),this._socket.on("@socket/reconnectedSuccess",(function(){e._clearWainting4reconnectPeers()}))},t.prototype._subscribe=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i;return c(this,(function(o){switch(o.label){case 0:return(t=new Oo("down")).init(),t.streamClientId=e.clientId,t.serverStreamId=e.streamId,this._handlePeer(t),n=new MediaStream,this._remotePeers[e.streamId]=t,t.constraints={screen:e.screen},t.addStream(n),[4,t.createOffer()];case 1:return r=o.sent(),i={audio:!0,video:!0,browser:"chrome-stable",streamId:e.streamId,streamUserId:e.clientId,eventSessionId:qn.getSessionId(),pc_session_id:qn.getSessionId(),sdpInfo:r,config:{enableMediaType:{video:!0,audio:!0},qualityLayer:{spatialLayer:1,temporalLayer:1}}},[2,this._socket.sendMessage("subscribe",i).then((function(e){return Ao.info("subscribe ret %o",e),e}))]}}))}))},t.prototype.updateSubscribe=function(e,t){return a(this,void 0,void 0,(function(){return c(this,(function(n){return[2,this._socket.sendMessage("updateSubscribe",{roomId:this._roomId,streamList:[e],config:{enableMediaType:t}})]}))}))},t.prototype._handlePeer=function(e){var t=this;e.on("@peer/receiveStream",(function(e){var n=e.stream;Ao.info("@peer/receiveStream %o",n);var r=t._remotePeers[n.id]||{},i={};(null==r?void 0:r.streamClientId)&&((i=t._remoteUsers[r.streamClientId]||{}).screen=r.screen,t.emit("@room/receiveStream",s(s({},i),{stream:n,peer:r})))})),e.on("@peer/waiting4reconnection",(function(e){Ao.info("@peer/waiting4reconnection peer: %o",e),t._wainting4reconnectPeers.push(e),"down"===e.direction?delete t._remotePeers[e.serverStreamId]:delete t._localPeers[e.localStreamId]})),e.on("@peer/error",(function(e,n){t.emit("@room/error",{code:Wn[e]||Wn.unknown,message:e,data:n})}))},t.prototype._handleExistStreams=function(e){var t,n,r=this;Ao.info("_handleExistStreams() %o",e),null===(t=null==e?void 0:e.streams)||void 0===t||t.forEach((function(e){e.clientId!==r._clientId&&(r._autoSubscribe&&r._subscribe(e),r.emit("@room/stream-added",e))})),null===(n=null==e?void 0:e.clients)||void 0===n||n.forEach((function(e){e===r._clientId||r._remoteUsers[e]||(r._remoteUsers[e]={clientId:e},r.emit("@room/userConnection",{clientId:e}))}))},Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remoteUsers",{get:function(){return this._remoteUsers},enumerable:!1,configurable:!0}),t}(ir),jo=new tr("Stream"),No=function(e){function t(t){var n=t.stream,r=t.clientId,i=t.screen,o=t.peer,s=(t.dataChannel,e.call(this)||this);return s._videoLastPlayTime=0,s._totalStallTime=0,s._frameRecords=[],s._totalPlayDurationMs=0,s.play=function(e,t){if(void 0===t&&(t={}),jo.debug({event_key:"rtc_sdk_api_call",message:t,sdk_api_name:"play"}),"string"==typeof e){var n=document.getElementById(e);if(n){var r=n.querySelector("video");r||(r=document.createElement("video"));var i=n.querySelector("audio");i||(i=document.createElement("audio")),r.setAttribute("playsinline",""),r.setAttribute("webkit-playsinline",""),r.setAttribute("x5-playsinline",""),r.setAttribute("x5-video-player-type","h5"),r.setAttribute("x-webkit-airplay","allow"),r.setAttribute("preload",""),r.setAttribute("muted",""),r.muted=!0,r.playsInline=!0,r.style.width="100%",r.style.height="100%",r.controls=!1,r.setAttribute("muted",""),r.muted=!0,i.style.display="none",i.setAttribute("playsinline",""),i.setAttribute("webkit-playsinline","");var o=new MediaStream,a=new MediaStream;s._stream.getTracks().forEach((function(e){"audio"===e.kind?o.addTrack(e):"video"===e.kind&&a.addTrack(e)})),i.srcObject=o,r.srcObject=a;for(var c=0,u=Object.entries(t);c<u.length;c++){var d=u[c],l=d[0],f=d[1];if("sinkId"!==l||"function"!=typeof(null==r?void 0:r.setSinkId)){if("styles"===l&&f&&"object"===Bn(f))for(var h=0,p=Object.entries(f);h<p.length;h++){var m=p[h],v=m[0],_=m[1];r.style[v]=_}"muted"===l&&!0===f&&(i.setAttribute("muted",""),i.muted=!0),r.setAttribute(l,f)}else r.setSinkId(f)}s._audio=i,s._video=r,s._handle(),n.appendChild(i),n.appendChild(r);var g=i.play();"function"==typeof g.then&&g.then((function(){jo.debug({event_key:"rtc_invoke_status",message:"audio play success",error_code:0})})).catch((function(e){jo.debug({event_key:"rtc_invoke_status",message:"audio play success",error_code:1})}));var y=r.play();return"function"==typeof y.then&&y.then((function(){jo.debug({event_key:"rtc_invoke_status",message:"video play success",error_code:0})})).catch((function(e){jo.debug({event_key:"rtc_invoke_status",message:"video play success",error_code:1})})),s._peer&&(s._videoStallTimer=setInterval((function(){var e;try{var t=s._processStallTime(),n=t.stallCount,r=t.stallDuration;null===(e=s._peer)||void 0===e||e.recordVideoStall(n,r)}catch(e){}finally{s._frameRecords=[]}}),2e3)),y}jo.error("根据所传id没有获取到元素")}else jo.error("id: string参数格式不正确")},s.getId=function(){return s._stream.id},s.hasScreen=function(){return s._screen},s.muteAudio=function(){return jo.debug({event_key:"rtc_sdk_api_call",message:"",sdk_api_name:"muteAudio"}),!!s._audio&&(s._audio.setAttribute("muted",""),s._audio.muted=!0,!0)},s.unmuteAudio=function(){return jo.debug({event_key:"rtc_sdk_api_call",message:"",sdk_api_name:"unmuteAudio"}),!!s._audio&&(s._audio.removeAttribute("muted"),s._audio.muted=!1,s._audio.play())},s.muteVideo=function(){var e,t;if(jo.debug({event_key:"rtc_sdk_api_call",message:"",sdk_api_name:"muteVideo"}),!s._video)return!1;try{var n=null===(t=null===(e=s._video.srcObject)||void 0===e?void 0:e.getVideoTracks())||void 0===t?void 0:t[0];n&&(n.enabled=!1)}catch(e){}return!0},s.unmuteVideo=function(){var e,t;if(jo.debug({event_key:"rtc_sdk_api_call",message:"",sdk_api_name:"unmuteVideo"}),!s._video)return!1;try{var n=null===(t=null===(e=s._video.srcObject)||void 0===e?void 0:e.getVideoTracks())||void 0===t?void 0:t[0];n&&(n.enabled=!0)}catch(e){}return!0},s.sendMessage=function(e,t){return a(s,void 0,void 0,(function(){return c(this,(function(n){if(!e)throw new Yn(Wn.invalidParameter,"uid is required");if(this._peer)return[2,this._peer.sendMessage(e,t)];throw new Yn(Wn.dataChannelCannotConnect,"dataChannel cannot useed")}))}))},s.sendBinaryMessage=function(e,t){return a(s,void 0,void 0,(function(){return c(this,(function(n){if(!e)throw new Yn(Wn.invalidParameter,"uid is required");if(this._peer)return[2,this._peer.sendBinaryMessage(e,t)];throw new Yn(Wn.dataChannelCannotConnect,"dataChannel cannot used")}))}))},s.getStats=function(){return a(s,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return this._peer&&this._peer.pc?[4,this._peer.getStats(!0)]:[2,{}];case 1:return[2,e.sent()]}}))}))},s._handle=function(){s._video.addEventListener("timeupdate",s._handleFirstFrame,{once:!0}),s._video.addEventListener("timeupdate",s._handleVideoTimeupdate)},s._handleFirstFrame=function(){s.emit("first-remote-video-render")},s._handleVideoTimeupdate=function(){var e=s._video.currentTime;if(0!==e)if(e<=s._videoLastPlayTime)s._videoLastPlayTime=e;else{var t=e-s._videoLastPlayTime;s._totalPlayDurationMs+=Math.floor(1e3*t),s._videoLastPlayTime=e;var n={playTime:e,isStall:t>.5,stallCount:t>.5?1:0,stallDuration:Math.floor(1e3*t)};s._frameRecords.push(n)}},s._processStallTime=function(){var e=0,t=0;return s._frameRecords.forEach((function(n){n.isStall&&(e++,t+=n.stallDuration)})),{stallCount:e,stallDuration:t}},s._handlePeer=function(e){e.on("@peer/destroy",(function(){clearInterval(s._videoStallTimer)})),["@peer/data-channel-open","@peer/data-channel-close","@peer/data-channel-error","@peer/message-received","@peer/binary-message-received"].forEach((function(t){e.on(t,(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];jo.info(t,e),s.emit.apply(s,u([t.replace("@peer/","")],e))}))}))},s._stream=n,s._clientId=r,s._screen=i,s._peer=o,o&&s._handlePeer(o),s}return o(t,e),t.prototype.replay=function(){if(!this._video)return Promise.reject();var e=this._audio.play();"function"==typeof e.then&&e.then((function(){jo.debug({event_key:"rtc_invoke_status",message:"audio play success",error_code:0})})).catch((function(e){jo.debug({event_key:"rtc_invoke_status",message:"audio play success",error_code:1})}));var t=this._video.play();return"function"==typeof t.then&&t.then((function(){jo.debug({event_key:"rtc_invoke_status",message:"video play success",error_code:0})})).catch((function(e){jo.debug({event_key:"rtc_invoke_status",message:"video play success",error_code:1})})),t},Object.defineProperty(t.prototype,"clientId",{get:function(){return this._clientId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stream",{get:function(){return this._stream},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uid",{get:function(){return this._clientId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"video",{get:function(){return this._video?this._video:(jo.warn("请先调用stream.play()"),null)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"audio",{get:function(){return this._audio?this._audio:(jo.warn("请先调用stream.play()"),null)},enumerable:!1,configurable:!0}),t}(ir),Bo=new tr("Client"),Uo=function(e){function t(t){var n=e.call(this)||this;n._statsInterval=2e3,n._autoSubscribe=!0;var r=t.statsInterval,i=t.dataChannel,o=void 0!==i&&i,s=t.autoSubscribe,a=void 0===s||s,c=t._mediaServerAddr,u=t._signalServerHost,d=t.configServer;return d?"string"==typeof d&&(d=[d]):d=Xn,n._name="Client",n._configServer=d,n._autoSubscribe=a,n._needCreateDataChannel=o,"number"==typeof r&&r>=1e3&&(n._statsInterval=r),De.dispatch({type:Ie,payload:{configServer:d,needCreateDataChannel:o,autoSubscribe:a,_mediaServerAddr:c,_signalServerHost:u}}),n}return o(t,e),t.prototype.init=function(){return Bo.info("init()"),this._room=new Lo({}),this._room.init(),this._handleRoom(),this._handleNetwork(),this},t.prototype.join=function(e,t,n,r){return a(this,void 0,void 0,(function(){var i,o;return c(this,(function(s){switch(s.label){case 0:if(!e||!t||!n)throw Bo.error("appId roomId userId 为必传参数"),new Yn(Wn.invalidParameter,"appId、roomId、userId 是必传参数");if(this._room&&this._room.state===Po)throw new Yn(Wn.connectingRoom,"房间正在连接中");if(this._room&&this._room.state===xo)throw new Yn(Wn.inRoom,"已经加入房间");Bo.debug({message:{appId:e,roomId:t,userId:n,token:r},event_key:"rtc_sdk_api_call",sdk_api_name:"join"}),De.dispatch({type:Oe,payload:{appId:e,roomId:t,clientId:n,token:r,configServer:this._configServer}}),this._appId=e,this._roomId=t,this._clientId=n,this._token=r,Qn.start(),s.label=1;case 1:return s.trys.push([1,5,,6]),this._room?[3,3]:[4,this.init()];case 2:s.sent(),s.label=3;case 3:return[4,this._room.join()];case 4:return i=s.sent(),this._clientId=i.clientId,this.roomId=i.roomId,this._callId=i.callId,De.dispatch({type:Ie,payload:{roomId:this._roomId,clientId:this._clientId,callId:this._callId}}),Bo.debug({message:i,event_key:"rtc_join_room"}),this._statsInterval>=1e3&&this._startIntervalGetStats(),[2,i];case 5:throw o=s.sent(),Bo.debug({message:o.message,event_key:"rtc_join_room_fail"}),o.code||(o.code=Wn.unknown),new Yn(o.code,o.message);case 6:return[2]}}))}))},t.prototype.leave=function(e){return void 0===e&&(e=!1),a(this,void 0,void 0,(function(){var t=this;return c(this,(function(n){return this._assertNotInRoom(),Bo.debug({message:"leave()",event_key:"rtc_sdk_api_call",sdk_api_name:"leave"}),[2,this._room.leave(e).then((function(e){Bo.debug({message:e,event_key:"rtc_leave_room"}),t._room=null,Qn.stop(),clearTimeout(t._statsTimer)})).catch((function(e){Bo.debug({message:e,event_key:"rtc_leave_room_fail"})}))]}))}))},t.prototype.publish=function(e,t){return a(this,void 0,void 0,(function(){return c(this,(function(n){if(!(e&&e instanceof MediaStream))throw Bo.error("publish() 请传入stream: MediaStream参数"),new Yn(Wn.invalidParameter,"stream: MediaStream为必传参数");return this._assertNotInRoom(),Bo.debug({message:{streamId:e.id,constraints:t},event_key:"rtc_sdk_api_call",sdk_api_name:"publish"}),[2,this._room.publish(e,qn.mergePublishConstraints(t))]}))}))},t.prototype.subscribe=function(e){var t;return a(this,void 0,void 0,(function(){return c(this,(function(n){if(this._assertNotInRoom(),this._autoSubscribe)throw new Yn(Wn.autoSubscribe,"已设置成autoSubscribe模式，不能再调用此方法");if(!(null==e?void 0:e.clientId)||!(null==e?void 0:e.streamId)||void 0===(null==e?void 0:e.screen))throw new Yn(Wn.invalidParameter,"stream: MediaStream为必传参数");return[2,null===(t=this._room)||void 0===t?void 0:t.subscribe(e)]}))}))},t.prototype.updateSubscribe=function(e,t){var n;return a(this,void 0,void 0,(function(){return c(this,(function(r){return this._assertNotInRoom(),[2,null===(n=this._room)||void 0===n?void 0:n.updateSubscribe(e,t)]}))}))},t.prototype.unsubscribe=function(e){return a(this,void 0,void 0,(function(){return c(this,(function(t){if(this._assertNotInRoom(),!e)throw new Yn(Wn.invalidParameter,"streamId: string 为必传参数");return this._room?(Bo.debug({message:{streamId:e},event_key:"rtc_sdk_api_call",sdk_api_name:"unsubscribe"}),[2,this._room.unsubscribe(e)]):[2]}))}))},t.prototype.replaceTrack=function(e,t){return a(this,void 0,void 0,(function(){return c(this,(function(n){if(!e||!t)throw new Yn(Wn.invalidParameter,"stream: MediaStream, track: MediaStreamTrack 为必传参数");return this._assertNotInRoom(),[2,this._room.replaceTrack(e,t)]}))}))},t.prototype.unpublish=function(e){return a(this,void 0,void 0,(function(){return c(this,(function(t){if(!(e&&e instanceof MediaStream))throw Bo.error("publish() 请传入stream: MediaStream参数"),new Yn(Wn.invalidParameter,"stream: MediaStream为必传参数");return Bo.debug({message:{streamId:e.id},event_key:"rtc_sdk_api_call",sdk_api_name:"unpublish"}),this._room?[2,this._room.unpublish(e)]:[2]}))}))},t.prototype.startLiveStreaming=function(e,t){return a(this,void 0,void 0,(function(){return c(this,(function(n){if(!e)throw Bo.error("startLiveStreaming() rtmpUrl不能为空"),new Yn(Wn.invalidParameter,"rtmpUrl不能为空");return this._assertNotInRoom(),Bo.debug({message:{rtmpUrl:e,constraints:t},event_key:"rtc_sdk_api_call",sdk_api_name:"startLiveStreaming"}),[2,this._room.startLiveStreaming(qn.mergeTranscodeConstraints(e,t))]}))}))},t.prototype.stopLiveStreaming=function(){return a(this,void 0,void 0,(function(){return c(this,(function(e){return Bo.debug({message:"stopLiveStreaming()",event_key:"rtc_sdk_api_call",sdk_api_name:"stopLiveStreaming"}),this._assertNotInRoom(),[2,this._room.stopLiveStreaming()]}))}))},t.prototype.getStats=function(){return a(this,void 0,void 0,(function(){return c(this,(function(e){return Bo.debug({message:"getStats()",event_key:"rtc_sdk_api_call",sdk_api_name:"getStats"}),this._assertNotInRoom(),[2,this._room.getStats()]}))}))},t.prototype.getConnectionState=function(){return this._room?this._room.state:"DISCONNECTED"},t.prototype.getRemoteUsers=function(){if(!this._room)return[];var e=this._room.remoteUsers;return Object.values(e)},t.prototype.sendCustomMessage=function(e){return a(this,void 0,void 0,(function(){return c(this,(function(t){return Bo.debug({message:{message:e},event_key:"rtc_sdk_api_call",sdk_api_name:"sendCustomMessage"}),"string"==typeof e&&(e={data:e}),this._assertNotInRoom(),[2,this._room.sendCustomMessage(e)]}))}))},t.prototype._startIntervalGetStats=function(){var e=this;if(!this._room)throw Bo.error("_startIntervalGetStats() room不存在"),new Error("Room not exist");this._room.getStats().then((function(t){e.emit("get-stats",t),e._statsTimer=setTimeout(e._startIntervalGetStats.bind(e),e._statsInterval)}))},t.prototype._handleNetwork=function(){var e=this;window.addEventListener("offline",(function(){navigator.onLine||e.emit("offline")})),window.addEventListener("online",(function(){navigator.onLine&&e.emit("onlie")}))},t.prototype._handleRoom=function(){var e=this;if(!this._room)throw Bo.error("_handleRoom() room不存在"),new Error("Room not exist");this._room.on("@room/error",(function(t){e.emit("error",t)})),this._room.on("@room/socket/events",(function(t){e.emit("socket/events",t)})),this._room.on("@room/receiveStream",(function(t){var n=s({},t);delete n.stream,delete n.peer,Bo.debug({message:n,event_key:"rtc_sdk_callback",sdk_callback_name:"stream-subscribed"}),e.emit("stream-subscribed",{stream:new No(s(s({},t),{dataChannel:e._needCreateDataChannel}))})})),this._room.on("@room/onRemoveStream",(function(t){Bo.debug({message:t,event_key:"rtc_sdk_callback",sdk_callback_name:"stream-removed"}),e.emit("stream-removed",{stream:new No(s({},t))})})),this._room.on("@room/userConnection",(function(t){Bo.debug({message:t,event_key:"rtc_sdk_callback",sdk_callback_name:"peer-online"}),e.emit("peer-online",t)})),this._room.on("@room/userDisconnection",(function(t){var n;if(t.clientId===e._clientId)return null===(n=e._room)||void 0===n||n._destroy(),clearTimeout(e._statsTimer),void e.emit("client-banned");Bo.debug({message:t,event_key:"rtc_sdk_callback",sdk_callback_name:"peer-leave"}),e.emit("peer-leave",t)})),this._room.on("@room/onCustomMessage",(function(t){Bo.debug({message:t,event_key:"rtc_sdk_callback",sdk_callback_name:"custom-message"}),e.emit("custom-message",t)})),this._room.on("@room/stream-published",(function(t){var n;Bo.debug({message:{clientId:null==t?void 0:t.clientId,streamId:null===(n=null==t?void 0:t.stream)||void 0===n?void 0:n.streamId},event_key:"rtc_sdk_callback",sdk_callback_name:"stream-published"}),e.emit("stream-published",{stream:new No(s(s({},t),{dataChannel:e._needCreateDataChannel}))})})),this._room.on("@room/postProcessingMessage",(function(t){e.emit("stream-living",t)})),this._room.on("@room/stream-added",(function(t){e.emit("stream-added",t)}))},t.prototype._getInternalInfo=function(){var e={appId:this._appId,roomId:this._roomId,clientId:this._clientId,globalState:De.getState()};return this._room&&(e.localPeers=this._room._localPeers,e.removePeers=this._room._remotePeers),e},t.prototype._assertNotInRoom=function(){if(!this._room||this._room.state!==xo)throw new Yn(Wn.notInRoom,"not in room")},Object.defineProperty(t.prototype,"clientId",{get:function(){return this._clientId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"appid",{get:function(){return this._appId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"businessId",{get:function(){return this._businessId},set:function(e){this._businessId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roomId",{set:function(e){this._roomId=e},enumerable:!1,configurable:!0}),t}(ir),zo=new tr("ByteRTC"),Fo={createClient:function(e){zo.debug({message:e,event_key:"rtc_sdk_api_call",sdk_api_name:"createClient"});var t=new Uo(e);return window.__rtc_client=t,t.init()},setLogLevel:tr.setLogLevel,BStream:No,EventEmitter:ir}}).call(this,n(4),n(24))},function(e,t,n){"use strict";var r=n(3),i=n(7),o=n(11),s=n(19),a=n(20);(e.exports=function(e,t){var n,i,c,u,d;return arguments.length<2||"string"!=typeof e?(u=t,t=e,e=null):u=arguments[2],r(e)?(n=a.call(e,"c"),i=a.call(e,"e"),c=a.call(e,"w")):(n=c=!0,i=!1),d={value:t,configurable:n,enumerable:i,writable:c},u?o(s(u),d):d}).gs=function(e,t,n){var c,u,d,l;return"string"!=typeof e?(d=n,n=t,t=e,e=null):d=arguments[3],r(t)?i(t)?r(n)?i(n)||(d=n,n=void 0):n=void 0:(d=t,t=n=void 0):t=void 0,r(e)?(c=a.call(e,"c"),u=a.call(e,"e")):(c=!0,u=!1),l={get:t,set:n,configurable:c,enumerable:u},d?o(s(d),l):l}},function(e,t,n){"use strict";var r=n(8),i=/^\s*class[\s{/}]/,o=Function.prototype.toString;e.exports=function(e){return!!r(e)&&!i.test(o.call(e))}},function(e,t,n){"use strict";var r=n(9);e.exports=function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(e){return!1}return!r(e)}},function(e,t,n){"use strict";var r=n(10);e.exports=function(e){if(!r(e))return!1;try{return!!e.constructor&&e.constructor.prototype===e}catch(e){return!1}}},function(e,t,n){"use strict";var r=n(3),i={object:!0,function:!0,undefined:!0};e.exports=function(e){return!!r(e)&&hasOwnProperty.call(i,typeof e)}},function(e,t,n){"use strict";e.exports=n(12)()?Object.assign:n(13)},function(e,t,n){"use strict";e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},function(e,t,n){"use strict";var r=n(14),i=n(18),o=Math.max;e.exports=function(e,t){var n,s,a,c=o(arguments.length,2);for(e=Object(i(e)),a=function(r){try{e[r]=t[r]}catch(e){n||(n=e)}},s=1;s<c;++s)r(t=arguments[s]).forEach(a);if(void 0!==n)throw n;return e}},function(e,t,n){"use strict";e.exports=n(15)()?Object.keys:n(16)},function(e,t,n){"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},function(e,t,n){"use strict";var r=n(2),i=Object.keys;e.exports=function(e){return i(r(e)?Object(e):e)}},function(e,t,n){"use strict";e.exports=function(){}},function(e,t,n){"use strict";var r=n(2);e.exports=function(e){if(!r(e))throw new TypeError("Cannot use null or undefined");return e}},function(e,t,n){"use strict";var r=n(2),i=Array.prototype.forEach,o=Object.create,s=function(e,t){var n;for(n in e)t[n]=e[n]};e.exports=function(e){var t=o(null);return i.call(arguments,(function(e){r(e)&&s(Object(e),t)})),t}},function(e,t,n){"use strict";e.exports=n(21)()?String.prototype.contains:n(22)},function(e,t,n){"use strict";var r="razdwatrzy";e.exports=function(){return"function"==typeof r.contains&&(!0===r.contains("dwa")&&!1===r.contains("foo"))}},function(e,t,n){"use strict";var r=String.prototype.indexOf;e.exports=function(e){return r.call(this,e,arguments[1])>-1}},function(e,t,n){"use strict";e.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,u=[],d=!1,l=-1;function f(){d&&c&&(d=!1,c.length?u=c.concat(u):l=-1,u.length&&h())}function h(){if(!d){var e=a(f);d=!0;for(var t=u.length;t;){for(c=u,u=[];++l<t;)c&&c[l].run();l=-1,t=u.length}c=null,d=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||d||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";n.r(t),n.d(t,"MODE",(function(){return xe})),n.d(t,"ACTION",(function(){return Me})),n.d(t,"KEYCODE",(function(){return je})),n.d(t,"MOUSE_BUTTON",(function(){return Le})),n.d(t,"GAMEPAD_BUTTON",(function(){return Ne})),n.d(t,"default",(function(){return Wn}));var r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==r&&r,i="URLSearchParams"in r,o="Symbol"in r&&"iterator"in Symbol,s="FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch(e){return!1}}(),a="FormData"in r,c="ArrayBuffer"in r;if(c)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(e){return e&&u.indexOf(Object.prototype.toString.call(e))>-1};function l(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function f(e){return"string"!=typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return o&&(t[Symbol.iterator]=function(){return t}),t}function p(e){this.map={},e instanceof p?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function m(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function v(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function _(e){var t=new FileReader,n=v(t);return t.readAsArrayBuffer(e),n}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:s&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:a&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:i&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():c&&s&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c&&(ArrayBuffer.prototype.isPrototypeOf(e)||d(e))?this._bodyArrayBuffer=g(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s&&(this.blob=function(){var e=m(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=m(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(_)}),this.text=function(){var e,t,n,r=m(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=v(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(S)}),this.json=function(){return this.text().then(JSON.parse)},this}p.prototype.append=function(e,t){e=l(e),t=f(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},p.prototype.delete=function(e){delete this.map[l(e)]},p.prototype.get=function(e){return e=l(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(l(e))},p.prototype.set=function(e,t){this.map[l(e)]=f(t)},p.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},p.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),h(e)},p.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),h(e)},p.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),h(e)},o&&(p.prototype[Symbol.iterator]=p.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function E(e,t){if(!(this instanceof E))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,r,i=(t=t||{}).body;if(e instanceof E){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),b.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(i),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var o=/([?&])_=[^&]*/;if(o.test(this.url))this.url=this.url.replace(o,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function S(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function w(e,t){if(!(this instanceof w))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}E.prototype.clone=function(){return new E(this,{body:this._bodyInit})},y.call(E.prototype),y.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},w.error=function(){var e=new w(null,{status:0,statusText:""});return e.type="error",e};var C=[301,302,303,307,308];w.redirect=function(e,t){if(-1===C.indexOf(t))throw new RangeError("Invalid status code");return new w(null,{status:t,headers:{location:e}})};var k=r.DOMException;try{new k}catch(e){(k=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),k.prototype.constructor=k}function R(e,t){return new Promise((function(n,i){var o=new E(e,t);if(o.signal&&o.signal.aborted)return i(new k("Aborted","AbortError"));var a=new XMLHttpRequest;function u(){a.abort()}a.onload=function(){var e,t,r={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new p,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;setTimeout((function(){n(new w(i,r))}),0)},a.onerror=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},a.ontimeout=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},a.onabort=function(){setTimeout((function(){i(new k("Aborted","AbortError"))}),0)},a.open(o.method,function(e){try{return""===e&&r.location.href?r.location.href:e}catch(t){return e}}(o.url),!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&(s?a.responseType="blob":c&&o.headers.get("Content-Type")&&-1!==o.headers.get("Content-Type").indexOf("application/octet-stream")&&(a.responseType="arraybuffer")),!t||"object"!=typeof t.headers||t.headers instanceof p?o.headers.forEach((function(e,t){a.setRequestHeader(t,e)})):Object.getOwnPropertyNames(t.headers).forEach((function(e){a.setRequestHeader(e,f(t.headers[e]))})),o.signal&&(o.signal.addEventListener("abort",u),a.onreadystatechange=function(){4===a.readyState&&o.signal.removeEventListener("abort",u)}),a.send(void 0===o._bodyInit?null:o._bodyInit)}))}R.polyfill=!0,r.fetch||(r.fetch=R,r.Headers=p,r.Request=E,r.Response=w);var T=n(0),I=n.n(T);function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=function(){return(A=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function D(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function P(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(D(arguments[t]));return e}var x,M,L,j=(M=x={exports:{}},L=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function i(){}function o(t,n,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},i.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var s=JSON.stringify(n);/^[\{\[]/.test(s)&&(n=s)}catch(e){}n=r.write?r.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var c in o)o[c]&&(a+="; "+c,!0!==o[c]&&(a+="="+o[c].split(";")[0]));return document.cookie=t+"="+n+a}}function s(e,n){if("undefined"!=typeof document){for(var i={},o=document.cookie?document.cookie.split("; "):[],s=0;s<o.length;s++){var a=o[s].split("="),c=a.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=t(a[0]);if(c=(r.read||r)(c,u)||t(c),n)try{c=JSON.parse(c)}catch(e){}if(i[u]=c,e===u)break}catch(e){}}return e?i[e]:i}}return i.set=o,i.get=function(e){return s(e,!1)},i.getJSON=function(e){return s(e,!0)},i.remove=function(t,n){o(t,"",e(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}((function(){}))},M.exports=L(),x.exports),N=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e}(),B={getItem:function(e){try{var t=localStorage.getItem(e),n=t;try{t&&"string"==typeof t&&(n=JSON.parse(t))}catch(e){}return n||void 0}catch(e){}},setItem:function(e,t){try{var n="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,n)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){try{return j.get(e,{domain:t||document.domain})}catch(e){return""}},setCookie:function(e,t,n,r){try{var i=r||document.domain,o=+new Date+n;j.set(e,t,{expires:new Date(o),path:"/",domain:i})}catch(e){}},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},U={getItem:function(e){try{var t=sessionStorage.getItem(e),n=t;try{t&&"string"==typeof t&&(n=JSON.parse(t))}catch(e){}return n||void 0}catch(e){}},setItem:function(e,t){try{var n="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,n)}catch(e){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(e){}},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},z=function(){function e(e,t){this._storage=t&&"session"===t?U:!e&&B.isSupportLS?B:new N}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,n,r){this._storage.setCookie(e,t,n,r)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),F={cn:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},G="/webid",H="/list",K="4.2.9",V=4001,q=4e3,W=4002,Y=4003,J=500,$=5005,X=function(e,t){return t?"__tea_cache_tokens_"+e:"__tea_cache_events_"+e},Z=6048e5,Q=function(e,t,n,r){try{var i,o=e.match(/\/v\d\//);i=o?o[0]:-1!==e.indexOf("/v1/")?"/v1/":"/v2/";var s=e.split(i)[0];if(!s)return void r(e,t,V);t.forEach((function(i){var o=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&void 0!==e[n]&&(t+="&"+n+"="+encodeURIComponent(JSON.stringify(e[n])));return"&"===t[0]?t.slice(1):t}(i),a=new Image(1,1);a.onload=function(){a=null,n&&n()},a.onerror=function(){a=null,r&&r(e,t,q)},a.src=s+"/gif?"+o}))}catch(n){r&&r(e,t,W,n.message)}},ee=function(e,t,n,r,i,o,s,a,c,u){var d=window.navigator.userAgent,l=-1!==window.navigator.appName.indexOf("Microsoft Internet Explorer")&&(-1!==d.indexOf("MSIE 8.0")||-1!==d.indexOf("MSIE 9.0")),f=!!r;if(!f&&l)Q(e,n,i,o);else if(!f&&a)return window.navigator&&window.navigator.sendBeacon?(u&&u(),void(window.navigator.sendBeacon(e,JSON.stringify(n))?i():o(e,n,Y))):void Q(e,n,i,o);s&&delete n.app_key,function(e,t,n,r,i,o,s,a){try{var c=new XMLHttpRequest;c.open("POST",""+e,!0),c.setRequestHeader("Content-Type","application/json; charset=utf-8"),i&&c.setRequestHeader("X-MCS-AppKey",""+i),s&&(c.withCredentials=!0),c.onload=function(){if(n){var e=null;if(c.responseText){try{e=JSON.parse(c.responseText)}catch(t){e={}}n(e,t)}}};try{o&&(c.timeout=o),o&&(c.ontimeout=function(){r&&r(t,$)}),c.onerror=function(){c.abort(),r&&r(t,J)},c.send(JSON.stringify(t))}catch(e){}}catch(e){}}(e,n,i,o,r,t,c)};function te(e){return e?(e^16*Math.random()>>e/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,te)}var ne=function(){return te().replace(/-/g,"").slice(0,19)},re=function(e){return function(e,t,n){if("string"==typeof e&&"number"==typeof n){var r,i=[];n=n<=25?n:n%25;var o=String.fromCharCode(n+97);r=e.split(o);for(var s=0;s<r.length;s++){var a=parseInt(r[s],n);a=1*a^64;var c=String.fromCharCode(a);i.push(c)}return i.join("")}}(e,0,25)},ie=function(e){var t=document.createElement("a");return t.href=e,t},oe=function(e){var t=ie(e).search;t=t.slice(1);var n={};return t.split("&").forEach((function(e){var t,r,i=e.split("=");i.length&&(t=i[0],r=i[1]);try{n[t]=decodeURIComponent(void 0===r?"":r)}catch(e){n[t]=r}})),n},se=function(){function e(e,t,n,r){this.enableCustomWebid=!1,this.config=e,this.cfg=t,this.storage=new z(!1),this.appInfo=e.app_key||e.app_id,this.isNoWebid=e.disable_webid,this.enable_ttwebid=e.enable_ttwebid||!1,this.domain=e.channel_domain||re(F[e.channel]),this.tokenReady=!1,this.enableCustomWebid=e.enable_custom_webid,this.checkExp=e.checkExp||!1,this.enableCookie=e.cross_subdomain||!1,this.expiresTime=e.cookie_expire||Z,this.fetchUrl=""+this.domain+G,this.hook=n,this.session=r,this.cookieDomain=e.cookie_domain||""}return e.prototype._getToken=function(){var e=this;try{if(this.tokensKey=X(this.appInfo,!0),this.cookieKey="__tea_cookie_tokens_"+this.appInfo,this.enableCustomWebid)return void this.hook.on("custom-webid",(function(){e.tokenReady=!0,e.hook.emit("token-ready")}));if(this._checkEnv())return;var t=this.storage.getItem(this.tokensKey);if(this.enable_ttwebid)if(t){var n={user_unique_id:t.user_unique_id||"",timestamp:Date.now()};this.storage.setItem(this.tokensKey,n),this._setTtWid(t,!1)}else this._setTtWid(t,!0);else if(this.enableCookie){var r=this.storage.getCookie(this.cookieKey,this.cookieDomain);if(r){var i=(r=JSON.parse(decodeURIComponent(r))).user_unique_id,o=r.web_id,s=r.timestamp;this._setToken(o,i,s)}else{if(!t)return void this._requestWebId();this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(t)),this.expiresTime,this.cookieDomain),this._checkLocal(t)}}else{if(!t)return void this._requestWebId();this._checkLocal(t)}}catch(e){console.log(""+e.message)}},e.prototype._checkEnv=function(){if(-1!==window.navigator.userAgent.indexOf("miniProgram")){var e=oe(window.location.href);return!(!e||!e.Web_ID||(this._setTokenId(""+e.Web_ID),0))}return!1},e.prototype._checkLocal=function(e){var t=e.user_unique_id,n=e.web_id,r=e.timestamp;n&&t?this._setToken(n,t,r):this._requestWebId()},e.prototype._setToken=function(e,t,n){if(this.checkExp){var r=Date.now()-parseFloat(n);if(r>7344e6)return void this._requestWebId();if(r>432e7)return void this._updateWebId(e)}this.cfg.envInfo.user.user_unique_id=t,this.cfg.envInfo.user.web_id=e,this.storage.setItem(this.tokensKey,{user_unique_id:t,web_id:e,timestamp:Date.now()}),this.tokenReady=!0},e.prototype._requestWebId=function(){this.isNoWebid?this._setTokenId(ne()):this._fetchWebId(this.fetchUrl,!1)},e.prototype._updateWebId=function(e){var t=""+this.domain+G+"/"+e+"/update";this._fetchWebId(t,!0)},e.prototype._fetchWebId=function(e,t){var n=this;ee(e,3e3,{app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""},this.config.app_key,(function(e){e&&0===e.e?n._setTokenId(e.web_id):(n.hook.emit("token-error"),console.warn("[]appid: "+n.config.app_id+", "+(t?" update":"get")+" webid error, init error~"))}),(function(){n.hook.emit("token-error"),console.warn("[]appid: "+n.config.app_id+", get webid error, init error~")}),!0,!1,this.enable_ttwebid)},e.prototype._setTtWid=function(e,t){if(!t){var n={web_id:e.web_id||"",timestamp:Date.now()},r=e.user_unique_id||"";this.cfg.envInfo.user.user_unique_id=this.cfg.envInfo.user.user_unique_id||r,this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(n)),108e5,this.cookieDomain)}this.tokenReady=!0,this.hook.emit("token-ready")},e.prototype._setTokenId=function(e){var t=this.cfg.envInfo.user.web_id||e,n={web_id:t,user_unique_id:this.cfg.envInfo.user.user_unique_id||t,timestamp:Date.now()};this.enableCookie&&this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(n)),this.expiresTime,this.cookieDomain),this.storage.setItem(this.tokensKey,n),this.cfg.envInfo.user.web_id=this.cfg.envInfo.user.web_id||t,this.cfg.envInfo.user.user_unique_id=this.cfg.envInfo.user.user_unique_id||t,this.tokenReady=!0,this.hook.emit("token-ready")},e.prototype._setUuid=function(e){try{var t=this.storage.getItem(this.tokensKey);if(e){"string"!=typeof e&&console.warn("user_unique_id must be string!!! please check");var n=String(e);if(n===this.cfg.envInfo.user.user_unique_id)return;this.cfg.envInfo.user.user_unique_id=n,t&&t.user_unique_id?t.user_unique_id!==n&&(t.user_unique_id=n):(t={}).user_unique_id=n,t.timestamp=Date.now(),this.storage.setItem(this.tokensKey,t),this.session._resetSessionId(),this.hook.emit("token-change","uuid")}else this._clearUuid(t)}catch(e){}},e.prototype._clearUuid=function(e){this.enable_ttwebid||e&&e.web_id&&(this.cfg.envInfo.user.user_unique_id=e.web_id||void 0,e.user_unique_id=e.web_id||void 0,e.timestamp=Date.now(),this.storage.setItem(this.tokensKey,e))},e.prototype._setWebid=function(e){if(!this.enable_ttwebid){var t=this.storage.getItem(this.tokensKey);t&&t.web_id?t.web_id!==e&&(t.user_unique_id=t.web_id===t.user_unique_id?e:t.user_unique_id,t.web_id=e):((t={}).web_id=e,t.user_unique_id=e),t.timestamp=Date.now(),this.storage.setItem(this.tokensKey,t),this.cfg.envInfo.user.user_unique_id&&this.cfg.envInfo.user.user_unique_id!==this.cfg.envInfo.user.web_id||(this.cfg.envInfo.user.user_unique_id=e,this.hook.emit("token-change","uuid")),e!==this.cfg.envInfo.user.web_id&&(this.cfg.envInfo.user.web_id=e,this.hook.emit("token-change","webid"))}},e.prototype.isTokenReady=function(){return this.tokenReady},e.prototype._getTobId=function(e){var t=this.domain+"/tobid";ee(t,3e4,{app_id:this.config.app_id,user_unique_id:this.cfg.envInfo.user.user_unique_id,web_id:this.cfg.envInfo.user.web_id},this.config.app_key,(function(t){t&&0===t.e?e(t.tobid):e(null)}),(function(){e(null)}),!0,!1,this.enable_ttwebid)},e}(),ae=function(e){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)},ce=function(){function e(e,t,n,r,i,o,s){this.collect=e,this.cfg=n,this.config=t,this._token=r,this.appInfo=t.app_id||t.app_key,this.debugMode=!!t.log,this.evtDataKey=X(this.appInfo,!1);var a=t.channel_domain||re(F[t.channel]);this.reportUrl=t.report_url?t.report_url:""+a+H,this.storage=new z(!0),this.EventStorage=new z(!1),this.maxStorage=t.max_storage_num||-1,this.maxReport=t.max_report||10,this.reportTime=t.reportTime||30,this.timeout=t.timeout||1e5,this.closeStorage=!0,this.plugin=i,this.session=o,this.match=s,this.filter=t.filter,this.addListener()}return e.prototype.addListener=function(){var e=this;window.addEventListener("unload",(function(){e.report(!0)}),!1),ae((function(){e.report(!0)})),document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e.report(!0)}),!1)},e.prototype.setReady=function(){this.isReady=!0,this.report()},e.prototype.event=function(e){var t=this;void 0===e&&(e=[]);try{var n=P(e,this.storage.getItem(this.evtDataKey)||[]);this.storage.setItem(this.evtDataKey,n),this.reportTimer&&clearTimeout(this.reportTimer),n.length>=this.maxReport?this.report(!1):this.reportTimer=setTimeout((function(){t.report(!1),t.reportTimer=null}),this.reportTime)}catch(e){}},e.prototype.beconEvent=function(e){void 0===e&&(e=[]);var t=this._mergeEvents(e);this._dealData(t,!0)},e.prototype.report=function(e){if(void 0===e&&(e=!1),!this.collect.destroyInstance&&this._token.isTokenReady()&&this.isReady){var t=this.storage.getItem(this.evtDataKey)||[],n=this._mergeEvents(t);this.storage.removeItem(this.evtDataKey),this._dealData(n,e)}},e.prototype.clearEventCache=function(){this.report(!1)},e.prototype._mergeEvents=function(e){var t=this;if(!e.length)return e;var n=this.cfg.get();n.header.custom=JSON.stringify(n.header.custom);var r=[];return r.push(e),r.map((function(e){return{events:e.map((function(e){var n=A({},t.cfg.get("evtParams"),e.params);try{return e.event&&"applog_trace"!==e.event?(delete n.__disable_storage__,A({},e,{params:JSON.stringify(n),session_id:t.session._getSessionId()})):A({},e,{params:JSON.stringify(e.params)})}catch(t){return A({},e,{params:JSON.stringify(e.params)})}})),user:n.user,header:n.header,verbose:t.debugMode?1:void 0,local_time:parseInt(""+(new Date).getTime()/1e3),user_unique_type:t.config.enable_ttwebid?t.config.user_unique_type:void 0}}))},e.prototype._dealData=function(e,t){var n=this;if(!this.config.disable_track_event){if(!e.length)return e;e.map((function(e){var t=[];return t.push(e),t})).forEach((function(e){var r=ne(),i=JSON.parse(JSON.stringify(e));try{n.filter&&(i=n.filter(i)),n.collect.eventFilter&&(i=n.collect.eventFilter(i))}catch(e){}var o=i||e;n._send(r,o,t)}))}},e.prototype._send=function(e,t,n){var r=this;this.isSending=!0;var i=function(){r.isSending=!1};ee(this.reportUrl,this.timeout,t,this.config.app_key,(function(e,t){i(),e&&0!==e.e&&r.collect&&r.collect.tracer&&1!==r.cfg.staging&&r.collect.tracer.addErrorCount(t,"f_data",e.e,e)}),(function(e,t){i(),r.cfg.get("reportErrorCallback")(e,t),r.collect&&r.collect.tracer&&1!==r.cfg.staging&&r.collect.tracer.addErrorCount(e,"f_net",t)}),!1,n,this.config.enable_ttwebid,i)},e.prototype.checkStorageEvent=function(){},e}(),ue=void 0,de=(new Date).getTimezoneOffset(),le=parseInt(""+-de/60,10),fe=60*de,he=function(){function e(e,t,n){this.initConfig=t;var r=function(e,t,n){var r,i,o=window.screen.width,s=window.screen.height,a=window.navigator.appVersion,c=window.navigator.userAgent,u=window.navigator.language,d=document.referrer,l=d?ie(d).hostname:"",f=oe(window.location.href),h="",p="",m="",v=""+parseFloat(a);-1!==(r=c.indexOf("Opera"))&&(m="Opera",v=c.substring(r+6),-1!==(r=c.indexOf("Version"))&&(v=c.substring(r+8))),-1!==c.indexOf("Edge")||-1!==c.indexOf("Edg")?(m="Microsoft Edge",-1!==c.indexOf("Edge")?(r=c.indexOf("Edge"),v=c.substring(r+5)):(r=c.indexOf("Edg"),v=c.substring(r+4))):-1!==(r=c.indexOf("MSIE"))?(m="Microsoft Internet Explorer",v=c.substring(r+5)):-1!==(r=c.indexOf("Lark"))?(m="Lark",v=c.substring(r+5,r+11)):-1!==c.indexOf("Chrome")?-1!==(r=c.indexOf("MicroMessenger"))?(m="weixin",v=c.substring(r+15,r+20)):-1!==(r=c.indexOf("MQQBrowser"))?(m="qqbrowser",v=c.substring(r+11,r+15)):-1!==(r=c.indexOf("360"))?(m="360browser",v=c.substring(c.indexOf("Chrome")+7)):-1!==c.indexOf("baidubrowser")||-1!==c.indexOf("BIDUBrowser")?(-1!==c.indexOf("baidubrowser")?(r=c.indexOf("baidubrowser"),v=c.substring(r+13,r+16)):-1!==c.indexOf("BIDUBrowser")&&(r=c.indexOf("BIDUBrowser"),v=c.substring(r+12,r+15)),m="baidubrowser"):-1!==(r=c.indexOf("xiaomi"))?-1!==c.indexOf("openlanguagexiaomi")?(m="openlanguage xiaomi",v=c.substring(r+7,r+13)):(m="xiaomi",v=c.substring(r-7,r-1)):-1!==(r=c.indexOf("TTWebView"))?(m="TTWebView",v=c.substring(r+10,r+23)):-1!==(r=c.indexOf("Chrome"))&&(m="Chrome",v=c.substring(r+7)):-1!==c.indexOf("Safari")?-1!==(r=c.indexOf("QQ"))?(m="qqbrowser",v=c.substring(r+10,r+16)):-1!==(r=c.indexOf("Safari"))&&(m="Safari",v=c.substring(r+7),-1!==(r=c.indexOf("Version"))&&(v=c.substring(r+8))):-1!==(r=c.indexOf("Firefox"))?(m="Firefox",v=c.substring(r+8)):-1!==(r=c.indexOf("MicroMessenger"))?(m="weixin",v=c.substring(r+15,r+20)):-1!==(r=c.indexOf("QQ"))&&(m="qqbrowser",v=c.substring(r+3,r+8)),-1!==(i=v.indexOf(";"))&&(v=v.substring(0,i)),-1!==(i=v.indexOf(" "))&&(v=v.substring(0,i)),-1!==(i=v.indexOf(")"))&&(v=v.substring(0,i));for(var _,g,y=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(a)?"wap":"web",b=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],E=0;E<b.length;E++){var S=b[E];if(S.r.test(c)){h=S.s;break}}function w(e,t){var n=e.exec(t);return n&&n[1]?n[1]:""}switch(/Windows/.test(h)&&(p=w(/Windows (.*)/,h),h="windows"),h){case"Mac OS X":_=c,p=(g=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?)","i").exec(_))?g.slice(1)[0]:"",h="mac";break;case"Android":p=function(e){var t=w(/Android ([\.\_\d]+)/,e);return t||(t=w(/Android\/([\.\_\d]+)/,e)),t}(c),h="android";break;case"iOS":p=(p=/OS (\d+)_(\d+)_?(\d+)?/.exec(a))?p[1]+"."+p[2]+"."+(0|p[3]):"",h="ios"}var C=function(e,t,n,r){var i=new z(!1),o=new z(!1,"session"),s=e?"_tea_utm_cache_"+e:"_tea_utm_cache",a=e?"_$utm_from_url_"+e:"_$utm_from_url",c={},u=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],d={creative_id:Number(t.creative_id),ad_id:Number(t.ad_id),campaign_id:Number(t.campaign_id),utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4},l=r;try{var f=!1;for(var h in d)d[h]&&(-1!==u.indexOf(h)?(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data[h]=d[h]):c[h]=d[h],f=!0);if(f)o.setItem(a,"1"),i.setCookie(s,JSON.stringify(c),l,n);else{var p=i.getCookie(s,n);p&&(c=JSON.parse(p)),i.setCookie(s,p,l,n)}o.getItem(a)&&(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data.$utm_from_url=1)}catch(e){return d}return c}(e,f,t,n);return{browser:m,browser_version:v,platform:y,os_name:h,os_version:p,userAgent:c,screen_width:o,screen_height:s,device_model:function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach((function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))}));else if("ios"===e||"mac"===e||"windows"===e){var n=navigator.userAgent.replace("Mozilla/5.0 (",""),r=n.indexOf(";");t=n.slice(0,r)}}catch(e){}return t.trim()}(h),language:u,referrer:d,referrer_host:l,creative_id:C.creative_id,ad_id:C.ad_id,campaign_id:C.campaign_id,utm_source:C.utm_source,utm_medium:C.utm_medium,utm_campaign:C.utm_campaign,utm_term:C.utm_term,utm_content:C.utm_content,tracer_data:C.tracer_data}}(e,t.cookie_domain||"",t.cookie_expire||Z);this.configKey=function(e){return"__tea_cache_config_"+e}(""+e),this.sessionStorage=new z(!1,"session"),this.localStorage=new z(!1,"local"),n&&(this.storage=1===n?this.sessionStorage:this.localStorage),this.envInfo={user:{user_unique_id:ue,user_type:ue,user_id:ue,user_is_auth:ue,user_is_login:ue,device_id:ue,web_id:ue,ip_addr_id:ue,ssid:ue},header:{app_id:ue,app_name:ue,app_install_id:ue,install_id:ue,app_package:ue,app_channel:ue,app_version:ue,os_name:r.os_name,os_version:r.os_version,device_model:r.device_model,ab_client:ue,ab_version:ue,ab_sdk_version:ue,traffic_type:ue,client_ip:ue,device_brand:ue,os_api:ue,access:ue,language:r.language,region:ue,app_language:ue,app_region:ue,creative_id:r.creative_id,ad_id:r.ad_id,campaign_id:r.campaign_id,log_type:ue,rnd:ue,platform:r.platform,sdk_version:K,sdk_lib:"js",province:ue,city:ue,timezone:le,tz_offset:fe,tz_name:ue,sim_region:ue,carrier:ue,resolution:r.screen_width+"x"+r.screen_height,browser:r.browser,browser_version:r.browser_version,referrer:r.referrer,referrer_host:r.referrer_host,width:r.screen_width,height:r.screen_height,screen_width:r.screen_width,screen_height:r.screen_height,utm_term:r.utm_term,utm_content:r.utm_content,utm_source:r.utm_source,utm_medium:r.utm_medium,utm_campaign:r.utm_campaign,tracer_data:JSON.stringify(r.tracer_data),custom:{},wechat_openid:ue,wechat_unionid:ue}},this.evtParams={},this.reportErrorCallback=function(){}}return e.prototype.set=function(e,t){var n=this;if(null==t&&(this.delete(e),t=void 0),"evtParams"===e||"_staging_flag"===e){var r;r="evtParams"===e?t:{_staging_flag:Number(t)};var i=A({},r);Object.keys(i).forEach((function(e){n.evtParams[e]=i[e]}))}else if("reportErrorCallback"===e&&"function"==typeof t)this.reportErrorCallback=t;else{var o="";if(e.indexOf(".")>-1){var s=e.split(".");o=s[0],e=s[1]}if("user_unique_id"===e){if(!t)return;if(-1!==["0","Null","None","","undefined"].indexOf(t))return}"os_version"===e&&(e=""+t),o?"user"===o||"header"===o?this.envInfo[o][e]=t:this.envInfo.header.custom[e]=t:this.envInfo.user.hasOwnProperty(e)?["user_type","ip_addr_id"].indexOf(e)>-1?this.envInfo.user[e]=t?Number(t):t:["user_id","web_id","user_unique_id","ssid"].indexOf(e)>-1?this.envInfo.user[e]=t?String(t):t:["user_is_auth","user_is_login"].indexOf(e)>-1?this.envInfo.user[e]=Boolean(t):"device_id"===e&&(this.envInfo.user[e]=t):this.envInfo.header.hasOwnProperty(e)?this.envInfo.header[e]=t:this.envInfo.header.custom[e]=t}},e.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(e){console.log("get config stringify error ")}},e.prototype.setStore=function(e){try{var t=this.storage.getItem(this.configKey);if(Object.keys(e).length){var n=Object.assign(e,t);this.storage.setItem(this.configKey,n)}}catch(e){}},e.prototype.getStore=function(){try{var e=this.storage.getItem(this.configKey);return Object.keys(e).length?e:null}catch(e){return null}},e.prototype.delete=function(e){try{var t=this.storage.getItem(this.configKey);t&&t.hasOwnProperty(e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(e){}},e}(),pe=function(){function e(e,t){this.isLog=t||!1,this.name=e||""}var t=e.prototype;return t.info=function(e){this.isLog&&console.log("["+this.name+"] "+e)},t.warn=function(e){this.isLog&&console.warn("["+this.name+"] "+e)},t.error=function(e){this.isLog&&console.error("["+this.name+"] "+e)},t.throw=function(e){throw this.error(this.name),new Error(e)},e}(),me=function(){function e(){this._hooks={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var n=this;e&&t&&"function"==typeof t&&this.on(e,(function r(i){t(i),n.off(e,r)}))},e.prototype.off=function(e,t){if(e&&this._hooks[e]&&this._hooks[e].length)if(t){var n=this._hooks[e].indexOf(t);-1!==n&&this._hooks[e].splice(n,1)}else this._hooks[e]=[]},e.prototype.emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&P(this._hooks[e]).forEach((function(e){try{e(t)}catch(e){}}))},e}(),ve=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},_e=function(){function e(e,t){this.storage=new z(!1,"session"),this.sessionKey=function(e){return"__tea_session_id_"+e}(e),this.expireTime=t.expireTime||18e5,this.disableSession=t.disable_session,this.disableSession||this._setSessionId()}return e.prototype._updateSessionId=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var t=e.timestamp;Date.now()-t>this.expireTime?e={sessionId:ve(),timestamp:Date.now()}:e.timestamp=Date.now(),this.storage.setItem(this.sessionKey,e),this._resetExpTime()}},e.prototype._setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:ve(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.sessionExp=setInterval((function(){e._checkEXp()}),this.expireTime)},e.prototype._getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return this.disableSession?"":e&&e.sessionId?e.sessionId:""},e.prototype._resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval((function(){e._checkEXp()}),this.expireTime))},e.prototype._resetSessionId=function(){var e={sessionId:ve(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,e)},e.prototype._checkEXp=function(){var e=this.storage.getItem(this.sessionKey);e&&e.sessionId&&Date.now()-e.timestamp+30>=this.expireTime&&(e={sessionId:ve(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))},e}(),ge={pv:["predefine_pageview"],sdk:["_be_active","predefine_page_alive","predefine_page_close","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append"],autotrack:["bav2b_click","bav2b_page","bav2b_beat","bav2b_page_statistics","__bav_click","__bav_page","__bav_beat","__bav_page_statistics"]},ye=function(){function e(e,t,n,r){this.count={pv:0,sdk:0,autotrack:0,log:0},this.limit={pv:1,sdk:10,autotrack:10,log:3},this.errorCode={f_net:0,f_data:0},this.errorInfo={pv:{f_net:0,f_data:0},sdk:{f_net:0,f_data:0},autotrack:{f_net:0,f_data:0},log:{f_net:0,f_data:0}},this.collect=e,this.disable_tracer=t.disable_tracer||t.channel_domain,this.ready=!(!t.app_id||this.disable_tracer||t.disable_track_event),this.appid=t.app_id,this.process=n,this.event=r;var i=t.channel_domain||re(F[t.channel]);this.reportUrl=t.report_url?t.report_url:""+i+H,this.listener()}return e.prototype.addCount=function(e){try{if(!this.ready)return;if(this.count[e]++,this.count[e]>=this.limit[e]){var t=[];for(var n in t=P(t,this.processTracer(this.count[e],e,"net")),this.errorInfo[e])this.errorInfo[n]&&(t=P(t,this.processTracer(this.errorInfo[e][n],e,n)));t.length&&this.sendTracer(t,!0,e,!1)}}catch(e){}},e.prototype.addErrorCount=function(e,t,n,r){var i=this;try{if(!this.ready)return;if(e&&e.length){var o=e[0].events;o&&o.length&&("f_data"===t?(r&&r.hasOwnProperty("sc")?this.errorInfo.log.f_data=o.length-r.sc:this.errorInfo.log.f_data=o.length,this.errorCode.f_data=n):o.forEach((function(e){var t="log";for(var r in ge)if(-1!==ge[r].indexOf(e.event)){t=r;break}i.errorInfo[t].f_net++,i.errorCode.f_net=n})))}}catch(e){}},e.prototype.clearCount=function(e){try{e?(this.count[e]=0,this.errorInfo[e]={f_net:0,f_data:0}):(this.count={pv:0,sdk:0,autotrack:0,log:0},this.errorInfo={pv:{f_net:0,f_data:0},sdk:{f_net:0,f_data:0},autotrack:{f_net:0,f_data:0},log:{f_net:0,f_data:0}})}catch(e){}},e.prototype.sendTracer=function(e,t,n,r){try{if(!this.ready)return;if(this.collect.staging)return;var i=this.event._mergeEvents(e);r&&window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify(i)):ee(this.reportUrl,3e5,i,""),t?this.clearCount(n):this.clearCount()}catch(e){}},e.prototype.processTracer=function(e,t,n){try{var r={count:e,state:n,key:t,params_for_special:"applog_trace",aid:this.appid,platform:"web",_staging_flag:1,sdk_version:K};"f_net"!==n&&"f_data"!==n||(r.errorCode=this.errorCode[n]);var i=[];if(i.push(this.process("applog_trace",r,!0)),i&&i.length)return delete i[0].is_bav,i}catch(e){}},e.prototype.listener=function(){var e=this;this.ready&&(document.addEventListener("visibilitychange",(function(){e.leavePage()})),ae((function(){e.leavePage()})))},e.prototype.leavePage=function(){if(this.ready)try{var e=[];for(var t in this.count)if(this.count[t]){var n=this.errorInfo[t];for(var r in e=P(e,this.processTracer(this.count[t],t,"net")),n)n[r]&&(e=P(e,this.processTracer(n[r],t,r)))}e&&e.length&&this.sendTracer(e,!1,"",!0)}catch(e){}},e}(),be=function(){function e(e){this.logger=e}var t=e.prototype;return t.bridgeInject=function(){try{return AppLogBridge?(this.logger.info("AppLogBridge is injected"),!0):(this.logger.info("AppLogBridge is not inject"),!1)}catch(e){return this.logger.info("AppLogBridge is not inject"),!1}},t.hasStarted=function(e){var t=this;try{this.bridgeInject()?AppLogBridge.hasStarted((function(n){t.logger.info("AppLogBridge is started? : "+n),e(n)})):e(0)}catch(t){this.logger.info("AppLogBridge, error:"+JSON.stringify(t.stack)),e(0)}},t.setUserUniqueId=function(e){try{AppLogBridge.setUserUniqueId(e)}catch(e){this.logger.error("setUserUniqueId error")}},t.addHeaderInfo=function(e,t){try{AppLogBridge.addHeaderInfo(e,t)}catch(e){this.logger.error("addHeaderInfo error")}},t.setHeaderInfo=function(e){try{AppLogBridge.setHeaderInfo(JSON.stringify(e))}catch(e){this.logger.error("setHeaderInfo error")}},t.removeHeaderInfo=function(e){try{AppLogBridge.removeHeaderInfo(e)}catch(e){this.logger.error("removeHeaderInfo error")}},t.onEventV3=function(e,t){try{AppLogBridge.onEventV3(e,t)}catch(e){this.logger.error("onEventV3 error")}},t.profileSet=function(e){try{AppLogBridge.profileSet(e)}catch(e){this.logger.error("profileSet error")}},t.profileSetOnce=function(e){try{AppLogBridge.profileSetOnce(e)}catch(e){this.logger.error("profileSetOnce error")}},t.profileIncrement=function(e){try{AppLogBridge.profileIncrement(e)}catch(e){this.logger.error("profileIncrement error")}},t.profileUnset=function(e){try{AppLogBridge.profileUnset(e)}catch(e){this.logger.error("profileUnset error")}},t.profileAppend=function(e){try{AppLogBridge.profileAppend(e)}catch(e){this.logger.error("profileAppend error")}},e}();function Ee(e,t,n){void 0===t&&(t=""),void 0===n&&(n={});var r=e;"/"===(r=r.split("#")[0].split("?")[0])[e.length-1]&&(r=r.substr(0,e.length-1)),r="/"===t[0]?r.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?)(\/[.\w-]+)*\/?$/,"$1"+t):r.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?(\/[.\w-]+)*?)(\/[.\w-]+)?\/?$/,"$1/"+t);var i=Object.keys(n).map((function(e){return e+"="+n[e]})).join("&");return i.length>0?r+"?"+i:r}var Se,we=function(){function e(e){this.autotrack=!1,this.spa=!1,(e.spa||e.autotrack)&&(this.autotrack=!!e.autotrack,this.spa=e.spa,this.fncArray=new Map,this.setLocation(),this.hack(),this.storage=new z(!0),this.storage.setItem("__tea_cache_refer_key",location.href),this.listener())}return e.prototype.hack=function(){var e=this,t=window.history.pushState;history.pushState=function(n){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];"function"==typeof history.onpushstate&&history.onpushstate({state:n});var o=t.call.apply(t,P([history,n],r)),s=e.getPopStateChangeEventData();return e.lastLocation=Ee(location.href,r[1]),e.storage.setItem("__tea_cache_refer_key",e.lastLocation),e.sendPv(s),o};var n=history.replaceState;history.replaceState=function(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];"function"==typeof history.onreplacestate&&history.onreplacestate({state:t});var o=n.call.apply(n,P([history,t],r)),s=e.getPopStateChangeEventData();return e.lastLocation=Ee(location.href,r[1]),e.storage.setItem("__tea_cache_refer_key",e.lastLocation),e.sendPv(s),o}},e.prototype.setLocation=function(){"undefined"!=typeof window&&(this.lastLocation=window.location.href)},e.prototype.add=function(e,t){this.fncArray.get(e)||this.fncArray.set(e,t)},e.prototype.init=function(e,t){this.add(e,t),this.fncArray.get(e)(this.getPopStateChangeEventData())},e.prototype.listener=function(){var e=this,t=null;window.addEventListener("hashchange",(function(n){e.lastLocation!==window.location.href&&clearTimeout(t)})),window.addEventListener("popstate",(function(n){e.lastLocation!==window.location.href&&(t=setTimeout((function(){e.lastLocation=window.location.href;var t=e.getPopStateChangeEventData();e.sendPv(t)}),10))}))},e.prototype.getPopStateChangeEventData=function(){var e=this.pageConfig();return e.is_back=0,e},e.prototype.pageConfig=function(){var e="";try{e=document.referrer?document.referrer:this.storage.getItem("__tea_cache_refer_key")||""}catch(e){}return{is_html:1,url:location.href,referrer:e,page_key:location.href,refer_page_key:e,page_manual_key:"",refer_page_manual_key:""}},e.prototype.sendPv=function(e){this.fncArray.forEach((function(t){t(e)}))},e}(),Ce=function(e){for(var t=0,n=0,r=(e+="").length,i=0;i<r;i++)((t=31*t+e.charCodeAt(n++))>0x7fffffffffff||t<-0x800000000000)&&(t&=0xffffffffffff);return t<0&&(t+=0x7ffffffffffff),t},ke=P(["init","config","send","start","predefinePageView","beconEvent","on","clearEventCache","resetStayDuration","autoInitializationRangers","setWebIDviaUnionID","setWebIDviaOpenID","filterEvent"],["profileSet","profileSetOnce","profileIncrement","profileUnset","profileAppend","getVar","getAbSdkVersion","onAbSdkVersionChange","offAbSdkVersionChange","getABconfig","openOverlayer","closeOverlayer","getAllVars","setExternalAbVersion","getToken","destroy"]),Re=(Se=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return Se+=1}),Te=function(){function e(e){var t=this;this.is_first_time=!1,this.Native=!1,this.staging=!1,this.sdkload=!1,this.initPv=!0,this.predefinePageView=function(e,n){if(void 0===e&&(e={}),t.sdkload){var r={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+t.is_first_time},i=A({},r,e);n?t.beconEvent("predefine_pageview",i,"pv"):t.event("predefine_pageview",i,"pv")}else t.logger.warn("sdk init error, api can not call")},this.getToken=function(e,t){},this.name=e,this._isSend=!1,this.hook=new me,this.storage=new z(!1)}return e.prototype.autoInitializationRangers=function(e){e&&e.app_id&&(this.autoBase=!0,function(e){var t=e.app_id,n=e.channel,r=e.onTokenReady,i=""+re(F[n])+G,o=new z(!1),s=X(t,!0),a=o.getItem(s);a&&a.web_id?r(a.web_id):ee(i,3e3,{app_key:"",app_id:t,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer},"",(function(e){if(e&&0===e.e){r(e.web_id);var t={web_id:e.web_id,ssid:e.ssid,user_unique_id:e.web_id,timestamp:Date.now()};o.setItem(s,t)}else r("")}),(function(){r("")}),!0)}(e))},e.prototype.init=function(e){var t=this;if(!this.autoBase&&!this._inited)if(this._inited=!0,e&&"object"==typeof e){this.logger=new pe(this.name,e.log);var n=e.app_id,r=e.app_key;r||n?n&&"number"!=typeof n?this.logger.warn("app_id param is error, must be number, please check !!!"):r&&"string"!=typeof r?this.logger.warn("app_key is empty, please check!"):(e.channel_domain||-1!==["cn","sg","va"].indexOf(e.channel)||(this.logger.warn("channel must be `cn`, `sg`,`va` !!!"),e.channel="cn"),this.Native=e.Native,this._initConfig=e,this.appBridge=new be(this.logger),this.storage.getItem("__tea_cache_first_"+n)?this.is_first_time=!1:(this.is_first_time=!0,this.storage.setItem("__tea_cache_first_"+n,"1")),this.sdkload=!0,e.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted((function(n){n||t._init(e)})):this._init(e)):this.logger.warn("no app_key or app_id please check !!!")}else console.warn("init params is error,please check")},e.prototype._init=function(e){var t=this;this.autoPV=!0,this.sdkload=!0,this._initConfig=e,this._config=new he(e.app_id,e,e.configPersist||0),this.configPersist=e.configPersist||0,this._config.set("app_id",e.app_id),this.hook.on("token-ready",(function(){t.callbackSend?t._isSend?t._event&&t._event.report():t.start():t._event&&t._event.report()})),this._session=new _e(e.app_key||e.app_id,e),this._token=new se(e,this._config,this.hook,this._session),this._event=new ce(this,e,this._config,this._token,this.plugin,this._session,this.match),this.tracer=new ye(this,e,this._processEvent.bind(this),this._event),this.spaView=new we(e),this._token._getToken()},e.prototype.config=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted((function(n){if(n)for(var r in e)"user_unique_id"===r?t.appBridge.setUserUniqueId(e[r]):e[r]?t.appBridge.addHeaderInfo(r,e[r]):t.appBridge.removeHeaderInfo(r);else t._setConfig(e)})):this._setConfig(e):this.logger.warn("sdk init error, api can not call")},e.prototype._setConfig=function(e){if(!this.autoBase)if(this._inited)if(e&&"object"==typeof e){e.disable_auto_pv&&(this.autoPV=!1,delete e.disable_auto_pv),e._staging_flag&&1===e._staging_flag&&(this.staging=!0);var t=A({},e);if(this.configPersist){var n=this._config.getStore();n&&(t=Object.assign(n,e)),this._config.setStore(e)}for(var r in t)"user_unique_id"!==r?"web_id"!==r?this._config.set(r,t[r]):this._token._setWebid(t[r]):this._token._setUuid(t[r])}else this.logger.warn("config params is error, please check");else this.logger.warn("config must be use after function init")},e.prototype.on=function(e,t){try{e&&"string"==typeof e&&"function"==typeof t&&this.hook.on(e,t)}catch(e){}},e.prototype.send=function(){this.start()},e.prototype.start=function(){var e=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted((function(t){t?(e.logger.info("jsbrige开启，事件将由原生 sdk进行上报"),e.predefinePageView()):e._start()})):this._start():this.logger.warn("sdk init error, api can not call")},e.prototype._start=function(){var e=this;if(!this.autoBase)if(this._token.isTokenReady()){if(this._isSend)return void this.logger.warn("method start can not be use over one time , please check !!");this._isSend=!0,this.logger.info("userInfo:"+JSON.stringify(this._config.get("user"))),this.logger.info("sdk is ready,version is 4.2.9. you can report now !!!"),this._event.setReady(),this.autoPV&&(this.predefinePageView(),this.initPv=!1),this._initConfig.spa&&this.spaView.add("spa",this.predefinePageView),this.hook.on("token-change",(function(t){e.initPv||"webid"!==t||e._initConfig.enable_custom_webid||e.predefinePageView({},!0),e.logger.info("token change, new userinfo:"+JSON.stringify(e._config.get("user")))}));try{(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(e){}}else this.callbackSend=!0},e.prototype.beconEvent=function(e,t,n){var r=this;void 0===t&&(t={});var i=n||"log",o=[];o.push([e,t]),o=o.map((function(e){return r._processEvent(e[0],e[1])})),this._dealEvent(!0,o,i),this._addTracerCount(i)},e.prototype.event=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(this.sdkload){var r=D(t,1)[0],i=[];"Array"!==Object.prototype.toString.call(r).slice(8,-1)?i[0]=t:i=t,i=i.map((function(t){return e._processEvent(t[0],t[1])})),this._dealEvent(!1,i,"log"),this._addTracerCount("log")}else this.logger.warn("sdk init error, api can not call")},e.prototype._dealEvent=function(e,t,n){var r=this;if(this.sdkload)if(this.Native&&this.appBridge.bridgeInject()){if("autotrack"===n||"sdk"===n)return;this.appBridge.hasStarted((function(n){n?t&&t.length&&t.forEach((function(e){var t=e.event,n=e.params;r.appBridge.onEventV3(t,JSON.stringify(n))})):r._commonEvent(e,t)}))}else this._commonEvent(e,t);else this.logger.warn("sdk init error, api can not call")},e.prototype._commonEvent=function(e,t){e?this._event.beconEvent(t):this._event.event(t),this._session._updateSessionId()},e.prototype._addTracerCount=function(e){this.sdkload?this.Native||this.staging||this.tracer.addCount(e):this.logger.warn("sdk init error, api can not call")},e.prototype._processEvent=function(e,t){try{var n=e;/^event\./.test(e)&&(n=e.slice(6));var r,i=t;return"object"!=typeof i&&(i={}),i.profile?delete i.profile:i.event_index=Re(),i.local_ms?(r=i.local_ms,delete i.local_ms):r=+new Date,{event:n,params:i,local_time_ms:r,is_bav:this._initConfig.autotrack?1:0}}catch(n){return{event:e,params:t}}},e.prototype.filterEvent=function(e){this.eventFilter=e},e.prototype.clearEventCache=function(){this._event.clearEventCache()},e.prototype.setWebIDviaUnionID=function(e){if(e){var t=Ce(e);this.config({web_id:""+t,wechat_unionid:e}),this.hook.emit("custom-webid")}},e.prototype.setWebIDviaOpenID=function(e){if(e){var t=Ce(e);this.config({web_id:""+t,wechat_openid:e}),this.hook.emit("custom-webid")}},e.prototype.resetStayDuration=function(e,t,n){},e.prototype.profileSet=function(e){},e.prototype.profileSetOnce=function(e){},e.prototype.profileIncrement=function(e){},e.prototype.profileUnset=function(e){},e.prototype.profileAppend=function(e){},e.prototype.setExternalAbVersion=function(e){},e.prototype.getVar=function(e,t,n){},e.prototype.getABconfig=function(e,t){},e.prototype.getAbSdkVersion=function(e){},e.prototype.onAbSdkVersionChange=function(e){},e.prototype.offAbSdkVersionChange=function(e){},e.prototype.openOverlayer=function(){},e.prototype.closeOverlayer=function(){},e.prototype.getAllVars=function(e){},e.prototype.destroy=function(){this.destroyInstance||(this.destroyInstance=!0,this.hook.off("token-ready"))},e}(),Ie=function(e){var t=this;return O(this,"_exportCollect",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t._isProcess?t._executeCmd.apply(t,n):(t.cmdQueue.push(n),t._processCmd())})),O(this,"_processCmd",(function(){if(0!==t.cmdQueue.length){var e,n=function(e,t,n){var r=-1;return e.forEach((function(e,i){(void 0!==n?e[n]:e)===t&&(r=i)})),r};-1===(e=n(t.cmdQueue,"autoInitializationRangers","0"))&&(e=n(t.cmdQueue,"init","0")),-1!==e&&(t._isProcess=!0,t._executeCmd.apply(t,t.cmdQueue[e]),t.cmdQueue.forEach((function(n,r){r!==e&&t._executeCmd.apply(t,n)})),t.cmdQueue=[])}})),O(this,"_executeCmd",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i,o,s=n[0];ke.indexOf(s)>-1?(i=t.colloctor)[s].apply(i,n.slice(1)):(o=t.colloctor).event.apply(o,n)})),this.cmdQueue=[],this.name=e,this.colloctor=new Te(e),this._isProcess=!1,this._alias={},this._processCmd(),ke.forEach((function(e){t._exportCollect[e]=t._exportCollect.bind(t,e)})),this._exportCollect},Oe="[veGame]",Ae={cn:"rtc.bytedance.com"},De="https://veGame.volcengineapi.com",Pe="https://acep.volcengineapi.com",xe={CLOUD_PHONE_GAME:0,CLOUD_PHONE:1,CLOUD_PC:2},Me={DOWN:0,UP:1,MOVE:2,TOUCH_START:0,TOUCH_END:1,TOUCH_MOVE:2,WHEEL:3},Le={LEFT:0,RIGHT:1,CENTER:2},je={KEYCODE_HOME:3,KEYCODE_BACK:4,KEYCODE_VOLUME_UP:24,KEYCODE_VOLUME_DOWN:25,KEYCODE_POWER:26,KEYCODE_MENU:82,KEYCODE_ALT_LEFT:57,KEYCODE_ALT_RIGHT:58,KEYCODE_SHIFT_LEFT:59,KEYCODE_SHIFT_RIGHT:60,KEYCODE_TAB:61,KEYCODE_SPACE:62,KEYCODE_ENTER:66,KEYCODE_DEL:67,KEYCODE_BACKSLASH:73,KEYCODE_CAPS_LOCK:115,KEYCODE_APP_SWITCH:187},Ne={KEYCODE_BUTTON_A:96,KEYCODE_BUTTON_B:97,KEYCODE_BUTTON_X:99,KEYCODE_BUTTON_Y:100,KEYCODE_BUTTON_START:108,KEYCODE_BUTTON_SELECT:109,KEYCODE_BUTTON_L1:102,KEYCODE_BUTTON_R1:103,KEYCODE_BUTTON_L2:104,KEYCODE_BUTTON_R2:105,KEYCODE_BUTTON_THUMBL:106,KEYCODE_BUTTON_THUMBR:107,KEYCODE_DPAD_UP:19,KEYCODE_DPAD_DOWN:20,KEYCODE_DPAD_LEFT:21,KEYCODE_DPAD_RIGHT:22,KEYCODE_DPAD_UP_LEFT:268,KEYCODE_DPAD_DOWN_LEFT:269,KEYCODE_DPAD_UP_RIGHT:270,KEYCODE_DPAD_DOWN_RIGHT:271};function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){ze(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ze(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ge=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),I()(this),this.userId=t.userId,this.commonParams={},this.startEventTime=null,this.teaLog=new Ie("tracker"),this.teaLog.init({app_id:3138,channel:"cn",channel_domain:"https://vegamemon.volces.com/event/collect",log:!1,disable_sdk_monitor:!0}),this.teaLog.config({evtParams:{SDKVersion:"1.9.0"},user_unique_id:this.userId,disable_auto_pv:!0}),this.teaLog.start()}var t,n,r;return t=e,(n=[{key:"setCommonParams",value:function(e){this.commonParams=Object.assign(this.commonParams,Ue({},e))}},{key:"send",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ue(Ue({ts:(new Date).getTime()},t),this.commonParams);this.emit("logger",{eventName:e,eventParams:n}),this.teaLog(e,n)}}])&&Fe(t.prototype,n),r&&Fe(t,r),e}(),He={ERROR_START_AUTHENTICATION_FAILED:{CODE:10001,MESSAGE:"ERROR_START_AUTHENTICATION_FAILED"},ERROR_START_GENERAL:{CODE:1e4,MESSAGE:"ERROR_START_GENERAL"},ERROR_START_GAME_ID_OR_CUSTOM_GAME_ID_NOT_EXIST:{CODE:10002,MESSAGE:"ERROR_START_GAME_ID_OR_CUSTOM_GAME_ID_NOT_EXIST"},ERROR_START_GAME_ID_NOT_READY:{CODE:10003,MESSAGE:"ERROR_START_GAME_ID_NOT_READY"},ERROR_START_CONFIGURATION_CODE_NOT_EXIST:{CODE:10004,MESSAGE:"ERROR_START_CONFIGURATION_CODE_NOT_EXIST"},ERROR_START_CONFIGURATION_CODE_NOT_REDAY:{CODE:10006,MESSAGE:"ERROR_START_CONFIGURATION_CODE_NOT_REDAY"},ERROR_START_RESOURCE_NOT_READY:{CODE:10006,MESSAGE:"ERROR_START_RESOURCE_NOT_READY"},ERROR_START_RESOURCE_CAPACITY_NOT_ENOUGH:{CODE:10007,MESSAGE:"ERROR_START_RESOURCE_CAPACITY_NOT_ENOUGH"},ERROR_START_STREAM_AUTO_PLAY_FAILED:{CODE:10008,MESSAGE:"ERROR_START_STREAM_AUTO_PLAY_FAILED"},ERROR_START_AUTHENTICATION_KEY_FAILED:{CODE:10009,MESSAGE:"ERROR_START_AUTHENTICATION_KEY_FAILED"},ERROR_START_RESERVED_ID_NOT_FOUND:{CODE:10012,MESSAGE:"ERROR_START_RESERVED_ID_NOT_FOUND"},ERROR_START_RESERVED_ID_EXPIRED:{CODE:10013,MESSAGE:"ERROR_START_RESERVED_ID_EXPIRED"},ERROR_START_RESERVED_ID_ALREADY_USED_RELEASE:{CODE:10014,MESSAGE:"ERROR_START_RESERVED_ID_ALREADY_USED_RELEASE"},ERROR_START_RESERVED_ID_USING:{CODE:10015,MESSAGE:"ERROR_START_RESERVED_ID_USING"},ERROR_START_RESERVED_ID_MISMATCH_PREPARE:{CODE:10016,MESSAGE:"ERROR_START_RESERVED_ID_MISMATCH_PREPARE"},ERROR_START_NO_SUFFICIENT_FUND:{CODE:10017,MESSAGE:"ERROR_START_NO_SUFFICIENT_FUND"},ERROR_START_MUILT_DEVICE_CONFLICT:{CODE:10018,MESSAGE:"ERROR_START_MUILT_DEVICE_CONFLICT"},ERROR_STREAM_GENERAL:{CODE:2e4,MESSAGE:"ERROR_STREAM_GENERAL"},ERROR_STREAM_CONNECTION_FAILED:{CODE:20001,MESSAGE:"ERROR_STREAM_CONNECTION_FAILED"},ERROR_MESSAGE_GENERAL:{CODE:5e4,MESSAGE:"ERROR_MESSAGE_GENERAL"},ERROR_MESSAGE_NOT_READY:{CODE:50001,MESSAGE:"ERROR_MESSAGE_NOT_READY"},ERROR_MESSAGE_OVER_SIZED:{CODE:50007,MESSAGE:"ERROR_MESSAGE_OVER_SIZED"},ERROR_MESSAGE_NOT_CONNECTED:{CODE:50008,MESSAGE:"ERROR_MESSAGE_NOT_CONNECTED"},ERROR_MESSAGE_CONNECT_FAILED:{CODE:50002,MESSAGE:"ERROR_MESSAGE_CONNECT_FAILED"},ERROR_MESSAGE_DISCONNECT:{CODE:50003,MESSAGE:"ERROR_MESSAGE_DISCONNECT"},ERROR_MESSAGE_FAILED:{CODE:50004,MESSAGE:"ERROR_MESSAGE_FAILED"},ERROR_MESSAGE_NOT_CLOUD_RUNTIME:{CODE:50005,MESSAGE:"ERROR_MESSAGE_NOT_CLOUD_RUNTIME"},ERROR_MESSAGE_CONNECT_VERIFY_FAILED:{CODE:50006,MESSAGE:"ERROR_MESSAGE_CONNECT_VERIFY_FAILED"},ERROR_SDK_INIT_FAILED:{CODE:30001,MESSAGE:"ERROR_SDK_INIT_FAILED"},ERROR_PARAM_IS_EMPTY:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{CODE:30002,MESSAGE:"ERROR_SDK_".concat(e,"_EMPTY")}},ERROR_SDK_GENERAL:{CODE:3e4,MESSAGE:"ERROR_SDK_GENERAL"},ERROR_PARAM_IS_ERROR:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{CODE:50006,MESSAGE:"ERROR_SDK_".concat(e,"_ERROR")}},ERROR_GAME_VIDEO_STREAM_PROFILE_NOT_IN_RANGE:{CODE:200005,MESSAGE:"ERROR_GAME_VIDEO_STREAM_PROFILE_NOT_IN_RANGE"}},Ke={CODE:4e4,MESSAGE:"ERROR_GAME_ABNORMAL_EXIT"},Ve={CODE:40001,MESSAGE:"ERROR_GAME_CRASH"},qe={CODE:40002,MESSAGE:"ERROR_GAME_OFFLINE"},We={CODE:40003,MESSAGE:"ERROR_GAME_EXIT_TIMEOUT"},Ye={CODE:40004,MESSAGE:"ERROR_GAME_STOPPED_IDLE"},Je={CODE:40005,MESSAGE:"ERROR_GAME_STOPPED_RESET"},$e={CODE:40007,MESSAGE:"ERROR_GAME_STOPPED_DUPLICATE_START"},Xe={CODE:40010,MESSAGE:"ERROR_GAME_ALREADY_STOPPED"},Ze={CODE:50008,MESSAGE:"ERROR_MESSAGE_NOT_CONNECTED"},Qe={CODE:40014,MESSAGE:"MESSAGE_RESOURCE_OFFLINE"},et={CODE:40015,MESSAGE:"MESSAGE_RESOURCE_UPDATING"},tt={CODE:40016,MESSAGE:"MESSAGE_RESOURCE_REBOOTING"},nt={CODE:40017,MESSAGE:"MESSAGE_RESOURCE_MAINTANENCE"},rt={CODE:40018,MESSAGE:"MESSAGE_RESOURCE_SERVICE_UPDATING"},it={CODE:40019,MESSAGE:"MESSAGE_RESOURCE_OCCUPIED"},ot={CODE:40020,MESSAGE:"MESSAGE_RESOURCE_LAUNCHING_GAME"},st={CODE:40021,MESSAGE:"MESSAGE_RESOURCE_IS_RUNNING"},at={CODE:40022,MESSAGE:"MESSAGE_RESOURCE_IS_PUBLISH"},ct={CODE:40023,MESSAGE:"MESSAGE_RESOURCE_RELEASED_NORMAL"},ut={CODE:40024,MESSAGE:"MESSAGE_RESOURCE_RELEASED_NO_USER"},dt={CODE:40025,MESSAGE:"MESSAGE_RESOURCE_RELEASED_IDLE"},lt={CODE:40026,MESSAGE:"MESSAGE_RESOURCE_RELEASED_OS_MISSED"},ft={CODE:40027,MESSAGE:"MESSAGE_RESOURCE_RELEASED_GAME_START_FAILURE"},ht={CODE:40029,MESSAGE:"MESSAGE_RESOURCE_RELEASED_3RD_APP_MISSED"},pt={CODE:40030,MESSAGE:"MESSAGE_RESOURCE_ERROR"},mt={CODE:40031,MESSAGE:"MESSAGE_3RD_APP_START_FAILURE"},vt={CODE:40032,MESSAGE:"MESSAGE_CLOUD_GAME_CRASH_OFTEN"},_t={CODE:40033,MESSAGE:"MESSAGE_GAME_STEAMING_FAILURE"},gt=n(1),yt=n.n(gt);function bt(e){var t=e.keyCode,n=e.shiftKey,r=e.crtlKey,i=e.metaKey;if(t>=65&&t<=90)return(r||i)&&86===t?null:n||i?-1:t-36;if(t>=48&&t<=57)return n?-1:t-41;if(192===t||187===t||189===t||219===t||221===t||220===t||186===t||222===t||188===t||190===t||191===t)return-1;switch(t){case 32:return je.KEYCODE_SPACE;case 13:return je.KEYCODE_ENTER;case 8:return je.KEYCODE_DEL;case 20:return je.KEYCODE_CAPS_LOCK;case 16:return je.KEYCODE_SHIFT_LEFT}}function Et(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).map((function(t){return"".concat(t,"=").concat(e[t])})).join("&")}function St(e){e=e||32;for(var t="0123456789",n=t.length,r="",i=0;i<e;i++)r+=t.charAt(Math.floor(Math.random()*n));return r}var wt=function(e){var t,n;switch(e){case 100026:t=He.ERROR_START_AUTHENTICATION_KEY_FAILED.CODE,n=He.ERROR_START_AUTHENTICATION_KEY_FAILED.MESSAGE;break;case 7e5:case 700001:case 700002:case 71e4:t=He.ERROR_START_AUTHENTICATION_FAILED.CODE,n=He.ERROR_START_AUTHENTICATION_FAILED.MESSAGE;break;case 3e6:t=He.ERROR_START_GENERAL.CODE,n=He.ERROR_START_GENERAL.MESSAGE;break;case 3530001:t=He.ERROR_START_GAME_ID_OR_CUSTOM_GAME_ID_NOT_EXIST.CODE,n=He.ERROR_START_GAME_ID_OR_CUSTOM_GAME_ID_NOT_EXIST.MESSAGE;break;case 3530002:t=He.ERROR_START_GAME_ID_NOT_READY.CODE,n=He.ERROR_START_GAME_ID_NOT_READY.MESSAGE;break;case 3561001:t=He.ERROR_START_RESERVED_ID_NOT_FOUND.CODE,n=He.ERROR_START_RESERVED_ID_NOT_FOUND.MESSAGE;break;case 3561002:t=He.ERROR_START_RESERVED_ID_EXPIRED.CODE,n=He.ERROR_START_RESERVED_ID_EXPIRED.MESSAGE;break;case 3561003:t=He.ERROR_START_RESERVED_ID_ALREADY_USED_RELEASE.CODE,n=He.ERROR_START_RESERVED_ID_ALREADY_USED_RELEASE.MESSAGE;break;case 3561004:t=He.ERROR_START_RESERVED_ID_USING.CODE,n=He.ERROR_START_RESERVED_ID_USING.MESSAGE;break;case 3561005:t=He.ERROR_START_RESERVED_ID_MISMATCH_PREPARE.CODE,n=He.ERROR_START_RESERVED_ID_MISMATCH_PREPARE.MESSAGE;break;case 3200002:t=He.ERROR_START_NO_SUFFICIENT_FUND.CODE,n=He.ERROR_START_NO_SUFFICIENT_FUND.MESSAGE;break;case 600003:t=He.ERROR_START_CONFIGURATION_CODE_NOT_EXIST.CODE,n=He.ERROR_START_CONFIGURATION_CODE_NOT_EXIST.MESSAGE;break;case 3560001:case 3560002:t=He.ERROR_START_CONFIGURATION_CODE_NOT_REDAY.CODE,n=He.ERROR_START_CONFIGURATION_CODE_NOT_REDAY.MESSAGE;break;case 3560005:t=He.ERROR_START_RESOURCE_NOT_READY.CODE,n=He.ERROR_START_RESOURCE_NOT_READY.MESSAGE;break;case 3560006:case 3560008:t=He.ERROR_START_RESOURCE_CAPACITY_NOT_ENOUGH.CODE,n=He.ERROR_START_RESOURCE_CAPACITY_NOT_ENOUGH.MESSAGE;break;case"ERROR_STATUS":case"ERROR_BYTE_RTC_ERROR":t=He.ERROR_STREAM_GENERAL.CODE,n=He.ERROR_STREAM_GENERAL.MESSAGE;break;case 300002:case 300003:t=He.ERROR_STREAM_CONNECTION_FAILED.CODE,n=He.ERROR_STREAM_CONNECTION_FAILED.MESSAGE;break;default:t=He.ERROR_START_GENERAL.CODE,n=He.ERROR_START_GENERAL.MESSAGE}return{errorCode:t,message:n}},Ct=function(e,t){var n=e.isDebug,r=e.gameHost,i=e.reservedId,o=e.stsToken;return new Promise((function(e,s){var a={Action:"GetResourceStatus",Version:"2022-02-10",reserved_id:i},c=Et(a),u=o.AccessKeyID,d=o.SecretAccessKey,l=o.SessionToken,f=(o.CurrentTime,{method:"GET",url:"".concat(r||De,"?").concat(c),timeout:3e4,region:"cn-north-1",body:"",params:a,headers:{"Content-Type":"application/json"}});new yt.a(f,"veGame",{isVolcengine:!0}).addAuthorization({accessKeyId:u,secretAccessKey:d,sessionToken:l},new Date),fetch(f.url,{method:f.method,headers:f.headers,mode:"cors"}).then((function(e){return e.json()})).then((function(r){t.send("getResourceStatusRequest",{request:f,response:r});var i=r.Result,o=r.ResponseMetadata;if(i){var a=function(e){var t,n;switch(e){case 1:t=Qe.CODE,n=Qe.MESSAGE;break;case 3:t=et.CODE,n=et.MESSAGE;break;case 4:t=tt.CODE,n=tt.MESSAGE;break;case 6:t=nt.CODE,n=nt.MESSAGE;break;case 9:t=rt.CODE,n=rt.MESSAGE;break;case 768:t=it.CODE,n=it.MESSAGE;break;case 769:t=ot.CODE,n=ot.MESSAGE;break;case 770:t=st.CODE,n=st.MESSAGE;break;case 771:t=at.CODE,n=at.MESSAGE;break;case 784:t=ct.CODE,n=ct.MESSAGE;break;case 785:t=ut.CODE,n=ut.MESSAGE;break;case 786:t=dt.CODE,n=dt.MESSAGE;break;case 787:t=lt.CODE,n=lt.MESSAGE;break;case 788:t=ft.CODE,n=ft.MESSAGE;break;case 789:t=He.MESSAGE_RESOURCE_RELEASED_STREAMING_ERROR.CODE,n=He.MESSAGE_RESOURCE_RELEASED_STREAMING_ERROR.MESSAGE;break;case 790:t=ht.CODE,n=ht.MESSAGE;break;case 1024:t=pt.CODE,n=pt.MESSAGE;break;case 1025:t=mt.CODE,n=mt.MESSAGE;break;case 1027:t=vt.CODE,n=vt.MESSAGE;break;case 1028:t=_t.CODE,n=_t.MESSAGE;break;default:t=Ke.CODE,n=Ke.MESSAGE}return{errorCode:t,message:n}}(i.instance_status),c=a.errorCode,u=a.message;e({errorCode:c,message:u})}else if(o&&o.Error){var d=o.Error.CodeN,l=o.Error.Message,h=o.RequestId,p=wt(d),m=p.errorCode,v=p.message;n&&console.log(Oe,"GetResourceStatus error: ","GetResourceStatus Response.Error error",r),s({originalErrorCode:d,originalMessage:l,requestId:h,errorCode:m,message:v})}else n&&console.log(Oe,"GetResourceStatus error: ","GetResourceStatus api request error",r),s({errorCode:He.ERROR_SDK_GENERAL.CODE,message:He.ERROR_SDK_GENERAL.MESSAGE})})).catch((function(e){n&&console.log(Oe,"GetResourceStatus error: ",e),s({errorCode:He.ERROR_SDK_GENERAL.CODE,message:He.ERROR_SDK_GENERAL.MESSAGE,originalMessage:"unknow network error"})}))}))},kt=0,Rt=1,Tt=2,It=3,Ot=8,At=9,Dt=10,Pt=12,xt=16,Mt=20,Lt=21,jt=512,Nt=0,Bt=1,Ut=3,zt=4,Ft=6,Gt=10,Ht=11,Kt=12,Vt=14,qt=17,Wt=20,Yt=21,Jt=22,$t=23;function Xt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Zt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"eventTypeClipboard",value:function(e){return{op_type:qt,event_data:{mimeType:"text/plain",clipData:[e]}}}},{key:"eventTypeStartUp",value:function(){return{op_type:Ht,event_data:{local_capabilities:7}}}},{key:"eventTypeAppManager",value:function(e,t){return{op_type:Ft,data:{game_pkg:e,action:t}}}},{key:"eventTypeMouse",value:function(e){var t=e.button,n=e.action,r=e.wheel,i=e.x,o=e.y;return{op_type:Vt,event_data:{action:n,button:t,wheel:r,x:i,y:o}}}},{key:"eventTypeGdapJoystick",value:function(e){var t=e.leftX,n=e.leftY,r=e.rightX,i=e.rightY,o=e.leftT,s=e.rightT,a=e.index,c=void 0===a?0:a;return Object.assign({index:c,op_type:Gt},{event_data:{left_x:t,left_y:n,right_x:r,right_y:i,left_t:o,right_t:s}})}},{key:"eventTypeOrientation",value:function(){return{op_type:zt}}},{key:"eventTypeLocation",value:function(e){var t=e.timestamp,n=e.latitude,r=e.altitude,i=e.longitude,o=e.speed,s=e.accuracy,a=e.altitudeAccuracy;return{op_type:Kt,event_data:{provider:"gps",time:t,elapsedRealtimeNanos:1e3*t*1e3,latitude:n,altitude:r||0,longitude:i,speed:o||0,bearing:0,accuracyMeters:s||0,verticalAccuracyMeters:a||0,speedAccuracyMetersPerSecond:0,bearingAccuracyDegrees:0}}}},{key:"eventTypeInputMethod",value:function(e){var t=e.inputContext,n=e.actionId;return{op_type:Ut,event_data:{charSequence:encodeURIComponent(t),actionId:n,encoder:"UTF-8"}}}},{key:"eventTypeKey",value:function(e){var t=e.keycode,n=e.action,r=e.index,i=e.value,o={op_type:Bt,event_data:{action:n,key_code:t}};return void 0!==r&&(o.index=r),void 0!==i&&o.event_data&&(o.event_data.value=i),o}},{key:"eventTypeKeyCustom",value:function(e){var t=e.keycode,n=e.action;return{op_type:Bt,event_data:{action:n,key_code:t}}}},{key:"eventTypeClarityIndex",value:function(e){var t=e.id;return{op_type:Wt,event_data:{clarity:t}}}},{key:"eventTypeTouch",value:function(e){var t=e.event_data;return{op_type:Nt,event_data:t}}},{key:"eventTypeRestart",value:function(){return{op_type:Ft,event_data:{action:2}}}},{key:"eventTypeUserStatus",value:function(e){return{op_type:Jt,event_data:{reason:e?0:1}}}},{key:"eventTypeKeepAliveTime",value:function(e){return{op_type:$t,event_data:{duration:e}}}},{key:"veMessage",value:function(e){var t=e.payload,n=e.userId,r=e.needAck,i=void 0!==r&&r,o=(new Date).getTime();return{op_type:Yt,event_data:{message:{mid:o.toString()+St(4),text:t,time:o},type:i?0:3,user_id:n}}}},{key:"veMessageReadyResponse",value:function(e){var t=e.userId;return{op_type:Yt,event_data:{type:4,user_id:t}}}}],(n=null)&&Xt(t.prototype,n),r&&Xt(t,r),e}();function Qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var en=function(){function e(t,n){var r=n.domId,i=n.mode,o=n.isPC,s=void 0!==o&&o,a=n.disableInteraction,c=void 0!==a&&a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._player=t,this.domId=r,this.mode=i,this.isPC=s,this.disableInteraction=c,this.touchElement=document.getElementById(r),this.customTouchesList={},this.isMouseDown=!1,this.podUserId=null,this.podWidth=null,this.podHeight=null,this.streamWidth=null,this.streamHeight=null,this.scale=null,this.degree=null,this.rotation=null,this._initEvent()}var t,n,r;return t=e,(n=[{key:"setDegree",value:function(e){this.degree=e%360}},{key:"setRotation",value:function(e){this.rotation=e%360}},{key:"_initEvent",value:function(){this.disableInteraction||(this.mode===xe.CLOUD_PHONE||this.mode===xe.CLOUD_PHONE_GAME?this.isPC?(this.touchElement.addEventListener("mousedown",this.mouseDown.bind(this)),this.touchElement.addEventListener("mouseup",this.mouseUp.bind(this)),this.touchElement.addEventListener("mousemove",this.mouseMove.bind(this)),this.touchElement.addEventListener("contextmenu",this.contextListener.bind(this)),this.touchElement.addEventListener("mouseleave",this.mouseUp.bind(this)),this.mode===xe.CLOUD_PHONE&&(document.addEventListener("keydown",this.keydown.bind(this)),document.addEventListener("keyup",this.keyup.bind(this)),document.addEventListener("paste",this.pasteEvent.bind(this)))):(this.touchElement.addEventListener("touchstart",this.touchStart.bind(this)),this.touchElement.addEventListener("touchend",this.touchEnd.bind(this)),this.touchElement.addEventListener("touchmove",this.touchMove.bind(this))):this.mode===xe.CLOUD_PC&&(this.touchElement.addEventListener("mousedown",this.mouseDown.bind(this)),this.touchElement.addEventListener("mouseup",this.mouseUp.bind(this)),this.touchElement.addEventListener("mousemove",this.mouseMove.bind(this)),this.touchElement.addEventListener("mousewheel",this.wheelEvent.bind(this)),this.touchElement.addEventListener("contextmenu",this.contextListener.bind(this))))}},{key:"setStreamSize",value:function(e){var t=e.streamWidth,n=e.streamHeight;e.videoEle,this.streamWidth=t,this.streamHeight=n}},{key:"setContentSize",value:function(e){var t=e.width,n=e.height;t&&(this.podWidth=t),n&&(this.podHeight=n)}},{key:"updateVideoScale",value:function(e){var t=this.podWidth,n=this.podHeight,r=this.streamWidth,i=this.streamHeight;270!==this.rotation&&90!==this.rotation||(t=this.podHeight,n=this.podWidth,r=this.streamHeight,i=this.streamWidth);var o,s=e,a=(r/i).toFixed(6),c=(t/n).toFixed(6),u=(this.touchElement.clientWidth/this.touchElement.clientHeight).toFixed(6);if(c>a&&u>a)if(c>u){var d=r/i*this.touchElement.clientHeight;o=this.touchElement.clientWidth/d}else{var l=n/t*r/i*this.touchElement.clientHeight;o=this.touchElement.clientHeight/l}if(a>c&&a>u)if(c>u){var f=t/n*i/r*this.touchElement.clientWidth;o=this.touchElement.clientWidth/f}else{var h=i/r*this.touchElement.clientWidth;o=this.touchElement.clientHeight/h}if(o){this.scale=Math.ceil(1e5*o)/1e5;var p="scale(".concat(this.scale,")");s.style.transform=p}return{rotationPodWidth:t,rotationPodHeight:n,rotationStreamWidth:r,rotationStreamHeight:i,clientWidth:this.touchElement.clientWidth,clientHeight:this.touchElement.clientHeight,scale:o||1}}},{key:"contextListener",value:function(e){e.preventDefault()}},{key:"touchStart",value:function(e){e.preventDefault(),1===e.touches.length&&this.clearTouchesList();for(var t=Array.from(e.changedTouches),n=this.touchElement.getBoundingClientRect(),r=this.touchElement.clientWidth,i=this.touchElement.clientHeight,o=n.left,s=n.top,a=0;a<t.length;a++){var c=t[a],u=c.clientX-o,d=c.clientY-s,l=this.coordinateScaleAndRotate({width:r,height:i,targetx:u,targety:d,podWidth:this.podWidth,podHeight:this.podHeight}),f=l.x,h=l.y,p="NATIVE_TOUCH_PRE"+c.identifier,m={action:Me.TOUCH_START,pointerId:p,x:f,y:h};this.sendTouchMessage(m)}}},{key:"touchEnd",value:function(e){e.preventDefault();for(var t=Array.from(e.changedTouches),n=this.touchElement.getBoundingClientRect(),r=this.touchElement.clientWidth,i=this.touchElement.clientHeight,o=n.left,s=n.top,a=0;a<t.length;a++){var c=t[a],u=c.clientX-o,d=c.clientY-s,l=this.coordinateScaleAndRotate({width:r,height:i,targetx:u,targety:d,podWidth:this.podWidth,podHeight:this.podHeight}),f=l.x,h=l.y,p="NATIVE_TOUCH_PRE"+c.identifier,m={action:Me.TOUCH_END,pointerId:p,x:f,y:h};this.sendTouchMessage(m)}this._firstClickPlayAudio()}},{key:"touchMove",value:function(e){e.preventDefault();for(var t=Array.from(e.changedTouches),n=this.touchElement.getBoundingClientRect(),r=this.touchElement.clientWidth,i=this.touchElement.clientHeight,o=n.left,s=n.top,a=[],c=0;c<t.length;c++){var u=t[c],d=u.clientX-o,l=u.clientY-s,f=this.coordinateScaleAndRotate({width:r,height:i,targetx:d,targety:l,podWidth:this.podWidth,podHeight:this.podHeight}),h=f.x,p=f.y,m="NATIVE_TOUCH_PRE"+u.identifier;a.push({action:Me.TOUCH_MOVE,pointerId:m,x:h,y:p})}this.sendTouchMessage(a)}},{key:"sendTouchMessage",value:function(e,t){var n=this;return new Promise((function(t,r){var i;i="[object Array]"===Object.prototype.toString.call(e)?e[0].action:e.action;var o=[];if(i===Me.TOUCH_START){var s,a=e.pointerId,c=Object.keys(n.customTouchesList).findIndex((function(e){return n.customTouchesList[e].pointerId===a}));if(c<0){for(var u=0;n.customTouchesList[u];)u++;n.customTouchesList[u]=e,s=u}else s=c,n.customTouchesList[s]=e;var d=Object.keys(n.customTouchesList).length>1?256*s+5:Me.TOUCH_START;Object.keys(n.customTouchesList).forEach((function(e){o.push({action:d,pointerId:e,x:n.customTouchesList[e].x,y:n.customTouchesList[e].y})}))}if(i===Me.TOUCH_MOVE&&Object.keys(n.customTouchesList).forEach((function(t){var r=n.customTouchesList[t].pointerId;"[object Array]"===Object.prototype.toString.call(e)?e.forEach((function(e){r===e.pointerId&&(n.customTouchesList[t]=e)})):r===e.pointerId&&(n.customTouchesList[t]=e),o.push({action:Me.TOUCH_MOVE,pointerId:t,x:n.customTouchesList[t].x,y:n.customTouchesList[t].y})})),i===Me.TOUCH_END){var l=e.pointerId,f=Object.keys(n.customTouchesList).find((function(e){return n.customTouchesList[e].pointerId===l}));f<0&&r();var h=Object.keys(n.customTouchesList).length>1?256*f+6:Me.TOUCH_END;Object.keys(n.customTouchesList).forEach((function(t){n.customTouchesList[t].pointerId===l&&(n.customTouchesList[t]=e),o.push({action:h,pointerId:t,x:n.customTouchesList[t].x,y:n.customTouchesList[t].y})})),delete n.customTouchesList[f]}var p=Zt.eventTypeTouch({event_data:o});n._player._sendCustomMessage(p).then((function(){t()})).catch((function(e){r(e)}))}))}},{key:"mouseDown",value:function(e){if(this.mode===xe.CLOUD_PC){var t=this.touchElement.getBoundingClientRect(),n=this.mouseConvertPC({event:e,action:Me.DOWN,width:this.touchElement.clientWidth,height:this.touchElement.clientHeight,offsetLeft:t.left,offsetTop:t.top,button:0});this._player._sendCustomMessage(n)}else{if(2===e.button)return;this.isMouseDown=!0;var r=this.mouseConvert(e,Me.DOWN);this.sendTouchMessage(r)}this._firstClickPlayAudio()}},{key:"mouseMove",value:function(e){if(this.mode===xe.CLOUD_PC){var t=this.touchElement.getBoundingClientRect(),n=this.mouseConvertPC({event:e,action:Me.MOVE,width:this.touchElement.clientWidth,height:this.touchElement.clientHeight,offsetLeft:t.left,offsetTop:t.top});this._player._sendCustomMessage(n)}else{if(2===e.button)return;if(!this.isMouseDown)return;var r=this.mouseConvert(e,Me.MOVE);this.sendTouchMessage(r)}}},{key:"mouseUp",value:function(e){if(this.mode===xe.CLOUD_PC){var t=this.touchElement.getBoundingClientRect(),n=this.mouseConvertPC({event:e,action:Me.UP,width:this.touchElement.clientWidth,height:this.touchElement.clientHeight,offsetLeft:t.left,offsetTop:t.top});this._player._sendCustomMessage(n)}else{if(2===e.button)return;if(!this.isMouseDown)return;this.isMouseDown=!1;var r=this.mouseConvert(e,Me.UP);this.sendTouchMessage(r)}}},{key:"mouseConvert",value:function(e,t){var n=this.touchElement.clientWidth,r=this.touchElement.clientHeight,i=this.podWidth,o=this.podHeight,s=this.touchElement.getBoundingClientRect().left,a=this.touchElement.getBoundingClientRect().top,c=e.clientX-s,u=e.clientY-a,d=this.coordinateScaleAndRotate({width:n,height:r,targetx:c,targety:u,podWidth:i,podHeight:o}),l={x:d.x,y:d.y};return l.action=t,l.pointerId="NATIVE_MOUSE_PREA0",l}},{key:"wheelEvent",value:function(e){var t=this.touchElement.getBoundingClientRect(),n=this.mouseConvertPC({event:e,action:Me.WHEEL,width:this.touchElement.clientWidth,height:this.touchElement.clientHeight,offsetLeft:t.left,offsetTop:t.top});this._player._sendCustomMessage(n)}},{key:"mouseConvertPC",value:function(e){var t,n,r=e.event,i=e.action,o=e.width,s=e.height,a=e.offsetLeft,c=e.offsetTop,u=r.clientX-a,d=r.clientY-c,l=this.coordinateScaleAndRotate({width:o,height:s,targetx:u,targety:d,podWidth:this.podWidth,podHeight:this.podHeight}),f=l.x,h=l.y,p=r.button;return i===Me.WHEEL?n=r.deltaY/s:t=1===p?2:2===p?1:0,Zt.eventTypeMouse({button:t,action:i,wheel:n,x:f,y:h})}},{key:"coordinateScaleAndRotate",value:function(e){var t,n,r,i,o=e.width,s=e.height,a=e.targetx,c=e.targety,u=e.podWidth,d=e.podHeight,l=this.degree,f=u,h=d,p=o,m=s;if(270!==this.rotation&&90!==this.rotation||(f=d,h=u),90===l||270===l){var v=f;f=h,h=v,v=p,p=m,m=v}return f&&h?f/h>p/m?(t=a/(i=p),n=(c-(m-(r=parseInt(h/f*i)))/2)/r):(r=m,t=(a-(p-(i=parseInt(f/h*r)))/2)/i,n=c/r):(t=a/p,n=c/m),90===l?{x:n.toFixed(6),y:(1-t).toFixed(6)}:180===l?{x:(1-t).toFixed(6),y:(1-n).toFixed(6)}:270===l?{x:(1-n).toFixed(6),y:t.toFixed(6)}:{x:t.toFixed(6),y:n.toFixed(6)}}},{key:"keydown",value:function(e){var t=bt(e);if(t&&-1!==t){var n=Zt.eventTypeKey({action:Me.DOWN,key_code:t});this._player._sendCustomMessage(n)}}},{key:"keyup",value:function(e){var t=bt(e);if(t)if(-1===t){var n=Zt.eventTypeKey({action:Me.UP,key_code:-1,value:e.key&&encodeURIComponent(e.key)});this._player._sendCustomMessage(n)}else{var r=Zt.eventTypeKey({action:Me.UP,key_code:t});this._player._sendCustomMessage(r)}}},{key:"pasteEvent",value:function(e){var t=(e.clipboardData||window.clipboardData).getData("text"),n=Zt.eventTypeKey({action:Me.UP,key_code:-1,value:encodeURIComponent(t||"")});this._player._sendCustomMessage(n),e.preventDefault()}},{key:"_firstClickPlayAudio",value:function(){this._player._needFirstClickPlayAudio&&(this._player._needFirstClickPlayAudio=!1,this._player._setAudioMute(!1))}},{key:"clearTouchesList",value:function(){this.customTouchesList={}}},{key:"destroy",value:function(){this.mode===xe.CLOUD_PHONE||this.mode===xe.CLOUD_PHONE_GAME?this.isPC?(this.touchElement.removeEventListener("mousedown",this.mouseDown.bind(this)),this.touchElement.removeEventListener("mouseup",this.mouseUp.bind(this)),this.touchElement.removeEventListener("mousemove",this.mouseMove.bind(this)),this.touchElement.removeEventListener("contextmenu",this.contextListener.bind(this)),this.touchElement.removeEventListener("mouseleave",this.mouseUp.bind(this)),this.mode===xe.CLOUD_PHONE&&(document.removeEventListener("keydown",this.keydown.bind(this)),document.removeEventListener("keyup",this.keyup.bind(this)),document.removeEventListener("paste",this.pasteEvent.bind(this)))):(this.touchElement.removeEventListener("touchstart",this.touchStart.bind(this)),this.touchElement.removeEventListener("touchend",this.touchEnd.bind(this)),this.touchElement.removeEventListener("touchmove",this.touchMove.bind(this))):this.mode===xe.CLOUD_PC&&(this.touchElement.removeEventListener("mousedown",this.mouseDown.bind(this)),this.touchElement.removeEventListener("mouseup",this.mouseUp.bind(this)),this.touchElement.removeEventListener("mousemove",this.mouseMove.bind(this)),this.touchElement.removeEventListener("mousewheel",this.wheelEvent.bind(this)),this.touchElement.removeEventListener("contextmenu",this.contextListener.bind(this)))}}])&&Qt(t.prototype,n),r&&Qt(t,r),e}();function tn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var nn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._player=t,this._inputContainerDomId="cc-player-input-container",this._inputDomId="cc-player-input",this._inputMethodData={actionId:"",selectionStart:0,selectionEnd:0},this._isFirstResponseRotation=!0,this.inputCon=this.init()}var t,n,r;return t=e,(n=[{key:"init",value:function(){var e=this,t=document.createElement("div");t.id=this._inputContainerDomId,t.style.position="absolute",t.style.marginRight=8,t.style.width="absolute",t.style.maxWidth="95%",t.style.display="none",t.style.opacity=.01,t.style.left=0,t.style.top=0,t.style.pointerEvents="none";var n=document.createElement("input");return n.id=this._inputDomId,n.autocomplete="off",n.addEventListener("compositionstart",(function(e){e.target.composing=!0})),n.addEventListener("compositionend",(function(e){if(e.target.composing){e.target.composing=!1;var t=new Event("input");e.target.dispatchEvent(t)}})),n.addEventListener("focus",(function(){e._inputMethodData.selectionStart&&e._inputMethodData.selectionEnd&&n.setSelectionRange(e._inputMethodData.selectionStart,e._inputMethodData.selectionEnd)})),n.addEventListener("input",(function(t){if(!t.target.composing){var r=Zt.eventTypeInputMethod({inputContext:n.value,actionId:e._inputMethodData.actionId});e._player._sendCustomMessage(r)}})),t.appendChild(n),this._player.isPC&&document.addEventListener("keydown",(function(t){n.composing||("ArrowLeft"===t.key&&(t.preventDefault(),e._player._sendCustomMessage(Zt.eventTypeKeyCustom({action:0,keycode:21})),e._player._sendCustomMessage(Zt.eventTypeKeyCustom({action:1,keycode:21}))),"ArrowRight"===t.key&&(t.preventDefault(),e._player._sendCustomMessage(Zt.eventTypeKeyCustom({action:0,keycode:22})),e._player._sendCustomMessage(Zt.eventTypeKeyCustom({action:1,keycode:22}))),"ArrowUp"===t.key&&(t.preventDefault(),e._player._sendCustomMessage(Zt.eventTypeKeyCustom({action:0,keycode:19})),e._player._sendCustomMessage(Zt.eventTypeKeyCustom({action:1,keycode:19}))),"ArrowDown"===t.key&&(t.preventDefault(),e._player._sendCustomMessage(Zt.eventTypeKeyCustom({action:0,keycode:20})),e._player._sendCustomMessage(Zt.eventTypeKeyCustom({action:1,keycode:20}))),"Enter"===t.key&&(t.preventDefault(),e._player._sendCustomMessage(Zt.eventTypeKeyCustom({action:0,keycode:66})),e._player._sendCustomMessage(Zt.eventTypeKeyCustom({action:1,keycode:66}))))})),t}},{key:"handleInputMethodEvent",value:function(e){var t=document.getElementById(this._inputContainerDomId),n=document.getElementById(this._inputDomId);e.command===kt&&(t.style.display="block",n.value=decodeURIComponent(e.currentText),this._inputMethodData.actionId=e.data.actionId,this._inputMethodData.selectionStart=e.selectionStart,this._inputMethodData.selectionEnd=e.selectionEnd,n.focus()),e.command===Rt&&(n.value=decodeURIComponent(e.currentText),this._inputMethodData.selectionStart=null,this._inputMethodData.selectionEnd=null,n.focus()),e.command===Tt&&(t.style.display="none",this._inputMethodData.selectionStart=null,this._inputMethodData.selectionEnd=null,n.blur(),n.value="")}},{key:"handleRotationEvent",value:function(e){if(this._isFirstResponseRotation){this._isFirstResponseRotation=!1;var t=Zt.eventTypeOrientation();this._player._sendCustomMessage(t)}}}])&&tn(t.prototype,n),r&&tn(t,r),e}();function rn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var on=function(){function e(t,n){var r=n.isDebug;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._player=t,this._debug=r,this._locationPollFlag=!1}var t,n,r;return t=e,(n=[{key:"handleInputMethodEvent",value:function(e){var t=this;if(navigator.geolocation){if(!this._locationPollFlag&&e.command===At&&"gps"===e.provider){var n=e.interval>100?e.interval:100;this._locationPollFlag=!0,setTimeout((function(){t._getLocation(n)}),n)}this.gpsInterval&&e.command===Dt&&(this._locationPollFlag=!1)}}},{key:"_getLocation",value:function(e){var t=this;navigator.geolocation.getCurrentPosition((function(n){var r=n.coords,i=r.longitude,o=r.latitude,s=r.altitude,a=r.speed,c=r.accuracy,u=r.altitudeAccuracy;t._debug&&console.log(Oe,"longitude: ",i,",latitude: ",o);var d=n.timestamp,l=Zt.eventTypeLocation({timestamp:d,latitude:o,altitude:s,longitude:i,speed:a,accuracy:c,altitudeAccuracy:u});t._player._sendCustomMessage(l),t._locationPollFlag&&setTimeout((function(){t._getLocation(e)}),e)}),(function(e){t._debug&&console.log(Oe,"获取经纬度失败："),t._debug&&console.log(Oe,"error: ",e)}))}}])&&rn(t.prototype,n),r&&rn(t,r),e}();function sn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var an=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._player=t}var t,n,r;return t=e,(n=[{key:"sendClipBoardMessage",value:function(e){var t=Zt.eventTypeClipboard(encodeURIComponent(e));return this._player._sendCustomMessage(t)}},{key:"handleClipboardEvent",value:function(e){var t=(e.data&&e.data.clipData||[]).map((function(e){return decodeURIComponent(e)}));this._player.emit("clipboard-message-received",t)}}])&&sn(t.prototype,n),r&&sn(t,r),e}();function cn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var un=function(){function e(t,n){var r=n.containerDomId,i=n.isDebug;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._player=t,this._debug=i,this._containerDomId=r,this._clipboardText="",this._init()}var t,n,r;return t=e,(n=[{key:"_init",value:function(){var e=this;if(navigator.clipboard){var t=document.getElementById(this._containerDomId);this._player.isPC||t.addEventListener("touchstart",(function(){navigator.clipboard.readText().then((function(t){if(t!==e._clipboardText){e._clipboardText=t;var n=Zt.eventTypeClipboard(t);e._player._sendCustomMessage(n)}})).catch((function(t){e._debug&&console.log(Oe,"clip error: ",t)}))}))}}},{key:"handleClipboardEvent",value:function(e){var t=this,n=e.data&&e.data.clipData[0];navigator.clipboard&&navigator.clipboard.writeText(n).then((function(){t._debug&&console.log(Oe,"clip write success")})).catch((function(e){t._debug&&console.log(Oe,"clip write error: ",e)}))}}])&&cn(t.prototype,n),r&&cn(t,r),e}();function dn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ln=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._player=t}var t,n,r;return t=e,(n=[{key:"handleErrorEvent",value:function(e){var t=null;switch(e.data&&e.data.reason){case 0:t={errorCode:Ve.CODE,message:Ve.MESSAGE};break;case 1:t={errorCode:qe.CODE,message:qe.MESSAGE};break;case 2:t={errorCode:We.CODE,message:We.MESSAGE};break;case 3:t={errorCode:Ye.CODE,message:Ye.MESSAGE};break;case 4:t={errorCode:Je.CODE,message:Je.MESSAGE}}t&&(this._player.logger.send("podError",{errc:t.errorCode,msg:t.message}),this._player.emit("error",t),this._player._stop())}},{key:"handleAudioEvent",value:function(e){var t=e.subcmd;1===t&&this._player._enableLocalAudio(),2===t&&this._player._disableLocalAudio()}}])&&dn(t.prototype,n),r&&dn(t,r),e}();function fn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var hn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._player=t}var t,n,r;return t=e,(n=[{key:"switchVideoStreamProfile",value:function(e){var t=this,n=Zt.eventTypeClarityIndex({id:e});this._player.logger.send("switchVideoStreamProfile",{switchVideoStreamProfile:e});var r=!1;return new Promise((function(e,i){var o=He.ERROR_SDK_GENERAL.CODE,s=He.ERROR_SDK_GENERAL.MESSAGE;t._player._sendCustomMessage(n).then((function(){var n;t._player.client._remoteStream?(t._player.client._remoteStream.on("message-received",n=function(i){var o=i.message,s=o.msg&&JSON.parse(o.msg);if(s&&s.command===Mt){r=!0;var a=t._handleVideoStreamProfileEvent(s);t._player.client._remoteStream.off("message-received",n),e(a)}}),setTimeout((function(){!1===r&&i({errorCode:o,message:s})}),3e4)):i({errorCode:o,message:s})})).catch((function(e){i({errorCode:o,message:s})}))}))}},{key:"_handleVideoStreamProfileEvent",value:function(e){var t=e.data,n={before:t.from,after:t.current,result:"",reason:""};if(0===t.result)n.result=0;else{var r=He.ERROR_GAME_VIDEO_STREAM_PROFILE_NOT_IN_RANGE.MESSAGE;n.result=1,n.reason=r}return this._player.logger.send("switchVideoStreamProfileResult",n),{result:n.result,reason:n.reason,before:n.before,after:n.after}}}])&&fn(t.prototype,n),r&&fn(t,r),e}();function pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pn(Object(n),!0).forEach((function(t){vn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var gn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._player=t,this._debug=t.debug,this._hasEmitChannelReadyEvent=!1}var t,n,r;return t=e,(n=[{key:"sendVEMessage",value:function(e,t){var n=this,r=this._player.userId,i=Zt.veMessage({payload:e,userId:r,needAck:t});return this._player.logger.send("sendMessage",{message:e}),new Promise((function(e,t){if(n._hasEmitChannelReadyEvent)n._player._sendCustomMessage(i).then((function(){n._player.logger.send("sendMessageSuccess"),e(mn(mn({},i.event_data.message),{},{userId:r}))})).catch((function(e){n._debug&&console.log(Oe,"ve-message-error",e),n._player.logger.send("sendMessageFailure",{err:e}),t(e)}));else{var o=Ze.CODE,s=Ze.MESSAGE;n._player.logger.send("sendMessageFailure",{errc:o,msg:s}),t({errorCode:o,message:s})}}))}},{key:"receiveVEMessage",value:function(e){var t=this,n=JSON.parse(e.data);if(4!==n.type){if(3===n.type){var r=mn(mn({},n&&n.message),{},{userId:n&&n.user_id});this._player.emit("message",r)}}else{var i=this._player.userId,o=Zt.veMessageReadyResponse({userId:i});this._player._sendCustomMessage(o).then((function(){t._hasEmitChannelReadyEvent||(t._hasEmitChannelReadyEvent=!0,t._player.emit("message-channel-connected"))}))}}}])&&_n(t.prototype,n),r&&_n(t,r),e}();function yn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var bn=function(){function e(t,n){var r=n.domId,i=n.isDebug;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._player=t,this._debug=i,this._domId=r,this._init()}var t,n,r;return t=e,(n=[{key:"_init",value:function(){var e=this;this._isOrientation="orientation"in window&&"onorientationchange"in window,window.orientation>0?this.handleScreenLock(!0,270):this.handleScreenLock(!1,0),this._isOrientation?window.addEventListener("orientationchange",this._orientationchangeListener=function(t){switch(e._player.emit("orientationchange",t),window.orientation){case 90:case-90:e._isRotation=!0,e._rotation=270;break;default:e._isRotation=!1,e._rotation=0}setTimeout((function(){e.handleScreenLock(e._isRotation,e._rotation)}),100)}):window.addEventListener("resize",this._orientationchangeListener=this.debounce((function(t){window.innerWidth>window.innerHeight?e.handleScreenLock(!0,270):e.handleScreenLock(!1,0),e._player.emit("resize",t)})))}},{key:"handleScreenLock",value:function(e,t){var n=document.getElementById(this._domId),r=document.getElementById("cc-player-container");if(this._debug&&console.log(Oe,"screenLockHandle","isRotation",e,"rotation:",t),n){var i,o;if((i=n.clientWidth)>(o=n.clientHeight)){var s=o;o=i,i=s}r.style.width="".concat(i,"px"),r.style.height="".concat(o,"px"),e?(r.style,r.style.transform="translate(".concat(Math.abs(i-o)/2,"px, ").concat(-Math.abs(i-o)/2,"px) rotate(").concat(t,"deg)"),this._player.rotateCoordinate(t)):(this._player.rotateCoordinate(0),r.style.transform=""),this._player.client&&this._player.client.renderEle&&this._player.updateVideoScale(this._player.client.renderEle)}}},{key:"debounce",value:function(e,t){var n=null;return function(){var r=this,i=arguments;clearTimeout(n),n=setTimeout((function(){e.apply(r,i)}),t)}}},{key:"destroy",value:function(){this._isOrientation?(window.removeEventListener("orientationchange",this._orientationchangeListener),this._debug&&console.log(Oe,"screenLockHandler destroy orientationchange")):(window.removeEventListener("resize",this._orientationchangeListener),this._debug&&console.log(Oe,"screenLockHandler destroy resize"))}}])&&yn(t.prototype,n),r&&yn(t,r),e}(),En=n(5);function Sn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sn(Object(n),!0).forEach((function(t){Cn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Cn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Rn,Tn=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),I()(this),this._player=t,this._logger=n.logger,this._debug=n.isDebug,this._userId=n.userId,this._client=En.a.createClient({dataChannel:!0,configServerHost:n.configServerHost}),this._containerDomId=n.containerDomId,this._podUserId=null,this._remoteStream=null,this._rtcVideoEleId=null,this.renderEle=null,this._mute=null}var t,n,r;return t=e,(n=[{key:"start",value:function(e){var t=this,n=e.roomId,r=e.token,i=e.podUserId,o=e.rtcAppId,s=e.width,a=e.height,c=e.mute,u=e.fit,d=e.startTime,l=e.retry,f=void 0!==l&&l;return this._podUserId=i,this._mute=c,new Promise((function(e,c){var l,h,p=t._client;p.on("stream-added",(function(e){t._debug&&console.log(Oe,"stream-added success",e),t._player.emit("stream-added",{podUserId:i}),l=e.attributes.videoDescriptions[0].width,h=e.attributes.videoDescriptions[0].height,t._logger.send("remoteJoin",{cost:new Date-d,streamWidth:l,streamHeight:h})})),p.on("stream-removed",(function(e){t._player.emit("stream-removed",{podUserId:i})}));var m=function(c){var d=Zt.eventTypeStartUp();t.sendMessage(JSON.stringify(d)),t.status="playing",["standalone"].some((function(e){return window.matchMedia("(display-mode: "+e+")").matches}))&&document.addEventListener("visibilitychange",t._visibilityCallback=function(){if(t.debug&&console.log(Oe,"visibilitychange: ",document.visibilityState),"visible"===document.visibilityState){if("playing"===t.status&&p&&"DISCONNECTED"===p.getConnectionState()){c.stream&&c.stream.removeAllListeners(),p&&p.removeAllListeners(),document.removeEventListener("visibilitychange",t._visibilityCallback);var e={roomId:n,token:r,podUserId:i,rtcAppId:o,width:s,height:a,mute:t._mute,fit:u,startTime:new Date,retry:!0};t.start(e).catch((function(){t.debug&&console.log(Oe,"visible resume retry"),c.stream&&c.stream.removeAllListeners(),p&&p.removeAllListeners(),setTimeout((function(){return t.start(e)}),1e3)})),t._debug&&console.log(Oe,"visible start")}}else"playing"===t.status&&(p.leave(!0),t._debug&&console.log(Oe,"后台 leave room"))}),e({width:s,height:a,streamWidth:l,streamHeight:h})};p.on("stream-subscribed",(function(e){var n=!1,r=!1;t._debug&&console.log(Oe,"subscribed stream success",e),t._player.emit("stream-subscribed",{podUserId:i}),t._debug&&console.log(Oe,"stream-subscribed",e),t._logger.send("remoteSubscribe",{cost:new Date-d}),t._remoteStream=e.stream,t._player.remoteMessager=t._remoteStream;var o={poster:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",id:(65535&(new Date).getTime())+""+parseInt(1e3*Math.random()),styles:{objectFit:u}};t._mute&&(o.muted=!0);var s=e.stream.play(t._containerDomId,o);t.renderEle=e.stream.video,t._player.touchHandler.setStreamSize({streamWidth:l,streamHeight:h});var a=t._player.touchHandler.updateVideoScale(t.renderEle);s.then((function(){t._debug&&console.log(Oe,"video play success"),t._rtcVideoEleId=t.renderEle.id,t._logger.send("videoPlay",wn({cost:new Date-d},a))})).catch((function(e){t._debug&&console.log(Oe,"video play error");var n=He.ERROR_START_STREAM_AUTO_PLAY_FAILED.CODE,r=He.ERROR_START_STREAM_AUTO_PLAY_FAILED.MESSAGE,i=e.name||"video play error";t._logger.send("videoPlay",wn(wn({cost:new Date-d},a),{},{errc:n,msg:r,oMsg:i})),c({errorCode:n,message:r})})),e.stream.on("data-channel-open",(function(){t._debug&&console.log(Oe,"data-channel-open"),r=!0,t._player.emit("data-channel-open"),n&&r&&m(e)})),e.stream.on("message-received",(function(e){t._player.messageReceviedHandler(e)})),e.stream.on("first-remote-video-render",(function(i){t._debug&&console.log(Oe,"first frame time: "+(new Date-d)+"ms"),n=!0,t._player.emit("first-remote-video-render"),n&&r&&m(e)}))})),p.on("socket/events",(function(e){var n=e&&e.code,r=e&&e.message;t._debug&&console.log(Oe,"on socket/events: ",n,r),200003!==n&&200004!==n||(t._logger.send("rtcError",{errc:n,msg:r}),t._player.emit("error",{errorCode:n,message:r})),200005===n&&(d=new Date,t._logger.send("reconnect",{result:0})),200006===n&&t._logger.send("reconnect",{result:1,errc:n,msg:r})})),p.on("client-banned",(function(){var e=$e.CODE,n=$e.MESSAGE;t._player.emit("error",{errorCode:e,message:n}),t._logger.send("error",{errc:e,msg:n})})),p.on("peer-leave",(function(e){var n,r,i=e.clientId;t._podUserId===i&&(t._player.getResourceStatus().then((function(e){n=e.errorCode,r=e.message})).catch((function(e){n=e.errorCode,r=e.message})),t._player.emit("error",{errorCode:n,message:r}),t._logger.send("error",{errc:n,msg:r}),t._player._stop())})),p.on("get-stats",(function(e){var n=e&&e[0]&&e[0].stats&&e[0].stats[0]||{audio:{},video:{}},r={accessDelay:n.video.rtt<0?0:n.video.rtt,videoReceivedPacketsLostRate:n.video.packetsLostRate,videoReceivedBitrate:n.video.bitrate,videoReceivedFrameRate:n.video.framerate,videoReceivedResolutionHeight:n.video.frameHeight,videoReceivedResolutionWidth:n.video.frameWidth,videoStallCount:n.video.stallCount,audioReceivedPacketsLostRate:n.audio.packetsLostRate,audioReceivedBitrate:n.audio.bitrate};t._logger.send("status",r)})),p.on("error",(function(e){var n,r,i=e&&e.code,o=e&&e.message;switch(i){case 300002:case 300003:n=He.ERROR_STREAM_CONNECTION_FAILED.CODE,r=He.ERROR_STREAM_CONNECTION_FAILED.MESSAGE;break;default:n=He.ERROR_STREAM_GENERAL.CODE,r=He.ERROR_STREAM_GENERAL.MESSAGE}t._logger.send("rtcError",{errc:n,msg:r,oErrc:i,oMsg:o}),t._player.emit("error",{errorCode:n,message:r})})),t._logger.send("joinRoom",{podUserId:i,token:r,podWith:s,podHeight:a}),p.join(o,n,t._userId||" ",r).then((function(e){var n=e.clientId;t.isPlaying=!0,t._logger.send("joinRoomResult",{cost:new Date-d,result:0}),t._debug&&console.log(Oe,"join room success, uid: ",n),t._retryIsTimeOut(f)})).catch((function(e){var r=e.code,i=e.message,o=He.ERROR_SDK_GENERAL.CODE,s=He.ERROR_SDK_GENERAL.MESSAGE;t._debug&&console.log(Oe,"join room error, roomId: ",n),t._logger.send("joinRoomResult",{cost:new Date-d,result:1,msg:o,errc:s,oMsg:i,oErrc:r}),c({errorCode:o,message:s})}))}))}},{key:"stop",value:function(){var e=this;return document.removeEventListener("visibilitychange",this._visibilityCallback),new Promise((function(t,n){var r=He.ERROR_SDK_GENERAL.CODE,i=He.ERROR_SDK_GENERAL.MESSAGE;e._client?(e._streamStop(),e._logger.send("leaveRoom"),e._client.leave().then((function(){e._debug&&console.log(Oe,"stop sccuess"),t()})).catch((function(t){e._debug&&console.log(Oe,"stop fail",t),n({errorCode:r,message:i})}))):n({errorCode:r,message:i})}))}},{key:"sendMessage",value:function(e){var t=this,n=this._podUserId;return this._debug&&console.log(Oe,"sendMessage to:"+n+" message:"+e),new Promise((function(r,i){var o=He.ERROR_MESSAGE_NOT_READY.CODE,s=He.ERROR_MESSAGE_NOT_READY.MESSAGE;t._remoteStream?t._remoteStream.sendMessage(n,e).then((function(e){t._debug&&console.log(Oe,"sendmessage",e),r(e)})).catch((function(e){t._debug&&console.log(Oe,"rtc-data-channel-error",e),i({errorCode:o,message:s})})):(t._debug&&console.log(Oe,"remoteStream-error"),i({errorCode:o,message:s}))}))}},{key:"getStats",value:function(){var e=this;return new Promise((function(t,n){e._remoteStream?e._remoteStream.getStats().then((function(e){var n={accessDelay:e.video.rtt<0?0:e.video.rtt,videoReceivedPacketsLostRate:e.video.packetsLostRate,videoReceivedBitrate:e.video.bitrate,videoReceivedFrameRate:e.video.framerate,videoReceivedResolutionHeight:e.video.frameHeight,videoReceivedResolutionWidth:e.video.frameWidth};t(n)})).catch((function(e){n()})):n()}))}},{key:"getConnectionState",value:function(){return this._client.getConnectionState()}},{key:"setAudioMute",value:function(e){this._mute=!!e,e?this._remoteStream.muteAudio():this._remoteStream.unmuteAudio()}},{key:"_retryIsTimeOut",value:function(e){var t={errorCode:Xe.CODE,message:Xe.MESSAGE},n=this._client.getRemoteUsers(),r=!1;if(this._debug&&console.log(Oe,"start retry TimeOut get Remote Users",n),e){if(n)for(var i=0;i<n.length;i++)n[i].clientId===this._podUserId&&(r=!0);r||(this._player.emit("error",t),this._logger.send("error",{errc:t.errorCode,msg:t.message}))}}},{key:"_streamStop",value:function(){if(this._remoteStream&&this._client.unsubscribe(this._remoteStream.getId()).then((function(){})),this._rtcVideoEleId){var e=document.getElementById(this._rtcVideoEleId);e&&e.remove(),this._rtcVideoEleId=null,this.renderEle=null}this._removeClientListener()}},{key:"_removeClientListener",value:function(){this._client&&this._client.removeAllListeners(),this._remoteStream&&this._remoteStream.removeAllListeners()}}])&&kn(t.prototype,n),r&&kn(t,r),e}(),In=new Uint8Array(16);function On(){if(!Rn&&!(Rn="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Rn(In)}var An=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var Dn=function(e){return"string"==typeof e&&An.test(e)},Pn=[],xn=0;xn<256;++xn)Pn.push((xn+256).toString(16).substr(1));var Mn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Pn[e[t+0]]+Pn[e[t+1]]+Pn[e[t+2]]+Pn[e[t+3]]+"-"+Pn[e[t+4]]+Pn[e[t+5]]+"-"+Pn[e[t+6]]+Pn[e[t+7]]+"-"+Pn[e[t+8]]+Pn[e[t+9]]+"-"+Pn[e[t+10]]+Pn[e[t+11]]+Pn[e[t+12]]+Pn[e[t+13]]+Pn[e[t+14]]+Pn[e[t+15]]).toLowerCase();if(!Dn(n))throw TypeError("Stringified UUID is invalid");return n};var Ln=function(e,t,n){var r=(e=e||{}).random||(e.rng||On)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return Mn(r)};function jn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Nn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._player=t,this._debug=t.debug,this._visibilityCallback=null,this.initVisibleEnvent()}var t,n,r;return t=e,(n=[{key:"initVisibleEnvent",value:function(){var e=this;document.addEventListener("visibilitychange",this._visibilityCallback=function(){if(e._debug&&console.log(Oe,"visibilitychange: ",document.visibilityState),e._player.logger.send("visibilityChange",{visible:document.visibilityState}),"visible"===document.visibilityState){var t=Zt.eventTypeUserStatus(!1);e._player._sendCustomMessage(t).then((function(){e._player.logger.send("sendUserStatusChangeSuccess")})).catch((function(t){e._debug&&console.log(Oe,"send visible message error: ",t)}))}else{var n=Zt.eventTypeUserStatus(!0);e._player._sendCustomMessage(n).then((function(){e._player.logger.send("sendUserStatusChangeSuccess")})).catch((function(t){e._debug&&console.log(Oe,"send visible message error: ",t)}))}})}},{key:"destroy",value:function(){this._visibilityCallback&&(document.removeEventListener("visibilitychange",this._visibilityCallback),this._visibilityCallback=null)}}])&&jn(t.prototype,n),r&&jn(t,r),e}();function Bn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Un(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fn(e){return(Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hn(e,t){return(Hn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qn(e);if(t){var i=qn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Vn(this,n)}}function Vn(e,t){return!t||"object"!==Fn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qn(e){return(qn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Wn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hn(e,t)}(o,e);var t,n,r,i=Kn(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,e)}return t=o,(n=[{key:"checkSystemRequirements",value:function(){var e=!1;return["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach((function(t){e||window&&t in window&&(e=!0)})),e}},{key:"getVersion",value:function(){return"1.9.0"}},{key:"getStats",value:function(){return this._getStats()}},{key:"getConnectionState",value:function(){return this._getConnectionState()}},{key:"isAudioPlaying",get:function(){return!!this.streamMessager&&this.streamMessager.isAudioPlaying()}},{key:"setOptions",value:function(e){this._setOptions(e)}},{key:"setDebug",value:function(e){this._setDebug(e)}},{key:"setIdleTime",value:function(e){this._setKeepAliveTime(e)}},{key:"start",value:function(e){return this._start(e)}},{key:"restart",value:function(e){return this._restart()}},{key:"startRTC",value:function(e){return this._startRTC(e)}},{key:"playByInteraction",value:function(){return this._playByInteraction()}},{key:"videoPlay",value:function(){return this._videoPlay()}},{key:"stop",value:function(){return this._stop()}},{key:"pause",value:function(){return this._pauseOrResume(!0)}},{key:"resume",value:function(){return this._pauseOrResume(!1)}},{key:"renewToken",value:function(e){this._renewToken(e)}},{key:"updateVideoScale",value:function(){this._updateVideoScale()}},{key:"rotateCoordinate",value:function(e){this._rotateCoordinate(e)}},{key:"rotate",value:function(e){this._rotate(e)}},{key:"setAudioMute",value:function(e){this._setAudioMute(e)}},{key:"playAudio",value:function(){this._playAudio()}},{key:"closeApp",value:function(e){this._closeApp(e)}},{key:"launchApp",value:function(e){this._launchApp(e)}},{key:"sendMessage",value:function(e){return this._sendVEMessage(e)}},{key:"sendClipBoardMessage",value:function(e){return this._sendClipBoardMessage(e)}},{key:"sendCustomMessage",value:function(e){return this._sendCustomMessage(e)}},{key:"sendTouchMessage",value:function(e){return this._sendTouchMessage(e)}},{key:"sendKeycodeMessage",value:function(e){this._sendKeycodeMessage(e)}},{key:"sendMouseMessage",value:function(e){this._sendMouseMessage(e)}},{key:"sendGamepadButtonMessage",value:function(e){this._sendGamepadButtonMessage(e)}},{key:"sendJoystickMessage",value:function(e){this._sendJoystickMessage(e)}},{key:"enableLocalAudio",value:function(){return this._enableLocalAudio()}},{key:"disableLocalAudio",value:function(){return this._disableLocalAudio()}},{key:"switchVideoStreamProfile",value:function(e){return this._switchVideoStreamProfile(e)}},{key:"destroy",value:function(){return this._destroy()}}])&&Gn(t.prototype,n),r&&Gn(t,r),o}(function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),I()(this),this.options=t,this.userId=t.userId,this.domId=t.domId,this.region=t.region||"cn",this.mode=t.mode||xe.CLOUD_PHONE_GAME,this.isPC=t.isPC,this.disableInteraction=t.disableInteraction||!1,this.gameHost=t.gameHost,this.phoneHost=t.phoneHost,this.isPlaying=!1,this.localStream=null,this.remoteMessager=null,this.touchHandler=null,this.status="init",this._debug=t.isDebug;var r=localStorage.getItem("veDid");r?this.did=r:(this.did="did_"+Ln(),localStorage.setItem("veDid",this.did)),this._uesLocalKeyboard=t.enableLocalKeyboard&&!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),this.containerDomId="cc-player-container",this._cacheToken=null,this._reservedId=null,this._commonHandler=null,this._videoStreamProfileHandler=null,this._veMessageHandler=null,this._localKeyboardHandler=null,this._locationServiceHandler=null,this._clipboardHandler=null,this._clipboardAutoSyncHandler=null,this._visibilityHandler=null,this.logger=new Ge({userId:this.userId}),this.logger.setCommonParams({initSessionId:"isid_"+Ln(),delivery:"rtc"}),this.logger.on("logger",(function(e){n.emit("logger",e)})),this.client=new Tn(this,{userId:this.userId,logger:this.logger,isDebug:this._debug,configServerHost:Ae[this.region],containerDomId:this.containerDomId}),this._initDOM({domId:this.domId}),this._init({containerDomId:this.containerDomId}),this.logger.send("init",{enableSyncClipboard:this.options.enableSyncClipboard||!1,enableLocationService:this.options.enableLocationService||!1,enableLocalKeyboard:this.options.enableLocalKeyboard||!1,containerDomId:this.containerDomId,domId:this.domId,mode:this.mode,isPC:this.isPC})}var t,n,r;return t=e,(n=[{key:"_setOptions",value:function(e){this.options=Object.assign(this.options,e),this.userId=e.userId,this._debug=e.debug}},{key:"_setDebug",value:function(e){this._debug=!!e}},{key:"_setKeepAliveTime",value:function(e){var t=Zt.eventTypeKeepAliveTime(e);return this._sendCustomMessage(t)}},{key:"_initDOM",value:function(e){var t=e.domId,n=document.getElementById(t);if(n){var r=document.createElement("div");r.id=this.containerDomId,r.style.width="100%",r.style.height="100%",r.style.position="relative",this._uesLocalKeyboard&&(this._localKeyboardHandler=new nn(this),r.appendChild(this._localKeyboardHandler.inputCon)),n.appendChild(r)}}},{key:"_init",value:function(e){var t=e.containerDomId;this._debug&&console.log(Oe,"init sdk..."),this.touchHandler=new en(this,{domId:t,mode:this.mode,isPC:this.isPC,disableInteraction:this.disableInteraction}),this._initEnableConfig({containerDomId:t})}},{key:"_initEnableConfig",value:function(e){var t=e.containerDomId;this._commonHandler=new ln(this),this._veMessageHandler=new gn(this),this._videoStreamProfileHandler=new hn(this),this._clipboardHandler=new an(this),this.options.enableLocationService&&(this._locationServiceHandler=new on(this,{isDebug:this._debug})),this.options.enableSyncClipboard&&(this._clipboardAutoSyncHandler=new un(this,{containerDomId:t,isDebug:this._debug}))}},{key:"_start",value:function(e,t){var n=this,r=e.mute,i=void 0!==r&&r,o=e.token,s=e.gameId,a=e.customGameId,c=e.productId,u=e.roundId,d=e.videoStreamProfileId,l=e.accountId,f=e.podId,h=e.applicationId,p=e.planId,m=(e.configurationCode,e.reservedId),v=e.rotation,_=e.isScreenLock,g=e.isReset,y=e.userTag,b=e.extra,E=e.audioAutoPlay;this._debug&&console.log(Oe,"start...");var S=new Date,w=document.getElementById(this.containerDomId),C=w.clientWidth,k=w.clientHeight;return this.logger.setCommonParams({sessionId:"sid_"+Ln(),roundId:u,gameId:s,customGameId:a,planId:p,productId:c,reservedId:m,podId:f,volcProduct:t?"vePhone":"veGame"}),this.logger.send("event_start",{mute:i,token:o,isScreenLock:_}),this._cacheToken=o,this._needFirstClickPlayAudio=!1,!0===i&&!0===E&&(this._needFirstClickPlayAudio=!0),new Promise((function(e,r){t?function(e,t){var n=e.isDebug,r=e.phoneHost,i=e.productId,o=e.podId,s=e.userId,a=e.accountId,c=e.token,u=e.applicationId,d=e.planId,l=e.isReset,f=e.roundId,h=e.videoStreamProfileId,p=e.userTag,m=e.extra;return new Promise((function(e,v){if(i&&c&&c.AccessKeyID&&c.SecretAccessKey&&c.SessionToken){var _=c.AccessKeyID,g=c.SecretAccessKey,y=c.SessionToken,b=(c.CurrentTime,{Action:"PodStart",Version:"2020-10-25"});a&&(b["X-Account-Id"]=a);var E=Et(b),S={product_id:i,client_user_id:s};if(void 0!==o&&(S.pod_id=o),void 0!==u&&(S.app_id=u),void 0!==d&&(S.configuration_code=d),void 0!==l&&(S.reset=l),void 0!==f&&(S.round_id=f),void 0!==h){var w=parseInt(h);isNaN(w),S.video_stream_profile_id=w}void 0!==p&&(S.user_tag=p),void 0!==m&&(S.extra=m);var C={method:"POST",url:"".concat(r||Pe,"?").concat(E),timeout:3e4,region:"cn-north-1",params:b,body:S,headers:{"Content-Type":"application/json"}};new yt.a(C,"ACEP",{isVolcengine:!0}).addAuthorization({accessKeyId:_,secretAccessKey:g,sessionToken:y},new Date),fetch(C.url,{method:C.method,headers:C.headers,body:JSON.stringify(C.body),mode:"cors"}).then((function(e){return e.json()})).then((function(r){t.send("startRequest",{request:C,response:r});var i=r.Result,o=r.ResponseMetadata;if(i)e(i);else if(o&&o.Error){var s=o.Error.CodeN,a=o.Error.Message,c=o.RequestId,u=wt(s),d=u.errorCode,l=u.message;n&&console.log(Oe,"phoneStart error: ","start Response.Error error",r),v({originalErrorCode:s,originalMessage:a,requestId:c,errorCode:d,message:l})}else n&&console.log(Oe,"phoneStart error: ","start api request error",r),v({errorCode:He.ERROR_SDK_GENERAL.CODE,message:He.ERROR_SDK_GENERAL.MESSAGE})})).catch((function(e){n&&console.log(Oe,"phoneStart error: ",e),v({errorCode:He.ERROR_SDK_GENERAL.CODE,message:He.ERROR_SDK_GENERAL.MESSAGE,originalMessage:"unknow network error"})}))}else{var k;i||(k="productId"),c||(k="token"),c.AccessKeyID||(k="token.AccessKeyID"),c.SecretAccessKey||(k="token.SecretAccessKey"),c.SessionToken||(k="token.SessionToken");var R=He.ERROR_PARAM_IS_EMPTY(k),T=R.CODE,I=R.MESSAGE;v({errorCode:T,message:I})}}))}({accountId:l,phoneHost:n.phoneHost,productId:c,podId:f,userId:n.userId,token:o,applicationId:h,planId:p,isReset:g,roundId:u,videoStreamProfileId:d,userTag:y,extra:b,isDebug:n._debug},n.logger).then((function(t){n.logger.setCommonParams({planId:t.configuration_code,reservedId:t.reserved_id}),n._startRTC({roomId:t.room_id,token:t.token,podUserId:t.pod_user_id,rtcAppId:t.rtc_app_id,width:t.width,height:t.height,mute:i,rotation:t.rotation,startTime:S}).then((function(t){n.logger.send("startSuccess"),e(t)})).catch((function(e){r(e)}))})).catch((function(e){var t=e.errorCode,i=e.message,o=e.originalErrorCode,s=e.originalMessage;n.logger.send("startFailure",{cost:new Date-S,errc:t,msg:i,oErrc:o,oMsg:s,oReqId:e.requestId}),r({errorCode:t,message:i})})):function(e,t){var n=e.isDebug,r=e.gameHost,i=e.gameId,o=e.customGameId,s=e.token,a=e.userId,c=e.did,u=e.roundId,d=e.videoStreamProfileId,l=e.accountId,f=e.planId,h=e.reservedId,p=e.width,m=e.height,v=e.rotation,_=e.isScreenLock,g=e.userTag,y=e.extra;return new Promise((function(e,b){if(s&&s.AccessKeyID&&s.SecretAccessKey&&s.SessionToken&&u)if(i||o){if(v&&"landscape"!==v&&"portrait"!==v)return n&&console.log(Oe,"rotation error: ","rotation只能取值landscape或者portrait或者为空"),void b({errorCode:He.ERROR_SDK_GENERAL.CODE,message:He.ERROR_SDK_GENERAL.MESSAGE});var E=s.AccessKeyID,S=s.SecretAccessKey,w=s.SessionToken,C={Action:"SDKGameStart",Version:"2022-02-10"};l&&(C["X-Account-Id"]=l);var k=Et(C),R={game_id:i,client_user_id:a,round_id:u,width:p,height:m,did:c};if(i&&(R.game_id=i),o&&(R.custom_game_id=o),h&&(R.reserved_id=h),void 0!==f&&(R.configuration_code=f),void 0!==v&&(R.game_rotation=v),void 0!==_&&(R.orientation_lock=_),void 0!==g&&(R.user_tag=g),void 0!==y&&(R.extra=y),void 0!==d){var T=parseInt(d);isNaN(T),R.video_stream_profile_id=T}var I={method:"POST",url:"".concat(r||De,"?").concat(k),timeout:3e4,region:"cn-north-1",params:C,body:R,headers:{"Content-Type":"application/json"}};new yt.a(I,"veGame",{isVolcengine:!0}).addAuthorization({accessKeyId:E,secretAccessKey:S,sessionToken:w},new Date),fetch(I.url,{method:I.method,headers:I.headers,body:JSON.stringify(I.body),mode:"cors"}).then((function(e){return e.json()})).then((function(r){t.send("startRequest",{request:I,response:r});var i=r.Result,o=r.ResponseMetadata;if(i)e(i);else if(o&&o.Error){var s=o.Error.CodeN,a=o.Error.Message,c=o.RequestId,u=wt(s),d=u.errorCode,l=u.message;b({originalErrorCode:s,originalMessage:a,requestId:c,errorCode:d,message:l})}else n&&console.log(Oe,"gameStart error: ",r),b({errorCode:He.ERROR_SDK_GENERAL.CODE,message:He.ERROR_SDK_GENERAL.MESSAGE})})).catch((function(e){n&&console.log(Oe,"gameStart error: ",e),b({errorCode:He.ERROR_SDK_GENERAL.CODE,message:He.ERROR_SDK_GENERAL.MESSAGE,originalMessage:"unknow network error"})}))}else{var O=He.ERROR_PARAM_IS_EMPTY("gameId_or_customGameId"),A=O.CODE,D=O.MESSAGE;b({errorCode:A,message:D})}else{var P;s||(P="token"),s.AccessKeyID||(P="token.AccessKeyID"),s.SecretAccessKey||(P="token.SecretAccessKey"),s.SessionToken||(P="token.SessionToken"),u||(P="roundId");var x=He.ERROR_PARAM_IS_EMPTY(P),M=x.CODE,L=x.MESSAGE;b({errorCode:M,message:L})}}))}({accountId:l,gameHost:n.gameHost,gameId:s,customGameId:a,token:o,userId:n.userId,did:n.did,roundId:u,videoStreamProfileId:d,planId:p,reservedId:m,width:C,height:k,rotation:v,isScreenLock:_,userTag:y,extra:b,isDebug:n._debug},n.logger).then((function(t){n.logger.setCommonParams({planId:t.configuration_code,reservedId:t.reserved_id}),n._startRTC({roomId:t.room_id,token:t.token,podUserId:t.pod_user_id,rtcAppId:t.rtc_app_id,width:t.stream_width,height:t.stream_height,mute:i,rotation:t.game_rotation,startTime:S,isScreenLock:_}).then((function(r){n.logger.send("startSuccess"),n._reservedId=t.reserved_id,n._visibilityHandler=new Nn(n),e(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bn(Object(n),!0).forEach((function(t){Un(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({roundId:u,reservedId:t.reserved_id,gameId:s,extra:b},r))})).catch((function(e){r(e)}))})).catch((function(e){var t=e.errorCode,i=e.message,o=e.originalErrorCode,s=e.originalMessage;n.logger.send("startFailure",{cost:new Date-S,errc:t,msg:i,oErrc:o,oMsg:s,oReqId:e.requestId}),r({errorCode:t,message:i})}))}))}},{key:"_startRTC",value:function(e){var t=this,n=e.roomId,r=e.token,i=e.podUserId,o=e.rtcAppId,s=e.width,a=e.height,c=e.mute,u=e.fit,d=void 0===u?"contain":u,l=e.rotation,f=void 0===l?0:l,h=e.startTime,p=void 0===h?new Date:h,m=e.isScreenLock;return new Promise((function(e,u){t.logger.setCommonParams({roomId:n,rtcAppId:o});var l=t.client;"portrait"===f?f=0:"landscape"===f&&(f=270),t.touchHandler.setRotation(f),t.touchHandler.setContentSize({width:s,height:a}),m&&(t._screenLockHandler||(t._screenLockHandler=new bn(t,{domId:t.domId,isDebug:t._debug}))),l.start({roomId:n,token:r,podUserId:i,rtcAppId:o,width:s,height:a,mute:c,fit:d,startTime:p}).then((function(n){var r=n.width,i=n.height;t.logger.send("firstFrame",{cost:new Date-p}),e({width:r,height:i})})).catch(u)}))}},{key:"_restart",value:function(e){var t=Zt.eventTypeRestart();return this._sendCustomMessage(t)}},{key:"_playByInteraction",value:function(){var e=this;return this.logger.send("playByInteraction"),new Promise((function(t,n){e.client.renderEle?e.client.renderEle.play().then((function(){e.logger.send("playByInteractionSuccess"),t()})).catch((function(t){e._debug&&console.log(Oe,"playByInteraction fail",t.code,t.msg),e.logger.send("playByInteractionFailure",{errc:t.code,msg:t.msg}),n(t)})):(e.logger.send("playByInteractionFailure",{msg:"renderEle is null"}),n())}))}},{key:"_videoPlay",value:function(){var e=this;return new Promise((function(t,n){e.remoteMessager?e.remoteMessager.replay().then((function(){t()})).catch((function(e){n(e)})):n()}))}},{key:"_stop",value:function(){return this._debug&&console.log(Oe,"stop..."),this._destroyHandler(),this.client.stop()}},{key:"_pauseOrResume",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.remoteMessager){if(e){this.client._mute=!0;var t=this.client._client.updateSubscribe(this.remoteMessager.getId(),{audio:!1,video:!1});return this.logger.send("pause"),t}this.client._mute=!1;var n=this.client._client.updateSubscribe(this.remoteMessager.getId(),{audio:!0,video:!0});return this.logger.send("resume"),n}}},{key:"_renewToken",value:function(e){this._cacheToken=e,this.logger.send("renewToken",{newToken:e})}},{key:"_updateVideoScale",value:function(){this.touchHandler&&this.touchHandler.updateVideoScale(this.client.renderEle)}},{key:"_rotateCoordinate",value:function(e){this.touchHandler&&this.touchHandler.setDegree(e)}},{key:"_rotate",value:function(e){this.touchHandler&&this.touchHandler.setRotation(e)}},{key:"_setAudioMute",value:function(e){this.client.setAudioMute(e)}},{key:"_getStats",value:function(){return this.client.getStats()}},{key:"_getConnectionState",value:function(){if(this.client)return this.client.getConnectionState()}},{key:"getResourceStatus",value:function(){var e=this;return new Promise((function(t,n){Ct({gameHost:e.gameHost,reservedId:e._reservedId,stsToken:e._cacheToken,isDebug:e._debug},e.logger).then((function(e){t(e)})).catch((function(e){t(e)}))}))}},{key:"_monitorPod",value:function(e){var t=this,n=e.monitorPodId,r=e.startTime,i=void 0===r?new Date:r,o=e.monitorUserId,s=e.monitorToken,a=e.monitorAccountId;return new Promise((function(e,r){(function(e,t){var n=e.isDebug,r=e.phoneHost,i=e.monitorPodId,o=e.monitorUserId,s=e.monitorToken,a=e.monitorAccountId;return new Promise((function(e,c){if(i&&o){var u={Action:"MonitorPod",Version:"2020-10-25",pod_id:i,client_user_id:o};a&&(u["X-Account-Id"]=a);var d=Et(u),l=s.AccessKeyID,f=s.SecretAccessKey,h=s.SessionToken,p=(s.CurrentTime,{method:"GET",url:"".concat(r||Pe,"?").concat(d),timeout:3e4,region:"cn-north-1",body:"",params:u,headers:{"Content-Type":"application/json"}});new yt.a(p,"ACEP",{isVolcengine:!0}).addAuthorization({accessKeyId:l,secretAccessKey:f,sessionToken:h},new Date),fetch(p.url,{method:p.method,headers:p.headers,mode:"cors"}).then((function(e){return e.json()})).then((function(r){t.send("monitorPodRequest",{request:p,response:r});var i=r.Result,o=r.ResponseMetadata;if(i)e(i);else if(o&&o.Error){var s=o.Error.CodeN,a=o.Error.Message,u=o.RequestId,d=wt(s),l=d.errorCode,f=d.message;n&&console.log(Oe,"MonitorPod error: ","MonitorPod Response.Error error",r),c({originalErrorCode:s,originalMessage:a,requestId:u,errorCode:l,message:f})}else n&&console.log(Oe,"MonitorPod error: ","MonitorPod api request error",r),c({errorCode:He.ERROR_SDK_GENERAL.CODE,message:He.ERROR_SDK_GENERAL.MESSAGE})})).catch((function(e){n&&console.log(Oe,"MonitorPod error: ",e),c({errorCode:He.ERROR_SDK_GENERAL.CODE,message:He.ERROR_SDK_GENERAL.MESSAGE,originalMessage:"unknow network error"})}))}else{var m;i||(m="monitorPodId"),o||(m="monitorUserId");var v=He.ERROR_PARAM_IS_EMPTY(m),_=v.CODE,g=v.MESSAGE;c({errorCode:_,message:g})}}))})({phoneHost:t.phoneHost,monitorPodId:n,monitorUserId:o,monitorToken:s,monitorAccountId:a,isDebug:t._debug},t.logger).then((function(n){t.logger.send("monitorPodSuccess"),e()})).catch((function(e){var n=e.errorCode,o=e.message,s=e.originalErrorCode,a=e.originalMessage;t.logger.send("monitorPodFailure",{cost:new Date-i,errc:n,msg:o,oErrc:s,oMsg:a,oReqId:e.requestId}),r({errorCode:n,message:o})}))}))}},{key:"_playAudio",value:function(){this.remoteMessager&&this.remoteMessager.unmuteAudio()}},{key:"_closeApp",value:function(e){this._sendControlMessage(e,0)}},{key:"_launchApp",value:function(e){this._sendControlMessage(e,1)}},{key:"_sendVEMessage",value:function(e){return this._veMessageHandler.sendVEMessage(e)}},{key:"_sendClipBoardMessage",value:function(e){return this._clipboardHandler.sendClipBoardMessage(e)}},{key:"_sendCustomMessage",value:function(e){return this._sendMessage(JSON.stringify(e))}},{key:"_sendTouchMessage",value:function(e){return this.touchHandler.sendTouchMessage(e,!0)}},{key:"_sendControlMessage",value:function(e,t){var n=Zt.eventTypeAppManager();this._sendCustomMessage(n)}},{key:"_sendKeycodeMessage",value:function(e){var t=e.keycode,n=e.action,r=Zt.eventTypeKey({keycode:t,action:n});return this._sendCustomMessage(r)}},{key:"_sendMouseMessage",value:function(e){var t=e.button,n=e.action,r=e.wheel,i=e.x,o=e.y,s=Zt.eventTypeMouse({button:t,action:n,wheel:r,x:i,y:o});return this._sendCustomMessage(s)}},{key:"_sendGamepadButtonMessage",value:function(e){var t=e.keycode,n=e.action,r=e.index,i=void 0===r?0:r;if(this.mode===xe.CLOUD_PC){var o=Zt.eventTypeKey({keycode:t,action:n,index:i});return this._sendCustomMessage(o)}}},{key:"_sendJoystickMessage",value:function(e){var t=e.leftX,n=e.leftY,r=e.rightX,i=e.rightY,o=e.leftT,s=e.rightT,a=e.index,c=void 0===a?0:a;if(this.mode===xe.CLOUD_PC){var u=Zt.eventTypeGdapJoystick({leftX:t,leftY:n,rightX:r,rightY:i,leftT:o,rightT:s,index:c});this._sendCustomMessage(u)}}},{key:"_enableLocalAudio",value:function(){var e=this;return new Promise((function(t,n){e.localStream?e.localStream.getAudioTracks().forEach((function(e){e.enabled=!0})):navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).then((function(r){e.client._client&&e.client._client.publish(r,{video:!1}).then(t).catch(n)})).catch(n)}))}},{key:"_disableLocalAudio",value:function(){return this.localStream.getAudioTracks().forEach((function(e){e.enabled=!0})),Promise.resolve()}},{key:"messageReceviedHandler",value:function(e){var t=e.message,n=t.msg&&JSON.parse(t.msg);if(this._debug&&console.log(Oe,"message-received: "+JSON.stringify(n)),this.emit("inner-message-received",{from:t.from,to:t.to,msg:n}),n&&n.command===xt)return this._clipboardAutoSyncHandler&&this._clipboardAutoSyncHandler.handleClipboardEvent(n),void(this._clipboardHandler&&this._clipboardHandler.handleClipboardEvent(n));!n||n.command!==At&&n.command!==Dt?n&&n.command===Pt?this._commonHandler&&this._commonHandler.handleAudioEvent(n):n&&n.command===Ot?this._commonHandler&&this._commonHandler.handleErrorEvent(n):!n||n.command!==kt&&n.command!==Rt&&n.command!==Tt?n&&n.command===Lt?this._veMessageHandler&&this._veMessageHandler.receiveVEMessage(n):(n&&n.command===It&&this._localKeyboardHandler&&this._localKeyboardHandler.handleRotationEvent(n),n&&n.command===jt&&this.emit("general-message-received",{from:t.from,to:t.to,msg:n.data&&n.data.payload}),this.emit("message-received",{from:t.from,to:t.to,msg:n})):this._localKeyboardHandler&&this._localKeyboardHandler.handleInputMethodEvent(n):this._locationServiceHandler&&this._locationServiceHandler.handleInputMethodEvent(n)}},{key:"_sendMessage",value:function(e){return this.client.sendMessage(e)}},{key:"_switchVideoStreamProfile",value:function(e){return this._videoStreamProfileHandler&&this._videoStreamProfileHandler.switchVideoStreamProfile(e)}},{key:"_destroyHandler",value:function(){this._screenLockHandler&&(this._screenLockHandler.destroy(),this._screenLockHandler=null),this._visibilityHandler&&(this._visibilityHandler.destroy(),this._visibilityHandler=null)}},{key:"_destroy",value:function(){var e=this;return this.logger.send("destroy"),new Promise((function(t,n){"DISCONNECTED"===e.client.getConnectionState()?(e.remoteMessager=null,e.touchHandler.destroy(),t()):e._stop().catch(n)}))}}])&&zn(t.prototype,n),r&&zn(t,r),e}())}])}));